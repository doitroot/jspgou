webpackJsonp([2],{Jpdf:function(t,e,a){"use strict";"function"==typeof Symbol&&Symbol.iterator;var r=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var a=arguments[e];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(t[r]=a[r])}return t};function o(t){if(Array.isArray(t)){for(var e=0,a=Array(t.length);e<t.length;e++)a[e]=t[e];return a}return Array.from(t)}!function(){function e(t){function e(t){t.parentElement.removeChild(t)}function a(t,e,a){var r=0===a?t.children[0]:t.children[a-1].nextSibling;t.insertBefore(e,r)}function i(t,e){var a=this;this.$nextTick(function(){return a.$emit(t.toLowerCase(),e)})}var n=["Start","Add","Remove","Update","End"],s=["Choose","Sort","Filter","Clone"],l=["Move"].concat(n,s).map(function(t){return"on"+t}),c=null;return{name:"draggable",props:{options:Object,list:{type:Array,required:!1,default:null},value:{type:Array,required:!1,default:null},noTransitionOnDrag:{type:Boolean,default:!1},clone:{type:Function,default:function(t){return t}},element:{type:String,default:"div"},move:{type:Function,default:null},componentData:{type:Object,required:!1,default:null}},data:function(){return{transitionMode:!1,noneFunctionalComponentMode:!1,init:!1}},render:function(t){var e=this.$slots.default;if(e&&1===e.length){var a=e[0];a.componentOptions&&"transition-group"===a.componentOptions.tag&&(this.transitionMode=!0)}var r=0,i=e,n=this.$slots,s=n.header,l=n.footer;s&&(r=s.length,i=i?[].concat(o(s),o(i)):[].concat(o(s))),l&&(i=i?[].concat(o(i),o(l)):[].concat(o(l))),this.headerOffset=r;var c=null,u=function(t,e){c=function(t,e,a){return void 0==a?t:((t=null==t?{}:t)[e]=a,t)}(c,t,e)};if(u("attrs",this.$attrs),this.componentData){var d=this.componentData,p=d.on,f=d.props;u("on",p),u("props",f)}return t(this.element,c,i)},mounted:function(){var e=this;if(this.noneFunctionalComponentMode=this.element.toLowerCase()!==this.$el.nodeName.toLowerCase(),this.noneFunctionalComponentMode&&this.transitionMode)throw new Error("Transition-group inside component is not supported. Please alter element value or remove transition-group. Current element value: "+this.element);var a={};n.forEach(function(t){a["on"+t]=function(t){var e=this;return function(a){null!==e.realList&&e["onDrag"+t](a),i.call(e,t,a)}}.call(e,t)}),s.forEach(function(t){a["on"+t]=i.bind(e,t)});var o=r({},this.options,a,{onMove:function(t,a){return e.onDragMove(t,a)}});!("draggable"in o)&&(o.draggable=">*"),this._sortable=new t(this.rootContainer,o),this.computeIndexes()},beforeDestroy:function(){void 0!==this._sortable&&this._sortable.destroy()},computed:{rootContainer:function(){return this.transitionMode?this.$el.children[0]:this.$el},isCloning:function(){return!!this.options&&!!this.options.group&&"clone"===this.options.group.pull},realList:function(){return this.list?this.list:this.value}},watch:{options:{handler:function(t){for(var e in t)-1==l.indexOf(e)&&this._sortable.option(e,t[e])},deep:!0},realList:function(){this.computeIndexes()}},methods:{getChildrenNodes:function(){if(this.init||(this.noneFunctionalComponentMode=this.noneFunctionalComponentMode&&1==this.$children.length,this.init=!0),this.noneFunctionalComponentMode)return this.$children[0].$slots.default;var t=this.$slots.default;return this.transitionMode?t[0].child.$slots.default:t},computeIndexes:function(){var t=this;this.$nextTick(function(){t.visibleIndexes=function(t,e,a){if(!t)return[];var r=t.map(function(t){return t.elm}),i=[].concat(o(e)).map(function(t){return r.indexOf(t)});return a?i.filter(function(t){return-1!==t}):i}(t.getChildrenNodes(),t.rootContainer.children,t.transitionMode)})},getUnderlyingVm:function(t){var e=function(t,e){return t.map(function(t){return t.elm}).indexOf(e)}(this.getChildrenNodes()||[],t);return-1===e?null:{index:e,element:this.realList[e]}},getUnderlyingPotencialDraggableComponent:function(t){var e=t.__vue__;return e&&e.$options&&"transition-group"===e.$options._componentTag?e.$parent:e},emitChanges:function(t){var e=this;this.$nextTick(function(){e.$emit("change",t)})},alterList:function(t){if(this.list)t(this.list);else{var e=[].concat(o(this.value));t(e),this.$emit("input",e)}},spliceList:function(){var t=arguments,e=function(e){return e.splice.apply(e,t)};this.alterList(e)},updatePosition:function(t,e){var a=function(a){return a.splice(e,0,a.splice(t,1)[0])};this.alterList(a)},getRelatedContextFromMoveEvent:function(t){var e=t.to,a=t.related,o=this.getUnderlyingPotencialDraggableComponent(e);if(!o)return{component:o};var i=o.realList,n={list:i,component:o};if(e!==a&&i&&o.getUnderlyingVm){var s=o.getUnderlyingVm(a);if(s)return r(s,n)}return n},getVmIndex:function(t){var e=this.visibleIndexes,a=e.length;return t>a-1?a:e[t]},getComponent:function(){return this.$slots.default[0].componentInstance},resetTransitionData:function(t){if(this.noTransitionOnDrag&&this.transitionMode){this.getChildrenNodes()[t].data=null;var e=this.getComponent();e.children=[],e.kept=void 0}},onDragStart:function(t){this.context=this.getUnderlyingVm(t.item),t.item._underlying_vm_=this.clone(this.context.element),c=t.item},onDragAdd:function(t){this.updateEvenemt(t);var a=t.item._underlying_vm_;if(void 0!==a){e(t.item);var r=this.getVmIndex(t.newIndex);this.spliceList(r,0,a),this.computeIndexes();var o={element:a,newIndex:r};this.emitChanges({added:o})}},onDragRemove:function(t){if(this.updateEvenemt(t),a(this.rootContainer,t.item,t.oldIndex),this.isCloning)e(t.clone);else{var r=this.context.index;this.spliceList(r,1);var o={element:this.context.element,oldIndex:r};this.resetTransitionData(r),this.emitChanges({removed:o})}},onDragUpdate:function(t){this.updateEvenemt(t),e(t.item),a(t.from,t.item,t.oldIndex);var r=this.context.index,o=this.getVmIndex(t.newIndex);this.updatePosition(r,o);var i={element:this.context.element,oldIndex:r,newIndex:o};this.emitChanges({moved:i})},updateEvenemt:function(t){this.updateProperty(t,"newIndex"),this.updateProperty(t,"oldIndex")},updateProperty:function(t,e){t.hasOwnProperty(e)&&(t[e]+=this.headerOffset)},computeFutureIndex:function(t,e){if(!t.element)return 0;var a=[].concat(o(e.to.children)).filter(function(t){return"none"!==t.style.display}),r=a.indexOf(e.related),i=t.component.getVmIndex(r);return-1!=a.indexOf(c)||!e.willInsertAfter?i:i+1},onDragMove:function(t,e){var a=this.move;if(!a||!this.realList)return!0;var o=this.getRelatedContextFromMoveEvent(t),i=this.context,n=this.computeFutureIndex(o,t);return r(i,{futureIndex:n}),r(t,{relatedContext:o,draggedContext:i}),a(t,e)},onDragEnd:function(t){this.computeIndexes(),c=null}}}}Array.from||(Array.from=function(t){return[].slice.call(t)});var i=a("lPr8");t.exports=e(i)}()},MgeX:function(t,e,a){t.exports={default:a("VX3H"),__esModule:!0}},NDfU:function(t,e,a){"use strict";a.d(e,"a",function(){return o}),a.d(e,"b",function(){return i});var r=a("HNM5"),o=function(t){return r.a.post("/admin/store/producttypeattr/delete",t)},i=function(t){return r.a.get("/admin/store/producttypeattr/list",{params:t})}},QaSv:function(t,e){},QvHC:function(t,e,a){var r=a("+QyY"),o=a("Uydw")(!1);r(r.S,"Object",{values:function(t){return o(t)}})},UdxI:function(t,e,a){"use strict";e.a=function(t){var e=[];r=[],o=[],i=[];for(var a=0,s=0,l=0;l<t.length;l++)t[l].length>0?(i[s]=0,r[s]=t[l],s++):a++;if(a===t.length)return[];o=r.length-1;for(var c=1,u=0;u<r.length;u++)c*=r[u].length;for(var d=0;d<c;d++){for(var p={name:[],salesPrice:"0.0",marketPrice:"0.0",costPrice:"0.0",inventory:"0",warning:"0",id:"",attrCodes:[]},f=0;f<r.length;f++)p.name.push(r[f][i[f]].attrValue),p["properties"+f]=r[f][i[f]].attrValue,p.attrCodes.push(r[f][i[f]].attrCode);e.push(p),n()}return e};var r=[],o=0,i=[];function n(){i[o]++,i[o]>=r[o].length&&(i[o]=0,--o>=0&&n(),o=r.length-1)}},Uydw:function(t,e,a){var r=a("xw+U"),o=a("vh3Q"),i=a("pNzz").f;t.exports=function(t){return function(e){for(var a,n=o(e),s=r(n),l=s.length,c=0,u=[];l>c;)i.call(n,a=s[c++])&&u.push(t?[a,n[a]]:n[a]);return u}}},VX3H:function(t,e,a){a("QvHC"),t.exports=a("Hx55").Object.values},W8wZ:function(t,e){},"gQr+":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=a("GBzI"),o={data:function(){return{checkItem:"男装、女装、内衣 > 女装 > 衬衫",items0:[],items1:[],items2:[],items3:[],checkIds:[],categoryId:0}},computed:{categoryName:function(){for(var t="",e=0;e<this.checkIds.length;e++)""!==this.checkIds[e].name&&(t=t+this.checkIds[e].name+"> ");return t}},methods:{getCategoryList:function(t,e){var a=this;if(0===e)this.items2=[],this.items3=[],this.$set(this.checkIds,1,{name:"",id:""}),this.$set(this.checkIds,2,{name:"",id:""}),this.$set(this.checkIds,3,{name:"",id:""});else if(1===e)this.items3=[],this.$set(this.checkIds,2,{name:"",id:""}),this.$set(this.checkIds,3,{name:"",id:""});else if(2===e)this.$set(this.checkIds,3,{name:"",id:""});else{if(3===e)return!0;this.checkIds=[{name:"",id:""},{name:"",id:""},{name:"",id:""},{name:"",id:""}]}Object(r.b)({parentId:t}).then(function(t){if(0===e)a.items1=t.data;else if(1===e)a.items2=t.data;else if(2===e)a.items3=t.data;else{if(3===e)return!1;a.items0=t.data}})},nextStep:function(){this.$store.dispatch("setCateGoryInfo",{categoryId:this.categoryId,parentInfo:this.checkIds})},setCheckItem:function(t,e,a){this.categoryId=t.id,this.$set(this.checkIds,a,{name:t.cateName,id:t.id}),this.getCategoryList(t.id,a)}},activated:function(){this.getCategoryList()}},i={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"cms-form-layout "},[t._m(0),t._v(" "),a("div",{staticClass:"step-class-warpper"},[a("div",{staticClass:"check-class-title"},[t._v("您当前选择的分类：\n       "),t._l(t.checkIds,function(e,r){return a("span",{key:r,staticClass:"blue"},[e.name&&r>0?a("span",[t._v(">")]):t._e(),t._v("\n             "+t._s(e.name)+"\n       ")])})],2),t._v(" "),a("section",{staticClass:"step-class-group"},[a("div",{staticClass:"class-group-header"},[t._v("\n         请选择分类\n       ")]),t._v(" "),a("ul",{staticClass:"class-group-body"},t._l(t.items0,function(e,r){return a("li",{key:e.id,staticClass:"items",class:[t.checkIds[0]&&t.checkIds[0].id===e.id?"active":""],on:{click:function(a){t.setCheckItem(e,r,0)}}},[t._v(t._s(e.cateName))])}),0)]),t._v(" "),t.items1.length>0?a("section",{staticClass:"step-class-group"},[a("div",{staticClass:"class-group-header"},[t._v("\n         请选择分类\n       ")]),t._v(" "),a("ul",{staticClass:"class-group-body"},t._l(t.items1,function(e,r){return a("li",{key:e.id,staticClass:"items",class:t.checkIds[1]&&t.checkIds[1].id===e.id?"active":"",on:{click:function(a){t.setCheckItem(e,r,1)}}},[t._v(t._s(e.cateName))])}),0)]):t._e(),t._v(" "),t.items2.length>0?a("section",{staticClass:"step-class-group"},[a("div",{staticClass:"class-group-header"},[t._v("\n         请选择分类\n       ")]),t._v(" "),a("ul",{staticClass:"class-group-body"},t._l(t.items2,function(e,r){return a("li",{key:e.id,staticClass:"items",class:t.checkIds[2]&&t.checkIds[2].id===e.id?"active":"",on:{click:function(a){t.setCheckItem(e,r,2)}}},[t._v(t._s(e.cateName))])}),0)]):t._e(),t._v(" "),t.items3.length>0?a("section",{staticClass:"step-class-group"},[a("div",{staticClass:"class-group-header"},[t._v("\n         请选择分类\n       ")]),t._v(" "),a("ul",{staticClass:"class-group-body"},t._l(t.items3,function(e,r){return a("li",{key:e.id,staticClass:"items",class:t.checkIds[3]&&t.checkIds[3].id===e.id?"active":"",on:{click:function(a){t.setCheckItem(e,r,3)}}},[t._v(t._s(e.cateName))])}),0)]):t._e()]),t._v(" "),a("div",{staticStyle:{"text-align":"center",padding:"15px 0"}},[a("cms-button",{attrs:{disabled:0===t.categoryId},on:{click:t.nextStep}},[t._v("下一步，填写商品信息")])],1)])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"commonly-class"},[e("label",{staticClass:"commonly-class-label"},[this._v("常用分类")])])}]};var n=a("C7Lr")(o,i,!1,function(t){a("QaSv")},null,null).exports,s=a("MgeX"),l=a.n(s),c=a("HzJ8"),u=a.n(c),d=a("aA9S"),p=a.n(d),f=a("OMN4"),h=a.n(f),m=a("x1ym"),v=a("Jpdf"),g=a.n(v),b=a("AsmT"),_=a("0dUi"),y=a("NyU8"),C={storeServiceIds:[],product:{storeId:"",storeCategoryId:"",categoryId:"",name:"",virtualCardTplId:"",itemNumber:"",brandId:1,summary:"",summaryColor:"#ff0000",templeteId:1,weight:"",volume:"",sellGoodsSale:!0,isInvoice:!0,status:3},productTypeId:"",storeCategoryIds:[],imageResources:[{remark:"",imgResourceId:"",url:""},{remark:"",imgResourceId:"",url:""},{remark:"",imgResourceId:"",url:""},{remark:"",imgResourceId:"",url:""},{remark:"",imgResourceId:"",url:""}],videoResources:[{remark:"",vdResourceId:"",url:""}],txt:{pcTxt:"pc端内容",mobileTxt:"移动端内容"},ext:{unit:"件",keyword:"",evaluationView:""}},x=[],k={components:{draggable:g.a},data:function(){var t=this;return{loading:!1,status:!1,fixed:!0,txtModel:"pc",storeItems:[],options:[],props:{value:"id",label:"cateName",children:"childs",disabled:"isAuth"},freightItems:[],freightInfo:{},serviceItems:[],formatItems:[],formData:p()({},C),categoryName:"",isVirtual:!1,rules:{"product.templeteId":[m.a.required("必须选择一个运费模板","change")],"product.categoryId":[m.a.required("必须选择一个商品分类")],"product.name":[m.a.required("请输入商品名称"),m.a.max(100,"最多只能输入100个字符")],"product.summary":[m.a.max(100,"最多只能输入100个字符")],"product.itemNumber":[m.a.custom(function(e,a,r){""===a?r():Object(y.a)({itemNumber:a,storeId:t.formData.product.storeId,id:t.formData.product.id}).then(function(t){t.data?r():r(new Error("货号重复"))})})],"product.volume":[m.a.required(),m.a.float(),m.a.decimal()],"product.weight":[m.a.required(),m.a.float(),m.a.decimal()],imageResources:[m.a.required("至少上传一张商品图片")],"product.sellGoodsSale":[m.a.required()],"product.isInvoice":[m.a.required()]},errorMessage:{}}},methods:{initData:function(){var t=this;this.loading=!0,Object(y.m)({id:this.$route.query.productId}).then(function(e){200===e.code?(t.formData.product=e.data.product,t.formData.txt=e.data.txt,t.formData.ext=e.data.ext,t.setStoreData(e.data),t.getRelevantInfos(t.formData.product.category.id),t.getStroeCategory(e.data.product.storeId),t.changeTemplate(t.formData.product.templeteId)):t.loading=!1})},getStroeCategory:function(t){var e=this;Object(b.f)().then(function(t){e.options=[];e.options=[].concat(t.data)})},setStoreData:function(t){var e=this.$cms.deepCopy(t),a=[],r=[{remark:"",vdResourceId:"",url:""}];return this.formData.storeCategoryIds=e.product.storeProductCategory?e.product.storeProductCategory.nodeIds:[""],e.resources.forEach(function(t){if(t.videoResource&&""!==t.videoResource.id){var e={remark:"",alias:t.videoResource.alias,vdResourceId:t.videoResource.id,url:t.videoResource.url};r[0]=e}else if(t.imageResouce&&""!==t.imageResouce.id){var o={remark:"",imgResourceId:t.imageResouce.id,url:t.imageResouce.url};a.push(o)}}),this.formData.product.categoryId=this.formData.product.category.id,e.product.categoryId=e.product.category.id,this.getCategoryName(e.product.category),this.formData.imageResources=p()(this.formData.imageResources,a),e.imageResources=p()(this.formData.imageResources,a),this.formData.videoResources=r,e.videoResources=r,this.formData.ext.keyword=e.ext.keyword,this.formData.ext.evaluationView=e.ext.evaluationView,this.$set(this.formData.ext,"storeServiceId",this.transferServiceIds(e.proConsumerServices)),e.skuTypeAttrs=this.createSkuTypeAttrs(e.proTypeAttrs.saleAttrs,e.skuTypeAttrs),e.skus=this.createSku(e.skus),e.proTypeAttrItems=e.proTypeAttrs,e.proTypeAttrs=e.proAttrs,delete e.product.category,delete e.product.brand,this.$store.dispatch("setProductInfo",e),this.status=!0,e},transferServiceIds:function(t){var e=[];return t instanceof Array&&t.length>0&&t.forEach(function(t){e.push(t.id)}),e},createSku:function(t){var e=[];return t.forEach(function(t,a){e.push(t),e[a].attrCodes=t.saleAttrCode.split("-")}),e},createSkuTypeAttrs:function(t,e){var a=[];return t.map(function(t){a.push({valueType:t.valueType,attrGroupName:t.attrGroupName,name:t.name,id:t.id,attrValueList:[]})}),e.forEach(function(t,e){a.forEach(function(e,a){if(t.productTypeAttr.id===e.id){var r={url:t.resourceData?t.resourceData.url:"",valueResourceId:t.resourceData?t.resourceData.id:"",attrCode:t.attrValueCode,attrValue:t.attrValueName};e.attrValueList.push(r)}})}),a},getCategoryName:function(t){var e=this;(x.push(t.cateName),t.parent)?this.getCategoryName(t.parent):x.reverse().forEach(function(t,a){e.categoryName=0===a?t:e.categoryName+" > "+t})},getRelevantInfos:function(t){var e=this;h.a.all([Object(r.a)({id:t}),Object(y.i)(),Object(_.c)(),Object(b.g)()]).then(h.a.spread(function(t,a,r,o){e.formatItems=a.data,e.formData.productTypeId=t.data.productTypeId,e.isVirtual=t.data.virtual,e.freightItems=r.data,e.serviceItems=o.data,e.loading=!1}))},validateImgs:function(){var t=this,e=!1;this.formData.imageResources;var a=!0,r=!1,o=void 0;try{for(var i,n=u()(this.formData.imageResources);!(a=(i=n.next()).done);a=!0){""!==i.value.imgResourceId&&(e=!0)}}catch(t){r=!0,o=t}finally{try{!a&&n.return&&n.return()}finally{if(r)throw o}}return!!e||(this.errorMessage={},setTimeout(function(){t.$set(t.errorMessage,"imageResources","至少上传一张商品图片"),t.errorPosition("imageResources")},1),!1)},nextStep:function(t){var e=this;this.$refs.form.validate(function(a,r){if(a){if(e.validateImgs()){var o=e.formatFormData(e.formData);e.$store.dispatch("setBaseProductInfo",o).then(function(a){e.formData.ext.storeServiceId.length>0&&(e.formData.ext.storeServiceId=e.formData.ext.storeServiceId.join(",")),e.$store.dispatch("setStandardInfo",{}).then(function(a){e.loading=!0,Object(y.u)(a).then(function(a){e.loading=!1,200===a.code?t?e.$store.dispatch("setStep","step3"):e.$successMessage("修改成功!"):e.$errorMessage(a.message)})})})}}else{var i="";for(var n in r)if(r.hasOwnProperty(n)){i=n;break}e.errorPosition(i)}})},formatFormData:function(t){var e=p()({},t);return e.ext.evaluation=e.ext.evaluationView,e.storeServiceIds.length>0&&(e.proConsumerServices=e.storeServiceIds.join(",")),e.product.storeCategoryId=t.storeCategoryIds[t.storeCategoryIds.length-1],delete e.product.storeProductCategory,e},errorPosition:function(t){var e=document.querySelector("#layout"),a=this.$refs[t].$el;return e.scrollTop=a.offsetTop-350,!1},getProductVideo:function(t,e){if(t){var a=t[0].url.substring(t[0].url.lastIndexOf(".")+1),r=["mp4","ogg"];console.log(r.includes(a)),r.includes(a)?this.formData.videoResources.length>0&&this.$set(this.formData.videoResources,e,{remark:"",vdResourceId:t[0].id,url:t[0].url}):this.$errorMessage("请选择视频格式文件")}else this.formData.videoResources=[{remark:"",vdResourceId:"",url:""}]},getProductImg:function(t,e){this.$set(this.formData.imageResources,e,{remark:"",imgResourceId:t[0].id,url:t[0].url}),this.errorMessage={}},imgMove:function(t,e){if("next"===e){if(0===t)return!1;var a=this.formData.imageResources[t-1];this.$set(this.formData.imageResources,t-1,this.formData.imageResources[t]),this.$set(this.formData.imageResources,t,a)}else{if(4===t)return!1;var r=this.formData.imageResources[t+1];this.$set(this.formData.imageResources,t+1,this.formData.imageResources[t]),this.$set(this.formData.imageResources,t,r)}},imgDelete:function(t){this.$set(this.formData.imageResources,t,{remark:"",imgResourceId:"",url:""})},changeTemplate:function(t){var e=this;Object(_.b)({id:t}).then(function(t){e.freightInfo=t.data})}},filters:{deliveryWayFilter:function(t){return["","快递","ems","平邮"][parseInt(t)]},districtFilter:function(t){if(""===t)return"";var e=JSON.parse(t),a=[],r=!0,o=!1,i=void 0;try{for(var n,s=u()(l()(e));!(r=(n=s.next()).done);r=!0){var c=n.value;a.push(c)}}catch(t){o=!0,i=t}finally{try{!r&&s.return&&s.return()}finally{if(o)throw i}}return a[0]+"..."}},activated:function(){x=[],this.$route.query.productId&&0!==this.$route.query.productId&&this.initData()},mounted:function(){var t=this;document.querySelector("#layout").addEventListener("scroll",function(e){var a=e.target.scrollTop,r=e.target.clientHeight,o=e.target.scrollHeight;!1===t.fixed&&(a+=70),parseInt(a)>o-r-70?t.fixed=!1:t.fixed=!0})}},I={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{directives:[{name:"loading",rawName:"v-loading.fullscreen",value:t.loading,expression:"loading",modifiers:{fullscreen:!0}}],staticClass:"cms-form-layout loading-top product-main-warpper",attrs:{"element-loading-text":"正在加载..."}},[a("el-form",{ref:"form",staticStyle:{"margin-bottom":"48px"},attrs:{rules:t.rules,model:t.formData,"label-width":"210px"},nativeOn:{submit:function(t){t.preventDefault()}}},[a("h3",{staticClass:"cms-segmentation"},[t._v("基本信息")]),t._v(" "),a("el-form-item",{attrs:{label:"商品分类",prop:"product.categoryId"}},[t._v(t._s(t.categoryName))]),t._v(" "),a("el-form-item",{attrs:{label:"店铺分类",prop:"product.storeCategoryId"}},[a("el-cascader",{attrs:{options:t.options,props:t.props,"change-on-select":!0,placeholder:"请选择分类"},model:{value:t.formData.storeCategoryIds,callback:function(e){t.$set(t.formData,"storeCategoryIds",e)},expression:"formData.storeCategoryIds"}})],1),t._v(" "),a("el-form-item",{ref:"product.name",attrs:{label:"商品名称",prop:"product.name"}},[a("el-input",{attrs:{maxlength:"100",type:"textarea",resize:"none",spellcheck:"false"},model:{value:t.formData.product.name,callback:function(e){t.$set(t.formData.product,"name",e)},expression:"formData.product.name"}}),t._v(" "),a("span",{staticClass:"gray"},[t._v("商品名称长度控制在100个字符以内")])],1),t._v(" "),t.isVirtual?a("el-form-item",{attrs:{label:"虚拟规格商品",prop:"product.virtualCardTplId"}},[a("el-select",{attrs:{"popper-append-to-body":!1},model:{value:t.formData.product.virtualCardTplId,callback:function(e){t.$set(t.formData.product,"virtualCardTplId",e)},expression:"formData.product.virtualCardTplId"}},t._l(t.roleList,function(t){return a("el-option",{key:t,attrs:{label:t,value:t}})}),1),t._v(" "),a("span",{staticClass:"gray"},[t._v("选择虚拟库（卡密）模板即可，点击新建模板增加")])],1):t._e(),t._v(" "),a("el-form-item",{attrs:{label:"货号",prop:"product.itemNumber"}},[a("el-input",{attrs:{maxlength:"30"},model:{value:t.formData.product.itemNumber,callback:function(e){t.$set(t.formData.product,"itemNumber",e)},expression:"formData.product.itemNumber"}}),t._v(" "),a("span",{staticClass:"gray"},[t._v("货号用于商家管理商品的一种编号，仅供商家使用，最多输入30个字符")])],1),t._v(" "),a("el-form-item",{attrs:{label:"品牌",prop:"product.brandId"}},[t.status?a("cms-brand",{attrs:{select:[t.formData.product.brand]},model:{value:t.formData.product.brandId,callback:function(e){t.$set(t.formData.product,"brandId",e)},expression:"formData.product.brandId"}},[a("cms-button",{attrs:{type:"info",size:"small"}},[t._v("选择品牌")])],1):t._e()],1),t._v(" "),a("el-form-item",{staticClass:"product-profile",attrs:{label:"商品简介",prop:"product.summary"}},[a("el-input",{attrs:{type:"textarea",rows:4,maxlength:"100"},model:{value:t.formData.product.summary,callback:function(e){t.$set(t.formData.product,"summary",e)},expression:"formData.product.summary"}}),t._v(" "),a("el-color-picker",{staticClass:"product-color-picker",model:{value:t.formData.product.summaryColor,callback:function(e){t.$set(t.formData.product,"summaryColor",e)},expression:"formData.product.summaryColor"}}),t._v(" "),a("span",{staticClass:"gray"},[t._v("商品简介显示在商品标题下方,长度不超过100字符，右侧的颜色板可设置显示颜色")])],1),t._v(" "),a("el-form-item",{ref:"product.templeteId",staticClass:"add-select-padd",attrs:{label:"运费模板",prop:"product.templeteId"}},[a("el-select",{attrs:{"popper-append-to-body":!1},on:{change:t.changeTemplate},model:{value:t.formData.product.templeteId,callback:function(e){t.$set(t.formData.product,"templeteId",e)},expression:"formData.product.templeteId"}},t._l(t.freightItems,function(t){return a("el-option",{key:t.id,attrs:{label:t.expressName,value:t.id}})}),1),t._v(" "),a("table",{staticClass:"sku-table",staticStyle:{width:"380px","margin-top":"10px"}},[a("tr",[a("th",[t._v("运送方式")]),t._v(" "),a("th",[t._v("运送到")]),t._v(" "),a("th",[t._v("首件(个)")]),t._v(" "),a("th",[t._v("运费")]),t._v(" "),a("th",[t._v("续建(个)")]),t._v(" "),a("th",[t._v("续费")])]),t._v(" "),t._l(t.freightInfo.tplDetails,function(e,r){return a("tbody",{key:r,style:{"background-color":t.freightInfo.isFree?"#5CB85C":"#CCCCCC"}},t._l(e.tplDetails,function(r,o){return a("tr",{key:o},[0==o?a("td",{attrs:{rowspan:e.tplDetails.length}},[t._v(t._s(t._f("deliveryWayFilter")(e.deliveryWay)))]):t._e(),t._v(" "),a("td",[t._v(t._s(t._f("districtFilter")(r.districtidList)))]),t._v(" "),a("td",[t._v(t._s(r.firstNum))]),t._v(" "),a("td",[t._v(t._s(t.$cms.float(r.firstPrice)))]),t._v(" "),a("td",[t._v(t._s(r.addNum))]),t._v(" "),a("td",[t._v(t._s(t.$cms.float(r.addPrice)))])])}),0)}),t._v(" "),t.freightInfo.isFree?a("tr",{staticStyle:{"background-color":"#5CB85C"}},[a("td",{attrs:{colspan:"6"}},[t._v("卖家承担邮费")])]):t._e()],2)],1),t._v(" "),a("el-form-item",{ref:"product.volume",attrs:{label:"体积",prop:"product.volume"}},[a("el-input",{attrs:{maxlength:"8"},model:{value:t.formData.product.volume,callback:function(e){t.$set(t.formData.product,"volume",e)},expression:"formData.product.volume"}},[a("template",{slot:"append"},[t._v("立方米")])],2)],1),t._v(" "),a("el-form-item",{ref:"product.weight",attrs:{label:"重量",prop:"product.weight"}},[a("el-input",{attrs:{maxlength:"8"},model:{value:t.formData.product.weight,callback:function(e){t.$set(t.formData.product,"weight",e)},expression:"formData.product.weight"}},[a("template",{slot:"append"},[t._v("kg")])],2)],1),t._v(" "),a("h3",{staticClass:"cms-segmentation"},[t._v("商品相册")]),t._v(" "),a("el-form-item",{ref:"videoResources",attrs:{label:"短视频"}},[a("cms-picture-zone",{attrs:{type:"video",viewType:"media",data:t.formData.videoResources[0],props:{id:"vdResourceId",url:"url"}},on:{change:t.getProductVideo}},[a("cms-button",{attrs:{type:"info",size:"small"}},[t._v("选择视频")])],1)],1),t._v(" "),a("el-form-item",{ref:"imageResources",staticClass:"imageResource",attrs:{label:"商品相册",prop:"imageResources",error:t.errorMessage.imageResources}},[a("div",{staticClass:"clearfix"},[a("draggable",{attrs:{options:{animation:150}},model:{value:t.formData.imageResources,callback:function(e){t.$set(t.formData,"imageResources",e)},expression:"formData.imageResources"}},t._l(t.formData.imageResources,function(e,r){return a("cms-picture-zone",{key:r,staticClass:"product-img-box",attrs:{preview:!1,index:r},on:{change:t.getProductImg}},[a("div",{staticClass:"product-img-warpper"},[t.formData.imageResources[r]&&""!==t.formData.imageResources[r].url?a("img",{attrs:{src:t.$cms.filterUrl(t.formData.imageResources[r].url),alt:""}}):a("span",{staticClass:"img-plus el-icon-plus"})]),t._v(" "),a("div",{staticClass:"img-move-bar",on:{click:function(t){t.stopPropagation()}}},[a("span",{staticClass:"el-icon-arrow-left next",class:[0===r?"disable":""],on:{click:function(e){e.stopPropagation(),t.imgMove(r,"next")}}}),t._v(" "),a("span",{staticClass:"el-icon-arrow-right next",class:[4===r?"disable":""],on:{click:function(e){e.stopPropagation(),t.imgMove(r,"prev")}}}),t._v(" "),a("span",{staticClass:"el-icon-close delete",on:{click:function(e){e.stopPropagation(),t.imgDelete(r)}}})])])}),1)],1),t._v(" "),a("span",{staticClass:"gray",staticStyle:{"max-width":"490px"}},[t._v("用于显示在商品详情页介绍图，最多可支持7张，第一张默认为商品主图用于显示商品列表，拖动照片可调整图片顺序")])]),t._v(" "),a("h3",{staticClass:"cms-segmentation"},[t._v("详细信息")]),t._v(" "),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:"pc"==t.txtModel,expression:"txtModel=='pc'"}],attrs:{label:"",prop:"checked","label-width":"0"}},[t.status?a("cms-editor",{model:{value:t.formData.txt.pcTxt,callback:function(e){t.$set(t.formData.txt,"pcTxt",e)},expression:"formData.txt.pcTxt"}}):t._e()],1),t._v(" "),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:"pc"==t.txtModel,expression:"txtModel=='pc'"}],staticClass:"add-select-padd",attrs:{label:"顶部版式",prop:"txt.topTplId"}},[a("el-select",{attrs:{"popper-append-to-body":!0},model:{value:t.formData.txt.topTplId,callback:function(e){t.$set(t.formData.txt,"topTplId",e)},expression:"formData.txt.topTplId"}},t._l(t.formatItems,function(t){return a("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}),1),t._v(" "),a("span",{staticClass:"gray"},[t._v("选中的版式将插入至PC端商品详情最顶部")])],1),t._v(" "),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:"pc"==t.txtModel,expression:"txtModel=='pc'"}],staticClass:"add-select-padd",attrs:{label:"底部版式",prop:"txt.bottomTplId"}},[a("el-select",{attrs:{"popper-append-to-body":!1},model:{value:t.formData.txt.bottomTplId,callback:function(e){t.$set(t.formData.txt,"bottomTplId",e)},expression:"formData.txt.bottomTplId"}},t._l(t.formatItems,function(t){return a("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}),1),t._v(" "),a("span",{staticClass:"gray"},[t._v("选中的版式将插入至PC端商品详情最底部")])],1),t._v(" "),a("h3",{staticClass:"cms-segmentation"},[t._v("其他信息")]),t._v(" "),a("el-form-item",{attrs:{label:"商品单位",prop:"ext.unit"}},[a("el-input",{attrs:{maxlength:"5"},model:{value:t.formData.ext.unit,callback:function(e){t.$set(t.formData.ext,"unit",e)},expression:"formData.ext.unit"}}),t._v(" "),a("span",{staticClass:"gray"},[t._v("可输入件、盒、份、个，默认为件")])],1),t._v(" "),a("el-form-item",{attrs:{label:"商品服务",prop:"ext.storeServiceIds"}},[a("el-checkbox-group",{model:{value:t.formData.ext.storeServiceId,callback:function(e){t.$set(t.formData.ext,"storeServiceId",e)},expression:"formData.ext.storeServiceId"}},t._l(t.serviceItems,function(e){return a("el-checkbox",{key:e.id,attrs:{label:e.id}},[t._v(t._s(e.serviceName))])}),1)],1),t._v(" "),a("el-form-item",{ref:"product.sellGoodsSale",attrs:{label:"是否为销售商品出售",prop:"product.sellGoodsSale"}},[a("cms-switch",{model:{value:t.formData.product.sellGoodsSale,callback:function(e){t.$set(t.formData.product,"sellGoodsSale",e)},expression:"formData.product.sellGoodsSale"}})],1),t._v(" "),a("el-form-item",{ref:"product.isInvoice",attrs:{label:"是否为提供发票",prop:"product.isInvoice"}},[a("cms-switch",{model:{value:t.formData.product.isInvoice,callback:function(e){t.$set(t.formData.product,"isInvoice",e)},expression:"formData.product.isInvoice"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"商品关键词",prop:"ext.keyword"}},[a("el-input",{attrs:{placeholder:"请输入商品关键词",type:"textarea",resize:"none",maxlength:"200"},model:{value:t.formData.ext.keyword,callback:function(e){t.$set(t.formData.ext,"keyword",e)},expression:"formData.ext.keyword"}}),t._v(" "),a("span",{staticClass:"gray"},[t._v("设置检索关键词,用于商品搜索,最多支持5个，使用','分隔")])],1),t._v(" "),a("el-form-item",{attrs:{label:"评价标签",prop:"ext.evaluationView"}},[a("el-input",{attrs:{placeholder:"请输入评价标签",type:"textarea",resize:"none",maxlength:"200"},model:{value:t.formData.ext.evaluationView,callback:function(e){t.$set(t.formData.ext,"evaluationView",e)},expression:"formData.ext.evaluationView"}}),t._v(" "),a("span",{staticClass:"gray"},[t._v("买家评价商品时，可对商品选择对应标签进行评价，如性价比高，使用','分隔")])],1)],1),t._v(" "),a("div",{staticClass:"product-footer",class:[t.fixed?"fixed-footer":""]},[a("cms-button",{directives:[{name:"color",rawName:"v-color"}],on:{click:function(e){t.nextStep(!0)}}},[t._v("下一步,设置规格/属性信息")]),t._v(" "),a("cms-button",{staticStyle:{background:"#efae00"},on:{click:function(e){t.nextStep(!1)}}},[t._v("立即保存")])],1)],1)},staticRenderFns:[]};var D=a("C7Lr")(k,I,!1,function(t){a("sbI1")},"data-v-3864ad86",null).exports,S=a("NDfU"),w=a("UdxI"),T={coreModel:{salePrice:"",marketPrice:0,costPrice:0,inventory:0,warningValue:0,hasSku:!1},skuTypeAttrs:[],skus:[],proAttrs:[]},$={data:function(){var t=this;return{loading:!1,status:!1,fixed:!0,popoverVisible:!1,popoverForm:{name:"",attrValues:""},storeId:0,productTypeId:0,loadingTitle:"正在保存,请勿进行其他操作",defaultData:{},formData:p()({},T),batch:{salesPrice:"",costPrice:"",inventory:"",marketPrice:"",warning:""},rules:{"coreModel.salePrice":[m.a.required("必须输入一个价格"),m.a.float(),m.a.decimal(),m.a.custom(function(e,a,r){t.formData.coreModel.hasSku?r():parseFloat(a)<=0?r(new Error("请输入大于0的数字")):r()})],"coreModel.marketPrice":[m.a.float(),m.a.decimal()],"coreModel.costPrice":[m.a.float(),m.a.decimal()],"coreModel.inventory":[m.a.required("请输入库存量"),m.a.custom(function(e,a,r){t.formData.coreModel.hasSku?r():""===a?r(new Error("请输入库存量")):""===t.formData.coreModel.warningValue||0===t.formData.coreModel.warningValue?r():a<t.formData.coreModel.warningValue?r(new Error("库存量必须大于库存预警值")):/^[1-9]\d*$/.test(a)?r():r(new Error("请输入大于0的整数"))})],"coreModel.warningValue":[m.a.custom(function(t,e,a){""===e?a():/^[0-9]{0,8}$/.test(e)?a():a(new Error("库存预警值只能为正整数"))})],"coreModel.hasSku":[m.a.required()]},customStandardValue:{},customAttributeValue:{},checkSaleStandardIds:[],standardImageUrls:{},properties:[],attributes:[],saleStandardInfos:[],productStandardInfos:[],skus:[],attributeGroups:{}}},computed:{allCheckedLength:function(){var t=0;return this.properties.forEach(function(e){t+=e.attrValueList.length}),t}},methods:{initData:function(){var t=this.$store.state.product.productInfo;this.storeId=this.$store.state.product.storeId,this.productTypeId=this.$store.state.product.productTypeId,this.formData.coreModel=t.coreModel,this.formData.skus=t.skus,this.formData.productType=t.productType,this.saleStandardInfos=t.proTypeAttrItems.saleAttrs,this.productStandardInfos=t.proTypeAttrItems.nsaleAttrs,this.attributes=t.proAttrs,this.properties=t.skuTypeAttrs,this.setDefaultProperties(),this.setDefaultAttributes(t.proAttrs),this.setRadioProperties(t.proTypeAttrItems.saleAttrs),this.defaultData=t},deleteSkus:function(t,e){this.skus.splice(e,1),this.sysDeletedSkus(),t.id&&Object(y.s)({ids:[t.id]}).then(function(t){})},sysDeletedSkus:function(){var t=this,e=[];this.skus.forEach(function(t){e=e.concat(t.attrCodes)}),this.properties.forEach(function(a,r){a.attrValueList.forEach(function(r,o){if(!e.includes(r.attrCode)){var i=t.checkSaleStandardIds.indexOf(r.attrCode);t.checkSaleStandardIds.splice(i,1),a.attrValueList.splice(o,1)}})})},setDefaultProperties:function(){var t=this;this.properties.forEach(function(e){e.attrValueList.forEach(function(e){t.checkSaleStandardIds.push(e.attrCode),t.standardImageUrls[e.attrCode]=e.url})})},setRadioProperties:function(t){t.forEach(function(t){2===t.valueType?(t.radioValue="",t.attrValueSet.forEach(function(e){e.isChecked&&(t.radioValue=e.attrCode)})):4===t.valueType&&t.attrValueSet.forEach(function(t){t.valueResourceId=t.resourceData?t.resourceData.id:""})})},setDefaultAttributes:function(t){var e={};return t.forEach(function(t){3===t.attrValueType?t.attrVc.indexOf(",")<0?e[t.proTypeAttrId+"s"]=[t.attrVc]:e[t.proTypeAttrId+"s"]=t.attrVc.split(","):e[t.proTypeAttrId+"s"]=t.attrVc}),this.attributeGroups=e,e},setRadioSkus:function(t){var e=this;this.saleStandardInfos.forEach(function(a,r){var o=[];a.attrValueSet.forEach(function(e,a){t.indexOf(e.attrCode)>-1&&o.push(e)}),e.properties[r].attrValueList=p()(e.properties[r].attrValueList,o),e.createdSkus()})},setProperties:function(t){var e=this,a=this.checkSaleStandardIds;this.saleStandardInfos.forEach(function(t,r){var o=[];t.attrValueSet.forEach(function(t,e){a.indexOf(t.attrCode)>-1&&o.push(t)}),e.properties[r].attrValueList=o})},validateRequire:function(){var t=this,e=!0;return this.formData.coreModel.hasSku&&0!==this.saleStandardInfos.length?this.saleStandardInfos.forEach(function(a,r){if(a.required){var o=t.properties[r];if(o.attrValueList.length<=0)return t.$errorMessage("请选择"+o.name),void(e=!1)}}):e=!0,e},validateAttrRequired:function(){var t=this,e=!0,a=[];return this.productStandardInfos.length>0&&this.productStandardInfos.forEach(function(r){r.attrs.forEach(function(r){if(r.required&&(a.push(r.id),t.attributes.length<a.length&&(e=!1,t.$errorMessage("请填写必填的商品属性")),t.attributes.length>0))for(var o=0;o<t.attributes.length;o++)if(!t.attributes[o].attrVc){e=!1,t.$errorMessage("请填写必填的商品属性");break}})}),e},isAttrRequired:function(t){return!!t.required},setProductInfos:function(t,e,a){var r=!0,o={groupName:e.attrGroupName,attrName:e.name,attrVc:t.attrCode,proTypeAttrId:e.id};if(o.attrVc=3===a?t.target.value:t.attrCode,0===this.attributes.length)this.attributes.push(o);else{var i=!0,n=!1,s=void 0;try{for(var l,c=u()(this.attributes);!(i=(l=c.next()).done);i=!0){var d=l.value;if(d.proTypeAttrId===o.proTypeAttrId){var p=d.attrVc.split(",");if(1===a){var f=p.indexOf(o.attrVc);f>-1?p.splice(f,1):p.push(o.attrVc),d.attrVc=p.join(",")}else d.attrVc=o.attrVc;r=!1;break}}}catch(t){n=!0,s=t}finally{try{!i&&c.return&&c.return()}finally{if(n)throw s}}r&&this.attributes.push(o)}},setCoreModel:function(t){if(t){var e=[[],[],[],[],[],[]],a=e[0],r=e[1],o=e[2],i=e[3],n=e[4];this.formData.skus.length>0&&(this.formData.skus.forEach(function(t,e,s){a.push(t.salesPrice),r.push(t.marketPrice),o.push(t.costPrice),i.push(t.inventory),n.push(t.warning)}),a=a.sort(function(t,e){return t-e}),r=r.sort(function(t,e){return t-e}),o=o.sort(function(t,e){return t-e}),i=i.reduce(function(t,e){return parseInt(t)+parseInt(e)}),n=n.reduce(function(t,e){return parseInt(t)+parseInt(e)}),this.formData.coreModel.salePrice=a[0],this.formData.coreModel.marketPrice=r[0],this.formData.coreModel.costPrice=o[0],this.formData.coreModel.inventory=i,this.formData.coreModel.warningValue=n)}},createdSkus:function(){var t=[];this.properties.forEach(function(e){t.push(e.attrValueList)});var e=Object(w.a)(t),a=this.defaultData.skus;for(var r in e){var o=e[r].attrCodes.sort(function(t,e){return t-e}).join("-"),i=!0,n=!1,s=void 0;try{for(var l,c=u()(a);!(i=(l=c.next()).done);i=!0){var d=l.value;if(o===d.saleAttrCode){d.attrCodes=d.saleAttrCode.split("-"),d.name=e[r].name,e[r]=d;break}}}catch(t){n=!0,s=t}finally{try{!i&&c.return&&c.return()}finally{if(n)throw s}}}this.skus=e},batchPrice:function(t,e){var a=this,r=/^\d{0,8}\.{0,1}(\d{1,2})?$/,o=/^[0-9]{1}[0-9]*$/,i=/^[0-9]+$/;this.skus.forEach(function(n){1===e&&r.test(a.batch[t])&&""!==a.batch[t]?n[t]=a.batch[t]:2===e&&o.test(a.batch[t])?n[t]=a.batch[t]:3===e&&i.test(a.batch[t])?n[t]=a.batch[t]:a.$errorMessage("格式不正确")})},addCustomStandardItem:function(t){var e=this;this.$refs.dialogForm.validate(function(t){if(!t)return!1;Object(y.e)({attrGroupName:"自定义添加",name:e.popoverForm.name,attrValues:e.popoverForm.attrValues,typeId:e.productTypeId,storeId:e.storeId,valueType:2}).then(function(t){var a=t.data;a.attrValueSet=a.attrValueList,delete a.attrValueList,e.saleStandardInfos.push(a),e.properties.push({valueType:t.data.valueType,attrGroupName:t.data.attrGroupName,name:t.data.name,id:t.data.id,attrValueList:[]}),e.popoverVisible=!1,e.popoverForm.name="",e.popoverForm.attrValues=""})})},clearCustomStandardItem:function(){this.popoverVisible=!1,this.popoverForm.name="",this.popoverForm.attrValues="",this.$refs.dialogForm.resetFields()},addCustomStandard:function(t){var e=this;if(void 0===this.customStandardValue["value"+t])this.$errorMessage("请输入规格值名称");else{var a={attrValue:this.customStandardValue["value"+t],storeId:this.storeId,attrId:this.saleStandardInfos[t].id};Object(y.c)(a).then(function(a){if(200===a.code){var r={attrCode:a.data.attrCode,attrValue:a.data.attrValue,id:a.data.id,attrType:a.data.attrType,valueResourceId:""};e.saleStandardInfos[t].attrValueSet.push(r),e.customStandardValue["value"+t]=""}})}},addCustomAttribute:function(t){var e=this;if(void 0!==this.customAttributeValue["value"+t]){var a={name:this.customAttributeValue["value"+t],attrGroupName:this.productStandardInfos[t].attrGroupName,attrValues:"no",typeId:this.productTypeId,storeId:this.storeId};Object(y.b)(a).then(function(a){if(200===a.code){var r={attrGroupName:a.data.attrGroupName,attrValueSet:a.data.attrValueList,custom:a.data.custom,id:a.data.id,name:a.data.name,valueType:a.data.valueType,attrType:a.data.attrType};e.productStandardInfos[t].attrs.push(r),e.customAttributeValue["value"+t]=""}})}else this.$errorMessage("请输入规格值名称")},deleteCustomStandard:function(t,e){var a=this;Object(S.a)({ids:[t.id]}).then(function(t){200===t.code&&(a.saleStandardInfos.splice(e,1),a.properties.splice(e,1))})},deleteCustomStandardValue:function(t,e,a){var r=this;console.log("parentIndex"+e),console.log("index"+a),Object(y.d)({ids:[t.id]}).then(function(o){if(200===o.code){var i=r.checkSaleStandardIds.findIndex(function(e){return e.id===t.id});r.checkSaleStandardIds.splice(i,1),r.setProperties(r.checkSaleStandardIds),r.saleStandardInfos[e].attrValueSet.splice(a,1)}})},deleteCustomAttribute:function(t,e,a){var r=this;Object(S.a)({ids:[t.id]}).then(function(t){200===t.code&&r.productStandardInfos[e].attrs.splice(a,1)})},getStandardImg:function(t,e,a){this.$set(this.standardImageUrls,a.attrCode,t[0].url),this.$set(this.saleStandardInfos[a.parentIndex].attrValueSet[e],"valueResourceId",t[0].id),this.$set(this.saleStandardInfos[a.parentIndex].attrValueSet[e],"url",t[0].url)},prevStep:function(){this.$store.dispatch("setStep","step2")},update:function(){var t=this;this.$refs.form.validate(function(e,a){if(e&&t.validateRequire()&&t.validateSkus()&&t.validateAttrRequired()){t.setCoreModel(t.formData.coreModel.hasSku);var r=t.$cms.deepCopy(t.formData);r.skuTypeAttrs=t.properties,r.skus=t.skus,r.proAttrs=t.attributes,t.$store.dispatch("setStandardInfo",r).then(function(e){t.loading=!0,Object(y.u)(e).then(function(e){t.loading=!1,200===e.code&&(t.$successMessage("修改成功!"),setTimeout(function(){t.$routerLink("/product/sale","list")},1e3))})})}else{var o="";for(var i in a)if(a.hasOwnProperty(i)){o=i.replace(".","_");break}o&&t.errorPosition(o)}})},errorPosition:function(t){var e=document.querySelector("#layout"),a=this.$refs[t].$el;return e.scrollTop=a.offsetTop-350,!1},validateSkus:function(){var t=this,e=!0;if(this.formData.coreModel.hasSku){var a=/^\d{0,8}\.{0,1}(\d{1,2})?$/,r=/^[0-9]{1}[0-9]*$/,o=/^[0-9]+$/;this.skus.length>0&&this.skus.forEach(function(i){a.test(i.salesPrice)&&a.test(i.costPrice)&&a.test(i.marketPrice)?r.test(i.inventory)&&o.test(i.warning)?parseFloat(i.salesPrice)<=0?(e=!1,t.$errorMessage("sku信息中售价不能小于0")):0!==parseInt(i.warning)&&parseInt(i.inventory)<parseInt(i.warning)&&(e=!1,t.$errorMessage("sku信息中库存预警值不能大于库存量")):(e=!1,t.$errorMessage("sku库存信息不符合规范")):(e=!1,t.$errorMessage("sku价格信息不符合规范"))})}return e},goTop:function(){document.querySelector("#layout").scrollTop=0},handleClose:function(){this.popoverVisible=!1,this.$refs.dialogForm.resetFields(),this.popoverForm.name="",this.popoverForm.attrValues=""}},watch:{allCheckedLength:{handler:function(){this.createdSkus()}}},activated:function(){this.goTop(),this.initData(),this.setCoreModel(this.formData.coreModel.hasSku)},mounted:function(){var t=this;document.querySelector("#layout").addEventListener("scroll",function(e){var a=e.target.scrollTop,r=e.target.clientHeight,o=e.target.scrollHeight;!1===t.fixed&&(a+=70),parseInt(a)>o-r-70?t.fixed=!1:t.fixed=!0})}},M={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"cms-form-layout product-main-warpper",attrs:{"element-loading-text":t.loadingTitle}},[a("el-form",{ref:"form",staticStyle:{"margin-bottom":"48px"},attrs:{rules:t.rules,model:t.formData,"label-width":"210px"},nativeOn:{submit:function(t){t.preventDefault()}}},[a("el-form-item",{ref:"coreModel_salePrice",attrs:{label:"售价",prop:"coreModel.salePrice"}},[a("el-input",{attrs:{maxlength:"8",disabled:t.formData.coreModel.hasSku},model:{value:t.formData.coreModel.salePrice,callback:function(e){t.$set(t.formData.coreModel,"salePrice",e)},expression:"formData.coreModel.salePrice"}}),t._v(" "),a("span",{staticClass:"gray"},[t._v("价格控制在0.01~99999999之间的数字，如商品设置SKU，此价格自动记录为最低SKU价格\n      ")])],1),t._v(" "),a("el-form-item",{ref:"product_name",attrs:{label:"市场价",prop:"coreModel.marketPrice"}},[a("el-input",{attrs:{maxlength:"8",disabled:t.formData.coreModel.hasSku},model:{value:t.formData.coreModel.marketPrice,callback:function(e){t.$set(t.formData.coreModel,"marketPrice",e)},expression:"formData.coreModel.marketPrice"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"成本价",prop:"coreModel.costPrice"}},[a("el-input",{attrs:{maxlength:"8",disabled:t.formData.coreModel.hasSku},model:{value:t.formData.coreModel.costPrice,callback:function(e){t.$set(t.formData.coreModel,"costPrice",e)},expression:"formData.coreModel.costPrice"}})],1),t._v(" "),a("el-form-item",{ref:"coreModel_inventory",attrs:{label:"库存量",prop:"coreModel.inventory"}},[a("el-input",{attrs:{maxlength:"8",disabled:t.formData.coreModel.hasSku},model:{value:t.formData.coreModel.inventory,callback:function(e){t.$set(t.formData.coreModel,"inventory",e)},expression:"formData.coreModel.inventory"}}),t._v(" "),a("span",{staticClass:"gray"},[t._v("库存量控制在1~99999999之间的整数，如商品设置SKU，库存量自动计 算为所有SKU库存总和\n      ")])],1),t._v(" "),a("el-form-item",{attrs:{label:"库存预警值",prop:"coreModel.warningValue"}},[a("el-input",{attrs:{maxlength:"8",disabled:t.formData.coreModel.hasSku},model:{value:t.formData.coreModel.warningValue,callback:function(e){t.$set(t.formData.coreModel,"warningValue",e)},expression:"formData.coreModel.warningValue"}}),t._v(" "),a("span",{staticClass:"gray"},[t._v("库存预警值必须少于库存量，如商品设置SKU，预警值自动计算为所有 SKU设定的预警值总和\n      ")])],1),t._v(" "),a("el-form-item",{attrs:{label:"商品规格",prop:"coreModel.hasSku"}},[a("div",[a("el-checkbox",{on:{change:t.setCoreModel},model:{value:t.formData.coreModel.hasSku,callback:function(e){t.$set(t.formData.coreModel,"hasSku",e)},expression:"formData.coreModel.hasSku"}},[t._v("启用商品规格")]),t._v(" "),a("span",{staticClass:"gray"},[t._v("启用商品规格、商品的价格、库存、以SKU信息为准")])],1),t._v(" "),t.formData.coreModel.hasSku?a("el-checkbox-group",{model:{value:t.checkSaleStandardIds,callback:function(e){t.checkSaleStandardIds=e},expression:"checkSaleStandardIds"}},[t._l(t.saleStandardInfos,function(e,r){return a("section",{key:e.id,staticClass:"standard-group"},[a("div",{staticClass:"standard-group-header"},[a("div",{staticClass:"fl"},[a("span",{staticClass:"standard-group-name"},[e.required?a("i",{staticClass:"goods-astrick"},[t._v("*")]):t._e(),t._v(t._s(e.name))]),t._v(" "),4==e.valueType?a("span",{staticClass:"standard-group-desc"},[t._v("( 该规格需要上传图片 )")]):t._e(),t._v(" "),2===e.attrType?a("span",{staticClass:"el-icon-delete del",on:{click:function(a){t.deleteCustomStandard(e,r)}}}):t._e()]),t._v(" "),a("div",{staticClass:"fr"},[a("label",{staticClass:"standard-group-desc"},[t._v("规格值名称")]),t._v(" "),a("el-input",{staticStyle:{width:"110px"},attrs:{maxlength:"30"},model:{value:t.customStandardValue["value"+r],callback:function(e){t.$set(t.customStandardValue,"value"+r,e)},expression:"customStandardValue['value'+index]"}}),t._v(" "),a("cms-button",{staticStyle:{"margin-left":"10px"},attrs:{size:"small",disabled:!e.custom},on:{click:function(e){t.addCustomStandard(r)}}},[t._v("添加")])],1)]),t._v(" "),a("div",{staticClass:"standard-group-body"},[4===e.valueType?a("ul",{staticClass:"clearfix"},t._l(e.attrValueSet,function(e,o){return a("li",{key:e.attrCode,staticClass:"type-img-items"},[a("cms-picture-zone",{staticClass:"product-img-box",attrs:{preview:!1,index:o,params:{parentIndex:r,attrCode:e.attrCode}},on:{change:t.getStandardImg}},[a("div",{staticClass:"product-img-warpper"},[t.standardImageUrls[e.attrCode]&&""!==t.standardImageUrls[e.attrCode]?a("img",{attrs:{src:t.$cms.filterUrl(t.standardImageUrls[e.attrCode]),alt:""}}):a("span",{staticClass:"img-plus el-icon-plus"})])]),t._v(" "),a("div",{staticClass:"img-txt"},[a("el-checkbox",{staticClass:"check-box",attrs:{label:e.attrCode,disabled:!e.valueResourceId},on:{change:t.setProperties},model:{value:e.valueResourceId,callback:function(a){t.$set(e,"valueResourceId",a)},expression:"item.valueResourceId"}},[a("span",{staticClass:"type-value"},[t._v(t._s(e.attrValue))]),t._v(" "),2===e.attrType?a("div",{staticClass:"el-icon-delete del",on:{click:function(a){a.stopPropagation(),t.deleteCustomStandardValue(e,r,o)}}}):t._e()])],1)],1)}),0):a("ul",{staticClass:"clearfix"},t._l(e.attrValueSet,function(e,o){return a("li",{key:e.attrCode,staticClass:"type-checkbox-items"},[a("el-checkbox",{attrs:{label:e.attrCode},on:{change:t.setProperties}},[a("span",{staticClass:"type-value"},[t._v(t._s(e.attrValue))]),t._v(" "),2===e.attrType?a("div",{staticClass:"el-icon-delete del",on:{click:function(a){a.stopPropagation(),t.deleteCustomStandardValue(e,r,o)}}}):t._e()])],1)}),0)])])}),t._v(" "),t.loading?t._e():a("div",{staticStyle:{margin:"20px 0 0 0"}},[t.formData.productType.custom?a("cms-button",{attrs:{icon:"add",size:"small"},on:{click:function(e){t.popoverVisible=!0}}},[t._v("添加规格\n            ")]):t._e()],1),t._v(" "),a("el-dialog",{attrs:{title:"添加规格",top:"35vh",visible:t.popoverVisible,width:"640px","before-close":t.handleClose},on:{"update:visible":function(e){t.popoverVisible=e}}},[a("div",{staticClass:"dialog-form"},[a("el-form",{ref:"dialogForm",attrs:{model:t.popoverForm}},[a("el-form-item",{attrs:{label:"规格名称",prop:"name","label-width":"120px",rules:[{required:!0,message:"必须输入规格名称",trigger:"blur"}]}},[a("el-input",{attrs:{maxlength:"50"},model:{value:t.popoverForm.name,callback:function(e){t.$set(t.popoverForm,"name",e)},expression:"popoverForm.name"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"规格值","label-width":"120px",prop:"attrValues",rules:[{required:!0,message:"必须输入规格值",trigger:"blur"}]}},[a("el-input",{attrs:{type:"textarea",rows:4,placeholder:"多个属性按回车输入",maxlength:"80"},model:{value:t.popoverForm.attrValues,callback:function(e){t.$set(t.popoverForm,"attrValues",e)},expression:"popoverForm.attrValues"}})],1),t._v(" "),a("div",{staticClass:"center"},[a("cms-button",{staticStyle:{"margin-right":"10px"},on:{click:t.addCustomStandardItem}},[t._v("确认")]),t._v(" "),a("cms-button",{attrs:{type:"info"},on:{click:t.clearCustomStandardItem}},[t._v("取消")])],1)],1)],1)])],2):t._e()],1),t._v(" "),t.formData.coreModel.hasSku&&t.skus.length>0?a("el-form-item",{attrs:{label:"sku信息",prop:"name"}},[a("table",{staticClass:"sku-table"},[a("tr",[t._l(t.properties,function(e,r){return e.attrValueList.length>0?a("th",{key:r,attrs:{rowspan:"2"}},[t._v("\n            "+t._s(e.name)+"\n          ")]):t._e()}),t._v(" "),a("th",[a("i",{staticClass:"goods-astrick"},[t._v("*")]),t._v("售价")]),t._v(" "),a("th",[t._v("市场价")]),t._v(" "),a("th",[t._v("成本价")]),t._v(" "),a("th",[a("i",{staticClass:"goods-astrick"},[t._v("*")]),t._v("库存")]),t._v(" "),a("th",[t._v("预警值")]),t._v(" "),a("th",{attrs:{rowspan:"2",width:"60"}},[t._v("操作")])],2),t._v(" "),a("tr",[a("td",[a("el-input",{staticClass:"table-input",attrs:{min:0,maxlength:"8"},model:{value:t.batch.salesPrice,callback:function(e){t.$set(t.batch,"salesPrice",e)},expression:"batch.salesPrice"}},[a("template",{slot:"append"},[a("i",{staticClass:"iconfont icon-zhankai1-copy",on:{click:function(e){t.batchPrice("salesPrice",1)}}})])],2)],1),t._v(" "),a("td",[a("el-input",{staticClass:"table-input",attrs:{min:0,maxlength:"8"},model:{value:t.batch.marketPrice,callback:function(e){t.$set(t.batch,"marketPrice",e)},expression:"batch.marketPrice"}},[a("template",{slot:"append"},[a("i",{staticClass:"iconfont icon-zhankai1-copy",on:{click:function(e){t.batchPrice("marketPrice",1)}}})])],2)],1),t._v(" "),a("td",[a("el-input",{staticClass:"table-input",attrs:{min:0,maxlength:"8"},model:{value:t.batch.costPrice,callback:function(e){t.$set(t.batch,"costPrice",e)},expression:"batch.costPrice"}},[a("template",{slot:"append"},[a("i",{staticClass:"iconfont icon-zhankai1-copy",on:{click:function(e){t.batchPrice("costPrice",1)}}})])],2)],1),t._v(" "),a("td",[a("el-input",{staticClass:"table-input",attrs:{min:0,maxlength:"8"},model:{value:t.batch.inventory,callback:function(e){t.$set(t.batch,"inventory",e)},expression:"batch.inventory"}},[a("template",{slot:"append"},[a("i",{staticClass:"iconfont icon-zhankai1-copy",on:{click:function(e){t.batchPrice("inventory",2)}}})])],2)],1),t._v(" "),a("td",[a("el-input",{staticClass:"table-input",attrs:{min:0,maxlength:"8"},model:{value:t.batch.warning,callback:function(e){t.$set(t.batch,"warning",e)},expression:"batch.warning"}},[a("template",{slot:"append"},[a("i",{staticClass:"iconfont icon-zhankai1-copy",on:{click:function(e){t.batchPrice("warning",3)}}})])],2)],1)]),t._v(" "),t._l(t.skus,function(e,r){return a("tr",{key:r},[t._l(e.name,function(e,r){return a("td",{key:r,staticClass:"min-w-90"},[t._v("\n            "+t._s(e)+"\n          ")])}),t._v(" "),a("td",[a("el-input",{attrs:{maxlength:"8",min:0},model:{value:e.salesPrice,callback:function(a){t.$set(e,"salesPrice",a)},expression:"item.salesPrice"}})],1),t._v(" "),a("td",[a("el-input",{attrs:{maxlength:"8",min:0},model:{value:e.marketPrice,callback:function(a){t.$set(e,"marketPrice",a)},expression:"item.marketPrice"}})],1),t._v(" "),a("td",[a("el-input",{attrs:{maxlength:"8",min:0},model:{value:e.costPrice,callback:function(a){t.$set(e,"costPrice",a)},expression:"item.costPrice"}})],1),t._v(" "),a("td",[a("el-input",{attrs:{maxlength:"8",min:0},model:{value:e.inventory,callback:function(a){t.$set(e,"inventory",a)},expression:"item.inventory"}})],1),t._v(" "),a("td",[a("el-input",{attrs:{maxlength:"8",min:0},model:{value:e.warning,callback:function(a){t.$set(e,"warning",a)},expression:"item.warning"}})],1),t._v(" "),a("td",[a("i",{staticClass:"el-icon-delete del",on:{click:function(a){a.stopPropagation(),t.deleteSkus(e,r)}}})])],2)})],2),t._v(" "),a("span",{staticClass:"gray"},[t._v("注：商品实际销售SKU不存在的组合，可删除，系统将默认保存")])]):t._e(),t._v(" "),a("el-form-item",{attrs:{label:"商品属性",prop:"name"}},t._l(t.productStandardInfos,function(e,r){return a("section",{key:e.id,staticClass:"standard-group"},[a("div",{staticClass:"standard-group-header"},[a("div",{staticClass:"fl"},[a("span",{staticClass:"standard-group-name"},[t._v(t._s(e.attrGroupName))])]),t._v(" "),a("div",{staticClass:"fr"},[a("label",{staticClass:"standard-group-desc"},[t._v("规格值名称")]),t._v(" "),a("el-input",{staticStyle:{width:"110px"},attrs:{maxlength:"30"},model:{value:t.customAttributeValue["value"+r],callback:function(e){t.$set(t.customAttributeValue,"value"+r,e)},expression:"customAttributeValue['value'+index]"}}),t._v(" "),a("cms-button",{staticStyle:{"margin-left":"10px"},attrs:{size:"small"},on:{click:function(e){t.addCustomAttribute(r)}}},[t._v("添加")])],1)]),t._v(" "),a("div",{staticClass:"standard-group-body",staticStyle:{padding:"20px"}},t._l(e.attrs,function(e,o){return a("div",{key:e.id,staticClass:"clearfix",class:[1==e.valueType?"w-50":"w-100"]},[a("label",{staticClass:"fl  attribute-name"},[a("i",{directives:[{name:"show",rawName:"v-show",value:t.isAttrRequired(e),expression:"isAttrRequired(standard)"}],staticClass:"goods-astrick"},[t._v("*")]),t._v("\n              "+t._s(e.name)+"\n            ")]),t._v(" "),3===e.valueType&&e.attrValueSet.length>0?a("ul",{staticClass:"fl"},[a("el-checkbox-group",{model:{value:t.attributeGroups[e.id+"s"],callback:function(a){t.$set(t.attributeGroups,e.id+"s",a)},expression:"attributeGroups[standard.id+'s']"}},t._l(e.attrValueSet,function(r){return a("li",{key:r.id,staticClass:"type-checkbox-items"},[a("el-checkbox",{attrs:{label:r.attrCode},on:{change:function(a){t.setProductInfos(r,e,1)}}},[a("span",{staticClass:"type-value"},[t._v(t._s(r.attrValue))])])],1)}),0)],1):t._e(),t._v(" "),2===e.valueType&&e.attrValueSet.length>0?a("ul",{staticClass:"fl"},[a("el-radio-group",{model:{value:t.attributeGroups[e.id+"s"],callback:function(a){t.$set(t.attributeGroups,e.id+"s",a)},expression:"attributeGroups[standard.id+'s']"}},t._l(e.attrValueSet,function(r){return a("li",{key:r.id,staticClass:"type-radio-items"},[a("el-radio",{attrs:{label:r.attrCode},on:{change:function(a){t.setProductInfos(r,e,2)}}},[a("span",{staticClass:"type-value"},[t._v(t._s(r.attrValue))])])],1)}),0)],1):t._e(),t._v(" "),1===e.valueType?a("el-input",{staticStyle:{width:"220px",position:"relative",top:"0px"},attrs:{maxlength:"50"},on:{blur:function(a){t.setProductInfos(a,e,3)}},model:{value:t.attributeGroups[e.id+"s"],callback:function(a){t.$set(t.attributeGroups,e.id+"s",a)},expression:"attributeGroups[standard.id+'s']"}}):t._e(),t._v(" "),2==e.attrType?a("div",{staticClass:"el-icon-delete del",on:{click:function(a){t.deleteCustomAttribute(e,r,o)}}}):t._e()],1)}),0)])}),0)],1),t._v(" "),a("div",{staticClass:"product-footer",class:[t.fixed?"fixed-footer":""]},[a("cms-button",{directives:[{name:"color",rawName:"v-color"}],staticStyle:{background:"#f7f7f7",color:"#444"},on:{click:function(e){t.prevStep()}}},[t._v("上一步")]),t._v(" "),a("cms-button",{staticStyle:{background:"#efae00"},on:{click:function(e){t.update()}}},[t._v("立即发布")])],1)],1)},staticRenderFns:[]};var P={components:{step1:n,step2:D,step3:a("C7Lr")($,M,!1,function(t){a("W8wZ")},"data-v-ffb2de94",null).exports,step4:a("C7Lr")(null,null,!1,null,null,null).exports},data:function(){return{}},computed:{currentView:function(){return this.$store.state.product.step}},methods:{setStep:function(t){this.$store.dispatch("setStep",t)}},created:function(){"update"===this.$route.query.type&&this.$store.dispatch("setStep","step2")},activated:function(){"update"===this.$route.query.type&&this.$store.dispatch("setStep","step2")}},V={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"main-layout"},[a("cms-breadcrumb",{staticClass:"pos-breadcrumb",staticStyle:{"margin-bottom":"15px"},attrs:{to:"/product/sale",type:"list"}},[a("li",[t._v(t._s(t.$route.name))])]),t._v(" "),a("div",{staticClass:"fixed-bar"},[a("cms-prompt",{staticClass:"pos-prompt"},[a("li",[t._v("\n          带\n          "),a("span",{staticStyle:{color:"#ff0000"}},[t._v("*")]),t._v(" 为必填项\n        ")])]),t._v(" "),a("ul",{staticClass:"cms-steps"},[a("li",{staticClass:"cms-step",class:"step1"==t.currentView?"active":""},[a("span",{staticClass:"cms-step-index"},[t._v("1")]),t._v(" "),t._m(0)]),t._v(" "),a("li",{staticClass:"cms-step",class:"step2"==t.currentView?"active":""},[a("span",{staticClass:"cms-step-index"},[t._v("2")]),t._v(" "),t._m(1)]),t._v(" "),a("li",{staticClass:"cms-step",class:"step3"==t.currentView?"active":""},[a("span",{staticClass:"cms-step-index"},[t._v("3")]),t._v(" "),t._m(2)])])],1),t._v(" "),a("div",{staticClass:"product-layout",staticStyle:{padding:"0 0 70px 0"},attrs:{id:"productLayout"}},[a("keep-alive",[a(t.currentView,{tag:"component"})],1)],1)],1)])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("span",{staticClass:"cms-step-name"},[e("i",{staticClass:"iconfont icon-fenlei-sel"}),this._v("\n            选择商品分类\n          ")])},function(){var t=this.$createElement,e=this._self._c||t;return e("span",{staticClass:"cms-step-name"},[e("i",{staticClass:"iconfont icon-zongjie"}),this._v("\n            填写商品信息\n          ")])},function(){var t=this.$createElement,e=this._self._c||t;return e("span",{staticClass:"cms-step-name"},[e("i",{staticClass:"iconfont icon-gaojishuxing"}),this._v("\n            设置规格/属性信息\n          ")])}]};var E=a("C7Lr")(P,V,!1,function(t){a("wYqO")},"data-v-af19e952",null);e.default=E.exports},lPr8:function(t,e,a){var r,o;
/**!
 * Sortable
 * @author	RubaXa   <trash@rubaxa.org>
 * @author	owenm    <owen23355@gmail.com>
 * @license MIT
 */
/**!
 * Sortable
 * @author	RubaXa   <trash@rubaxa.org>
 * @author	owenm    <owen23355@gmail.com>
 * @license MIT
 */
!function(i){"use strict";void 0===(o="function"==typeof(r=i)?r.call(e,a,e,t):r)||(t.exports=o)}(function(){"use strict";if("undefined"==typeof window||!window.document)return function(){throw new Error("Sortable.js requires a window with a document")};var t,e,a,r,o,i,n,s,l,c,u,d,p,f,h,m,v,g,b,_,y,C,x,k,I,D=[],S=!1,w=!1,T=!1,$=[],M=!1,P=!1,V=/\s+/g,E="Sortable"+(new Date).getTime(),R=window,N=R.document,A=R.parseInt,O=R.setTimeout,L=R.jQuery||R.Zepto,F=R.Polymer,q={capture:!1,passive:!1},X=!!navigator.userAgent.match(/(?:Trident.*rv[ :]?11\.|msie|iemobile)/i),Y=!!navigator.userAgent.match(/Edge/i),U=Y||X?"cssFloat":"float",j="draggable"in N.createElement("div"),H=function(){if(X)return!1;var t=N.createElement("x");return t.style.cssText="pointer-events:auto","auto"===t.style.pointerEvents}(),G=!1,B=!1,z=Math.abs,W=Math.min,K=[],Q=function(t,e){var a=mt(t),r=A(a.width),o=xt(t,0,e),i=xt(t,1,e),n=o&&mt(o),s=i&&mt(i),l=n&&A(n.marginLeft)+A(n.marginRight)+Vt(o).width,c=s&&A(s.marginLeft)+A(s.marginRight)+Vt(i).width;return"flex"===a.display?"column"===a.flexDirection||"column-reverse"===a.flexDirection?"vertical":"horizontal":o&&("block"===n.display||"flex"===n.display||"table"===n.display||"grid"===n.display||l>=r&&"none"===a[U]||i&&"none"===a[U]&&l+c>r)?"vertical":"horizontal"},J=function(t,e){if(!t||!t.getBoundingClientRect)return R;var a=t,r=!1;do{if(a.clientWidth<a.scrollWidth||a.clientHeight<a.scrollHeight){var o=mt(a);if(a.clientWidth<a.scrollWidth&&("auto"==o.overflowX||"scroll"==o.overflowX)||a.clientHeight<a.scrollHeight&&("auto"==o.overflowY||"scroll"==o.overflowY)){if(!a||!a.getBoundingClientRect||a===N.body)return R;if(r||e)return a;r=!0}}}while(a=a.parentNode);return R},Z=wt(function(t,e,a,r){if(e.scroll){var o=a?a[E]:window,i=e.scrollSensitivity,n=e.scrollSpeed,u=t.clientX,d=t.clientY,p=(window.innerWidth,window.innerHeight,!1);l!==a&&(tt(),s=e.scroll,c=e.scrollFn,!0===s&&(s=J(a,!0),l=s));var f=0,h=s;do{var m,v,g,_,y,C,x,k,I,w=h,T=Vt(w),$=T.top,M=T.bottom,P=T.left,V=T.right,A=T.width,O=T.height;if(w!==R?(m=w.scrollWidth,v=w.scrollHeight,g=mt(w),C=A<m&&("auto"===g.overflowX||"scroll"===g.overflowX),x=O<v&&("auto"===g.overflowY||"scroll"===g.overflowY),k=w.scrollLeft,I=w.scrollTop):(m=N.documentElement.scrollWidth,v=N.documentElement.scrollHeight,g=mt(N.documentElement),C=A<m&&("auto"===g.overflowX||"scroll"===g.overflowX||"visible"===g.overflowX),x=O<v&&("auto"===g.overflowY||"scroll"===g.overflowY||"visible"===g.overflowY),k=N.documentElement.scrollLeft,I=N.documentElement.scrollTop),_=C&&(z(V-u)<=i&&k+A<m)-(z(P-u)<=i&&!!k),y=x&&(z(M-d)<=i&&I+O<v)-(z($-d)<=i&&!!I),!D[f])for(var L=0;L<=f;L++)D[L]||(D[L]={});D[f].vx==_&&D[f].vy==y&&D[f].el===w||(D[f].el=w,D[f].vx=_,D[f].vy=y,clearInterval(D[f].pid),!w||0==_&&0==y||(p=!0,D[f].pid=setInterval(function(){r&&0===this.layer&&ct.active._emulateDragOver(!0);var e=D[this.layer].vy?D[this.layer].vy*n:0,a=D[this.layer].vx?D[this.layer].vx*n:0;"function"==typeof c&&"continue"!==c.call(o,a,e,t,b,D[this.layer].el)||(D[this.layer].el===R?R.scrollTo(R.pageXOffset+a,R.pageYOffset+e):(D[this.layer].el.scrollTop+=e,D[this.layer].el.scrollLeft+=a))}.bind({layer:f}),24))),f++}while(e.bubbleScroll&&h!==R&&(h=J(h,!1)));S=p}},30),tt=function(){D.forEach(function(t){clearInterval(t.pid)}),D=[]},et=function(t){function e(t,a){return function(r,o,i,n){var s=r.options.group.name&&o.options.group.name&&r.options.group.name===o.options.group.name;if(null==t&&(a||s))return!0;if(null==t||!1===t)return!1;if(a&&"clone"===t)return t;if("function"==typeof t)return e(t(r,o,i,n),a)(r,o,i,n);var l=(a?r:o).options.group.name;return!0===t||"string"==typeof t&&t===l||t.join&&t.indexOf(l)>-1}}var a={},r=t.group;r&&"object"==typeof r||(r={name:r}),a.name=r.name,a.checkPull=e(r.pull,!0),a.checkPut=e(r.put),a.revertClone=r.revertClone,t.group=a},at=function(e){t&&t.parentNode&&t.parentNode[E]&&t.parentNode[E]._computeIsAligned(e)},rt=function(t,e){for(var a=e;!a[E];)a=a.parentNode;return t===a},ot=function(t,e,a){for(var r=t.parentNode;r&&!r[E];)r=r.parentNode;r&&r[E][a](Tt(e,{artificialBubble:!0}))},it=function(){!H&&a&&mt(a,"display","none")},nt=function(){!H&&a&&mt(a,"display","")};N.addEventListener("click",function(t){if(T)return t.preventDefault(),t.stopPropagation&&t.stopPropagation(),t.stopImmediatePropagation&&t.stopImmediatePropagation(),T=!1,!1},!0);var st,lt=function(e){if(t){var a=function(t,e){for(var a=0;a<$.length;a++)if(!$[a].children.length){var r=Vt($[a]),o=$[a][E].options.emptyInsertThreshold,i=t>=r.left-o&&t<=r.right+o,n=e>=r.top-o&&e<=r.bottom+o;if(i&&n)return $[a]}}(e.clientX,e.clientY);a&&a[E]._onDragOver({clientX:e.clientX,clientY:e.clientY,target:a,rootEl:a})}};function ct(t,e){if(!t||!t.nodeType||1!==t.nodeType)throw"Sortable: `el` must be HTMLElement, not "+{}.toString.call(t);this.el=t,this.options=e=Tt({},e),t[E]=this;var a={group:null,sort:!0,disabled:!1,store:null,handle:null,scroll:!0,scrollSensitivity:30,scrollSpeed:10,bubbleScroll:!0,draggable:/[uo]l/i.test(t.nodeName)?"li":">*",swapThreshold:1,invertSwap:!1,invertedSwapThreshold:null,removeCloneOnHide:!0,direction:function(){return Q(t,this.options)},ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",dragClass:"sortable-drag",ignore:"a, img",filter:null,preventOnFilter:!0,animation:0,easing:null,setData:function(t,e){t.setData("Text",e.textContent)},dropBubble:!1,dragoverBubble:!1,dataIdAttr:"data-id",delay:0,touchStartThreshold:A(window.devicePixelRatio,10)||1,forceFallback:!1,fallbackClass:"sortable-fallback",fallbackOnBody:!1,fallbackTolerance:0,fallbackOffset:{x:0,y:0},supportPointer:!1!==ct.supportPointer&&("PointerEvent"in window||window.navigator&&"msPointerEnabled"in window.navigator),emptyInsertThreshold:5};for(var r in a)!(r in e)&&(e[r]=a[r]);for(var o in et(e),this)"_"===o.charAt(0)&&"function"==typeof this[o]&&(this[o]=this[o].bind(this));this.nativeDraggable=!e.forceFallback&&j,e.supportPointer?pt(t,"pointerdown",this._onTapStart):(pt(t,"mousedown",this._onTapStart),pt(t,"touchstart",this._onTapStart)),this.nativeDraggable&&(pt(t,"dragover",this),pt(t,"dragenter",this)),$.push(this.el),e.store&&e.store.get&&this.sort(e.store.get(this)||[])}function ut(t,e,a,r){if(t){a=a||N;do{if(">*"===e&&t.parentNode===a||St(t,e)||r&&t===a)return t;if(t===a)break}while(t=dt(t))}return null}function dt(t){return t.host&&t!==N&&t.host.nodeType?t.host:t.parentNode}function pt(t,e,a){t.addEventListener(e,a,q)}function ft(t,e,a){t.removeEventListener(e,a,q)}function ht(t,e,a){if(t&&e)if(t.classList)t.classList[a?"add":"remove"](e);else{var r=(" "+t.className+" ").replace(V," ").replace(" "+e+" "," ");t.className=(r+(a?" "+e:"")).replace(V," ")}}function mt(t,e,a){var r=t&&t.style;if(r){if(void 0===a)return N.defaultView&&N.defaultView.getComputedStyle?a=N.defaultView.getComputedStyle(t,""):t.currentStyle&&(a=t.currentStyle),void 0===e?a:a[e];e in r||-1!==e.indexOf("webkit")||(e="-webkit-"+e),r[e]=a+("string"==typeof a?"":"px")}}function vt(t){var e="";do{var a=mt(t,"transform");a&&"none"!==a&&(e=a+" "+e)}while(t=t.parentNode);return window.DOMMatrix?new DOMMatrix(e):window.WebKitCSSMatrix?new WebKitCSSMatrix(e):window.CSSMatrix?new CSSMatrix(e):void 0}function gt(t,e,a){if(t){var r=t.getElementsByTagName(e),o=0,i=r.length;if(a)for(;o<i;o++)a(r[o],o);return r}return[]}function bt(t,e,a,o,i,n,s,l,c){var u,d=(t=t||e[E]).options,p="on"+a.charAt(0).toUpperCase()+a.substr(1);!window.CustomEvent||X||Y?(u=N.createEvent("Event")).initEvent(a,!0,!0):u=new CustomEvent(a,{bubbles:!0,cancelable:!0}),u.to=i||e,u.from=n||e,u.item=o||e,u.clone=r,u.oldIndex=s,u.newIndex=l,u.originalEvent=c,e&&e.dispatchEvent(u),d[p]&&d[p].call(t,u)}function _t(t,e,a,r,o,i,n,s){var l,c,u=t[E],d=u.options.onMove;return!window.CustomEvent||X||Y?(l=N.createEvent("Event")).initEvent("move",!0,!0):l=new CustomEvent("move",{bubbles:!0,cancelable:!0}),l.to=e,l.from=t,l.dragged=a,l.draggedRect=r,l.related=o||e,l.relatedRect=i||Vt(e),l.willInsertAfter=s,l.originalEvent=n,t.dispatchEvent(l),d&&(c=d.call(u,l,n)),c}function yt(t){t.draggable=!1}function Ct(){G=!1}function xt(e,r,o){for(var i=0,n=0,s=e.children;n<s.length;){if("none"!==s[n].style.display&&s[n]!==a&&s[n]!==t&&ut(s[n],o.draggable,e,!1)){if(i===r)return s[n];i++}n++}return null}function kt(t){var e=t.lastElementChild;return e===a&&(e=t.children[t.childElementCount-2]),e||null}function It(t){for(var e=t.tagName+t.className+t.src+t.href+t.textContent,a=e.length,r=0;a--;)r+=e.charCodeAt(a);return r.toString(36)}function Dt(t,e){var a=0;if(!t||!t.parentNode)return-1;for(;t&&(t=t.previousElementSibling);)"TEMPLATE"!==t.nodeName.toUpperCase()&&t!==r&&a++;return a}function St(t,e){if(t)try{if(t.matches)return t.matches(e);if(t.msMatchesSelector)return t.msMatchesSelector(e);if(t.webkitMatchesSelector)return t.webkitMatchesSelector(e)}catch(t){return!1}return!1}function wt(t,e){return function(){if(!st){var a=arguments,r=this;st=O(function(){1===a.length?t.call(r,a[0]):t.apply(r,a),st=void 0},e)}}}function Tt(t,e){if(t&&e)for(var a in e)e.hasOwnProperty(a)&&(t[a]=e[a]);return t}function $t(t){return F&&F.dom?F.dom(t).cloneNode(!0):L?L(t).clone(!0)[0]:t.cloneNode(!0)}function Mt(t){return O(t,0)}function Pt(t){return clearTimeout(t)}function Vt(t,e,a){if(t.getBoundingClientRect||t===R){var r,o,i,n,s,l,c;if(t!==R?(o=(r=t.getBoundingClientRect()).top,i=r.left,n=r.bottom,s=r.right,l=r.height,c=r.width):(o=0,i=0,n=window.innerHeight,s=window.innerWidth,l=window.innerHeight,c=window.innerWidth),a&&t!==R){if(e=e||t.parentNode,!X)do{if(e&&e.getBoundingClientRect&&"none"!==mt(e,"transform")){var u=e.getBoundingClientRect();o-=u.top+A(mt(e,"border-top-width")),i-=u.left+A(mt(e,"border-left-width")),n=o+r.height,s=i+r.width;break}}while(e=e.parentNode);var d=vt(t),p=d&&d.a,f=d&&d.d;d&&(n=(o/=f)+(l/=f),s=(i/=p)+(c/=p))}return{top:o,left:i,bottom:n,right:s,width:c,height:l}}}return N.addEventListener("dragover",lt),N.addEventListener("mousemove",lt),ct.prototype={constructor:ct,_computeIsAligned:function(e){var r;if(a&&!H?(it(),r=N.elementFromPoint(e.clientX,e.clientY),nt()):r=e.target,r=ut(r,this.options.draggable,this.el,!1),!B&&t&&t.parentNode===this.el){for(var o,i,n,s,l,c,u,d,p=this.el.children,f=0;f<p.length;f++)ut(p[f],this.options.draggable,this.el,!1)&&p[f]!==r&&(p[f].sortableMouseAligned=(o=e.clientX,i=e.clientY,n=p[f],s=this._getDirection(e,null),this.options,void 0,void 0,void 0,void 0,l=Vt(n),c="vertical"===s?l.left:l.top,u="vertical"===s?l.right:l.bottom,c<(d="vertical"===s?o:i)&&d<u));ut(r,this.options.draggable,this.el,!0)||(y=null),B=!0,O(function(){B=!1},30)}},_getDirection:function(e,a){return"function"==typeof this.options.direction?this.options.direction.call(this,e,a,t):this.options.direction},_onTapStart:function(e){if(e.cancelable){var a,r=this,o=this.el,i=this.options,s=i.preventOnFilter,l=e.type,c=e.touches&&e.touches[0],u=(c||e).target,d=e.target.shadowRoot&&(e.path&&e.path[0]||e.composedPath&&e.composedPath()[0])||u,p=i.filter;if(function(t){K.length=0;var e=t.getElementsByTagName("input"),a=e.length;for(;a--;){var r=e[a];r.checked&&K.push(r)}}(o),(!X||e.artificialBubble||rt(o,u))&&!t&&!(/mousedown|pointerdown/.test(l)&&0!==e.button||i.disabled||d.isContentEditable))if(u=ut(u,i.draggable,o,!1)){if(n!==u){if(a=Dt(u,i.draggable),"function"==typeof p){if(p.call(this,e,u,this))return bt(r,d,"filter",u,o,o,a),void(s&&e.cancelable&&e.preventDefault())}else if(p&&(p=p.split(",").some(function(t){if(t=ut(d,t.trim(),o,!1))return bt(r,t,"filter",u,o,o,a),!0})))return void(s&&e.cancelable&&e.preventDefault());i.handle&&!ut(d,i.handle,o,!1)||this._prepareDragStart(e,c,u,a)}}else X&&ot(o,e,"_onTapStart")}},_handleAutoScroll:function(e,a){if(t&&this.options.scroll){var r=e.clientX,o=e.clientY,i=N.elementFromPoint(r,o),n=this;if(a||Y||X){Z(e,n.options,i,a);var s=J(i,!0);!S||h&&r===m&&o===v||(h&&clearInterval(h),h=setInterval(function(){if(t){var i=J(N.elementFromPoint(r,o),!0);i!==s&&(s=i,tt(),Z(e,n.options,s,a))}},10),m=r,v=o)}else{if(!n.options.bubbleScroll||J(i,!0)===window)return void tt();Z(e,n.options,J(i,!1),!1)}}},_prepareDragStart:function(a,r,s,l){var c,d=this,f=d.el,h=d.options,m=f.ownerDocument;s&&!t&&s.parentNode===f&&(o=f,e=(t=s).parentNode,i=t.nextSibling,n=s,p=h.group,u=l,g={target:t,clientX:(r||a).clientX,clientY:(r||a).clientY},this._lastX=(r||a).clientX,this._lastY=(r||a).clientY,t.style["will-change"]="all",t.style.transition="",t.style.transform="",c=function(){d._disableDelayedDrag(),t.draggable=d.nativeDraggable,d._triggerDragStart(a,r),bt(d,o,"choose",t,o,o,u),ht(t,h.chosenClass,!0)},h.ignore.split(",").forEach(function(e){gt(t,e.trim(),yt)}),h.supportPointer?(pt(m,"pointerup",d._onDrop),pt(m,"pointercancel",d._onDrop)):(pt(m,"mouseup",d._onDrop),pt(m,"touchend",d._onDrop),pt(m,"touchcancel",d._onDrop)),h.delay?(pt(m,"mouseup",d._disableDelayedDrag),pt(m,"touchend",d._disableDelayedDrag),pt(m,"touchcancel",d._disableDelayedDrag),pt(m,"mousemove",d._delayedDragTouchMoveHandler),pt(m,"touchmove",d._delayedDragTouchMoveHandler),h.supportPointer&&pt(m,"pointermove",d._delayedDragTouchMoveHandler),d._dragStartTimer=O(c,h.delay)):c())},_delayedDragTouchMoveHandler:function(t){var e=t.touches?t.touches[0]:t;W(z(e.clientX-this._lastX),z(e.clientY-this._lastY))>=this.options.touchStartThreshold&&this._disableDelayedDrag()},_disableDelayedDrag:function(){var t=this.el.ownerDocument;clearTimeout(this._dragStartTimer),ft(t,"mouseup",this._disableDelayedDrag),ft(t,"touchend",this._disableDelayedDrag),ft(t,"touchcancel",this._disableDelayedDrag),ft(t,"mousemove",this._delayedDragTouchMoveHandler),ft(t,"touchmove",this._delayedDragTouchMoveHandler),ft(t,"pointermove",this._delayedDragTouchMoveHandler)},_triggerDragStart:function(e,a){a=a||("touch"==e.pointerType?e:null),!this.nativeDraggable||a?this.options.supportPointer?pt(N,"pointermove",this._onTouchMove):pt(N,a?"touchmove":"mousemove",this._onTouchMove):(pt(t,"dragend",this),pt(o,"dragstart",this._onDragStart));try{N.selection?Mt(function(){N.selection.empty()}):window.getSelection().removeAllRanges()}catch(t){}},_dragStarted:function(e){if(w=!1,o&&t){this.nativeDraggable&&(pt(N,"dragover",this._handleAutoScroll),pt(N,"dragover",at));var a=this.options;!e&&ht(t,a.dragClass,!1),ht(t,a.ghostClass,!0),mt(t,"transform",""),ct.active=this,e&&this._appendGhost(),bt(this,o,"start",t,o,o,u)}else this._nulling()},_emulateDragOver:function(e){if(b){if(this._lastX===b.clientX&&this._lastY===b.clientY&&!e)return;this._lastX=b.clientX,this._lastY=b.clientY,it();for(var a=N.elementFromPoint(b.clientX,b.clientY),r=a;a&&a.shadowRoot;)r=a=a.shadowRoot.elementFromPoint(b.clientX,b.clientY);if(r)do{if(r[E])if(r[E]._onDragOver({clientX:b.clientX,clientY:b.clientY,target:a,rootEl:r})&&!this.options.dragoverBubble)break;a=r}while(r=r.parentNode);t.parentNode[E]._computeIsAligned(b),nt()}},_onTouchMove:function(t){if(g){if(!t.cancelable)return;var e=this.options,r=e.fallbackTolerance,o=e.fallbackOffset,i=t.touches?t.touches[0]:t,n=a&&vt(a),s=a&&n&&n.a,l=a&&n&&n.d,c=(i.clientX-g.clientX+o.x)/(s||1),u=(i.clientY-g.clientY+o.y)/(l||1),d=t.touches?"translate3d("+c+"px,"+u+"px,0)":"translate("+c+"px,"+u+"px)";if(!ct.active&&!w){if(r&&W(z(i.clientX-this._lastX),z(i.clientY-this._lastY))<r)return;this._onDragStart(t,!0)}this._handleAutoScroll(i,!0),_=!0,b=i,mt(a,"webkitTransform",d),mt(a,"mozTransform",d),mt(a,"msTransform",d),mt(a,"transform",d),t.cancelable&&t.preventDefault()}},_appendGhost:function(){if(!a){var e=Vt(t,this.options.fallbackOnBody?N.body:o,!0),r=(mt(t),this.options);ht(a=t.cloneNode(!0),r.ghostClass,!1),ht(a,r.fallbackClass,!0),ht(a,r.dragClass,!0),mt(a,"box-sizing","border-box"),mt(a,"margin",0),mt(a,"top",e.top),mt(a,"left",e.left),mt(a,"width",e.width),mt(a,"height",e.height),mt(a,"opacity","0.8"),mt(a,"position","fixed"),mt(a,"zIndex","100000"),mt(a,"pointerEvents","none"),r.fallbackOnBody&&N.body.appendChild(a)||o.appendChild(a)}},_onDragStart:function(e,a){var i=this,n=e.dataTransfer,s=i.options;(r=$t(t)).draggable=!1,r.style["will-change"]="",this._hideClone(),ht(r,i.options.chosenClass,!1),i._cloneId=Mt(function(){i.options.removeCloneOnHide||o.insertBefore(r,t),bt(i,o,"clone",t)}),!a&&ht(t,s.dragClass,!0),a?(T=!0,i._loopId=setInterval(i._emulateDragOver,50)):(ft(N,"mouseup",i._onDrop),ft(N,"touchend",i._onDrop),ft(N,"touchcancel",i._onDrop),ft(N,"pointercancel",i._onDrop),n&&(n.effectAllowed="move",s.setData&&s.setData.call(i,n,t)),pt(N,"drop",i),mt(t,"transform","translateZ(0)")),w=!0,i._dragStartId=Mt(i._dragStarted.bind(i,a)),pt(N,"selectstart",i)},_onDragOver:function(r){var n,s,l,c=this.el,d=r.target,h=this.options,m=h.group,v=ct.active,g=p===m,b=h.sort,D=this;if(!G&&(!X||r.rootEl||r.artificialBubble||rt(c,d))){if(void 0!==r.preventDefault&&r.cancelable&&r.preventDefault(),_=!0,d=ut(d,h.draggable,c,!0),ut(r.target,null,t,!0)||d.animated)return j();if(d!==t&&(T=!1),v&&!h.disabled&&(g?b||(l=!o.contains(t)):f===this||(this.lastPutMode=p.checkPull(this,v,t,r))&&m.checkPut(this,v,t,r))){var w=this._getDirection(r,d);if(n=Vt(t),l)return this._hideClone(),e=o,i?o.insertBefore(t,i):o.appendChild(t),j();if(0===c.children.length||c.children[0]===a||function(t,e,a){var r=Vt(kt(a)),o="vertical"===e?t.clientY:t.clientX,i="vertical"===e?t.clientX:t.clientY,n="vertical"===e?r.bottom:r.right,s="vertical"===e?r.left:r.top,l="vertical"===e?r.right:r.bottom;return i>s&&i<l&&o>n}(r,w,c)&&!t.animated){if(0!==c.children.length&&c.children[0]!==a&&c===r.target&&(d=kt(c)),d&&(s=Vt(d)),g?v._hideClone():v._showClone(this),!1!==_t(o,c,t,n,d,s,r,!!d))return c.appendChild(t),e=c,I=null,H(),this._animate(n,t),d&&this._animate(s,d),j()}else if(d&&d!==t&&void 0!==d.parentNode[E]&&d!==c){var $,V=0,A=d.sortableMouseAligned,L=t.parentNode!==c,F=function(t,e){var a=J(a,!0),r=Vt(t)[e];for(;a;){var o=Vt(a)[e];if(!("top"===e||"left"===e?r>=o:r<=o))return!0;if(a===R)break;a=J(a,!1)}return!1}(d,"vertical"===w?"top":"left");if(y!==d&&(x=null,$=Vt(d)["vertical"===w?"top":"left"],M=!1),function(e,a,r){var o=e===t&&I||Vt(e),i=a===t&&I||Vt(a),n="vertical"===r?o.left:o.top,s="vertical"===r?o.right:o.bottom,l="vertical"===r?o.width:o.height,c="vertical"===r?i.left:i.top,u="vertical"===r?i.right:i.bottom,d="vertical"===r?i.width:i.height;return n===c||s===u||n+l/2===c+d/2}(t,d,w)&&A||L||F||h.invertSwap||"insert"===x||"swap"===x?("swap"!==x&&(P=h.invertSwap||L||S||F),V=function(e,a,r,o,i,n,s){var l=Vt(a),c="vertical"===r?e.clientY:e.clientX,u="vertical"===r?l.height:l.width,d="vertical"===r?l.top:l.left,p="vertical"===r?l.bottom:l.right,f=Vt(t),h=!1;if(!n)if(s&&k<u*o)if(!M&&(1===C?c>d+u*i/2:c<p-u*i/2)&&(M=!0),M)h=!0;else{"vertical"===r?f.top:f.left,"vertical"===r?f.bottom:f.right;if(1===C?c<d+k:c>p-k)return-1*C}else if(c>d+u*(1-o)/2&&c<p-u*(1-o)/2)return c>d+u/2?-1:1;if((h=h||n)&&(c<d+u*i/2||c>p-u*i/2))return c>d+u/2?1:-1;return 0}(r,d,w,h.swapThreshold,null==h.invertedSwapThreshold?h.swapThreshold:h.invertedSwapThreshold,P,y===d),x="swap"):(V=function(e,a){var r=Dt(t,a.draggable),o=Dt(e,a.draggable);return r<o?1:-1}(d,h),x="insert"),0===V)return j();I=null,y=d,C=V,s=Vt(d);var q=d.nextElementSibling,Y=!1,U=_t(o,c,t,n,d,s,r,Y=1===V);if(!1!==U)return 1!==U&&-1!==U||(Y=1===U),G=!0,O(Ct,30),g?v._hideClone():v._showClone(this),Y&&!q?c.appendChild(t):d.parentNode.insertBefore(t,Y?q:d),e=t.parentNode,void 0===$||P||(k=z($-Vt(d)["vertical"===w?"top":"left"])),H(),!L&&this._animate(s,d),this._animate(n,t),j()}if(c.contains(t))return j()}return X&&!r.rootEl&&ot(c,r,"_onDragOver"),!1}function j(){return v&&(ht(t,f?f.options.ghostClass:v.options.ghostClass,!1),ht(t,h.ghostClass,!0)),f!==D&&D!==ct.active?f=D:D===ct.active&&(f=null),(d===t&&!t.animated||d===c&&!d.animated)&&(y=null),h.dragoverBubble||r.rootEl||d===N||(D._handleAutoScroll(r),t.parentNode[E]._computeIsAligned(r)),!h.dragoverBubble&&r.stopPropagation&&r.stopPropagation(),!0}function H(){bt(D,o,"change",d,c,o,u,Dt(t,h.draggable),r)}},_animate:function(e,a){var r=this.options.animation;if(r){var o=Vt(a);if(a===t&&(I=o),1===e.nodeType&&(e=Vt(e)),e.left+e.width/2!==o.left+o.width/2||e.top+e.height/2!==o.top+o.height/2){var i=vt(this.el),n=i&&i.a,s=i&&i.d;mt(a,"transition","none"),mt(a,"transform","translate3d("+(e.left-o.left)/(n||1)+"px,"+(e.top-o.top)/(s||1)+"px,0)"),a.offsetWidth,mt(a,"transition","transform "+r+"ms"+(this.options.easing?" "+this.options.easing:"")),mt(a,"transform","translate3d(0,0,0)")}"number"==typeof a.animated&&clearTimeout(a.animated),a.animated=O(function(){mt(a,"transition",""),mt(a,"transform",""),a.animated=!1},r)}},_offUpEvents:function(){var t=this.el.ownerDocument;ft(N,"touchmove",this._onTouchMove),ft(N,"pointermove",this._onTouchMove),ft(t,"mouseup",this._onDrop),ft(t,"touchend",this._onDrop),ft(t,"pointerup",this._onDrop),ft(t,"touchcancel",this._onDrop),ft(t,"pointercancel",this._onDrop),ft(N,"selectstart",this)},_onDrop:function(n){var s=this.el,l=this.options;w=!1,S=!1,P=!1,M=!1,clearInterval(this._loopId),clearInterval(h),tt(),clearTimeout(st),st=void 0,clearTimeout(this._dragStartTimer),Pt(this._cloneId),Pt(this._dragStartId),ft(N,"mousemove",this._onTouchMove),this.nativeDraggable&&(ft(N,"drop",this),ft(s,"dragstart",this._onDragStart),ft(N,"dragover",this._handleAutoScroll),ft(N,"dragover",at)),this._offUpEvents(),n&&(_&&(n.cancelable&&n.preventDefault(),!l.dropBubble&&n.stopPropagation()),a&&a.parentNode&&a.parentNode.removeChild(a),(o===e||f&&"clone"!==f.lastPutMode)&&r&&r.parentNode&&r.parentNode.removeChild(r),t&&(this.nativeDraggable&&ft(t,"dragend",this),yt(t),t.style["will-change"]="",ht(t,f?f.options.ghostClass:this.options.ghostClass,!1),ht(t,this.options.chosenClass,!1),bt(this,o,"unchoose",t,e,o,u,null,n),o!==e?((d=Dt(t,l.draggable))>=0&&(bt(null,e,"add",t,e,o,u,d,n),bt(this,o,"remove",t,e,o,u,d,n),bt(null,e,"sort",t,e,o,u,d,n),bt(this,o,"sort",t,e,o,u,d,n)),f&&f.save()):t.nextSibling!==i&&(d=Dt(t,l.draggable))>=0&&(bt(this,o,"update",t,e,o,u,d,n),bt(this,o,"sort",t,e,o,u,d,n)),ct.active&&(null!=d&&-1!==d||(d=u),bt(this,o,"end",t,e,o,u,d,n),this.save()))),this._nulling()},_nulling:function(){o=t=e=a=i=r=n=s=l=D.length=h=m=v=g=b=_=d=u=y=C=I=f=p=ct.active=null,K.forEach(function(t){t.checked=!0}),K.length=0},handleEvent:function(e){switch(e.type){case"drop":case"dragend":this._onDrop(e);break;case"dragenter":case"dragover":t&&(this._onDragOver(e),function(t){t.dataTransfer&&(t.dataTransfer.dropEffect="move");t.cancelable&&t.preventDefault()}(e));break;case"selectstart":e.preventDefault()}},toArray:function(){for(var t,e=[],a=this.el.children,r=0,o=a.length,i=this.options;r<o;r++)ut(t=a[r],i.draggable,this.el,!1)&&e.push(t.getAttribute(i.dataIdAttr)||It(t));return e},sort:function(t){var e={},a=this.el;this.toArray().forEach(function(t,r){var o=a.children[r];ut(o,this.options.draggable,a,!1)&&(e[t]=o)},this),t.forEach(function(t){e[t]&&(a.removeChild(e[t]),a.appendChild(e[t]))})},save:function(){var t=this.options.store;t&&t.set&&t.set(this)},closest:function(t,e){return ut(t,e||this.options.draggable,this.el,!1)},option:function(t,e){var a=this.options;if(void 0===e)return a[t];a[t]=e,"group"===t&&et(a)},destroy:function(){var t=this.el;t[E]=null,ft(t,"mousedown",this._onTapStart),ft(t,"touchstart",this._onTapStart),ft(t,"pointerdown",this._onTapStart),this.nativeDraggable&&(ft(t,"dragover",this),ft(t,"dragenter",this)),Array.prototype.forEach.call(t.querySelectorAll("[draggable]"),function(t){t.removeAttribute("draggable")}),this._onDrop(),$.splice($.indexOf(this.el),1),this.el=t=null},_hideClone:function(){r.cloneHidden||(mt(r,"display","none"),r.cloneHidden=!0,r.parentNode&&this.options.removeCloneOnHide&&r.parentNode.removeChild(r))},_showClone:function(e){"clone"===e.lastPutMode?r.cloneHidden&&(o.contains(t)&&!this.options.group.revertClone?o.insertBefore(r,t):i?o.insertBefore(r,i):o.appendChild(r),this.options.group.revertClone&&this._animate(t,r),mt(r,"display",""),r.cloneHidden=!1):this._hideClone()}},pt(N,"touchmove",function(t){(ct.active||w)&&t.cancelable&&t.preventDefault()}),ct.utils={on:pt,off:ft,css:mt,find:gt,is:function(t,e){return!!ut(t,e,t,!1)},extend:Tt,throttle:wt,closest:ut,toggleClass:ht,clone:$t,index:Dt,nextTick:Mt,cancelNextTick:Pt,detectDirection:Q,getChild:xt},ct.create=function(t,e){return new ct(t,e)},ct.version="1.8.1",ct})},sbI1:function(t,e){},wYqO:function(t,e){}});
//# sourceMappingURL=2.76108a63234f3bee706c.js.map
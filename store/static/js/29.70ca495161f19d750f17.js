webpackJsonp([29],{BTnz:function(e,t){},J4vt:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=s("aA9S"),a=s.n(r),i=s("5HJ5"),n=s("yyHI"),o=s("x1ym"),l={data:function(){return{visible:!1,loading:!1,orderInfo:[],deliveryForm:{orderId:"",deliveryCompanyId:"",expressNum:"",addressId:""},companyList:[],addressList:[],rules:{deliveryCompanyId:[o.a.required("此项必填","change")],expressNum:[o.a.required()],addressId:[o.a.required()]}}},methods:{setDelivery:function(e){this.orderInfo=e,this.deliveryForm.orderId=e.id,this.visible=!0},deliverySave:function(){var e=this;this.$refs.form.validate(function(t){t&&(e.loading=!0,Object(n.d)(e.deliveryForm).then(function(t){e.loading=!1,200===t.code?(e.$successMessage("操作成功"),e.visible=!1,e.handleClose(),e.$emit("change",!0)):(e.$errorMessage(t.message),e.handleClose(),e.$emit("change",!1))}))})},getLogisticscompanyList:function(){var e=this;Object(n.c)().then(function(t){200===t.code&&(e.companyList=t.data)})},getAddress:function(){var e=this;Object(n.p)({addressType:1}).then(function(t){200===t.code&&(e.addressList=t.data,t.data.forEach(function(t){t.isDefault&&(e.deliveryForm.addressId=t.id)}))})},showAttr:function(e){if(""===e)return"";var t="";return JSON.parse(e).forEach(function(e){var s=e.name+":"+e.value+"  ";t+=s}),t},handleClose:function(){this.visible=!1,this.deliveryForm.expressNum="",this.deliveryForm.deliveryCompanyId="",this.$refs.form.clearValidate(),this.$refs.form.resetFields()}},created:function(){this.getAddress(),this.getLogisticscompanyList()}},d={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("el-dialog",{attrs:{visible:e.visible,title:"订单发货","before-close":e.handleClose,width:"900px"}},[s("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{padding:"15px"}},[s("h2",{staticClass:"cms-segmentation",staticStyle:{"padding-left":"15px"}},[e._v("第一步:确认收货信息")]),e._v(" "),s("table",{staticClass:"order-table"},[s("tr",{staticClass:"order-header"},[s("td",{staticStyle:{border:"1px solid #e0e0e0"}},[s("span",{staticStyle:{"margin-left":"20px"}},[e._v("订单编号：")]),e._v(" "),s("span",{staticStyle:{"margin-right":"50px"}},[e._v(e._s(e.orderInfo.orderCode))]),e._v(" "),s("span",[e._v("下单时间:")]),e._v(" "),s("span",{staticStyle:{"margin-right":"60px"}},[e._v(e._s(e.$moment(e.orderInfo.orderTime)))])])]),e._v(" "),s("tbody",[e._l(e.orderInfo.items,function(t){return s("tr",{key:t.id},[s("td",{staticClass:"product-info",staticStyle:{"border-right":"1px solid #e0e0e0"}},[s("div",{staticClass:"product__inner"},[t.productInfo?s("img",{staticClass:"product-img",attrs:{src:e.$cms.filterUrl(t.productInfo.coverImageUrl)}}):e._e(),e._v(" "),s("div",{staticClass:"product-title"},[t.productInfo?s("h3",{staticClass:"title-h3"},[e._v(e._s(t.productInfo.productName))]):e._e(),e._v(" "),t.productInfo?s("p",{staticClass:"title-p",staticStyle:{"margin-top":"10px"}},[e._v(e._s(e.showAttr(t.productInfo.skuAttr)))]):e._e(),e._v(" "),s("div",{staticClass:"overflow"},[s("span",{staticClass:"de-price"},[e._v("￥"+e._s(e.$cms.float(t.payAmount)))]),e._v(" "),s("span",{staticClass:"de-count"},[e._v("x"+e._s(t.productCount))])])])])])])}),e._v(" "),e.orderInfo.orderExt?s("tr",[s("td",{staticClass:"product-info",staticStyle:{"border-right":"1px solid #e0e0e0"}},[s("div",{staticClass:"de-addr"},[s("label",{staticClass:"de-label",attrs:{for:""}},[e._v("买家收货地址：")]),e._v(" "),s("span",{staticClass:"de-info"},[e._v("\n                "+e._s(e.orderInfo.orderExt.customerAddress)+",\n                "+e._s(e.orderInfo.orderExt.customerName)+"("+e._s(e.orderInfo.orderExt.customerTel)+"),\n                "+e._s(e.orderInfo.orderExt.customerAreaCode)+"\n              ")])]),e._v(" "),s("div",{staticClass:"de-cust"},[s("label",{staticClass:"de-label",attrs:{for:""}},[e._v("买家备注：")]),e._v(" "),s("span",{staticClass:"de-info"},[e._v(e._s(e.orderInfo.orderExt.customerTxt))])])])]):e._e()],2)]),e._v(" "),s("h2",{staticClass:"cms-segmentation",staticStyle:{"padding-left":"15px"}},[e._v("第二步:选择物流信息")]),e._v(" "),s("el-form",{ref:"form",attrs:{model:e.deliveryForm,"label-width":"120px",rules:e.rules}},[s("el-form-item",{attrs:{label:"物流公司",prop:"deliveryCompanyId"}},[s("el-select",{model:{value:e.deliveryForm.deliveryCompanyId,callback:function(t){e.$set(e.deliveryForm,"deliveryCompanyId",t)},expression:"deliveryForm.deliveryCompanyId"}},e._l(e.companyList,function(e){return s("el-option",{key:e.id,attrs:{label:e.cnName,value:e.id}})}),1)],1),e._v(" "),s("el-form-item",{attrs:{label:"物流单号",prop:"expressNum"}},[s("el-input",{attrs:{maxlength:"14"},model:{value:e.deliveryForm.expressNum,callback:function(t){e.$set(e.deliveryForm,"expressNum",t)},expression:"deliveryForm.expressNum"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"选择发货地址",prop:"addressId"}},[s("el-select",{staticStyle:{width:"500px"},model:{value:e.deliveryForm.addressId,callback:function(t){e.$set(e.deliveryForm,"addressId",t)},expression:"deliveryForm.addressId"}},e._l(e.addressList,function(t){return s("el-option",{key:t.id,attrs:{label:t.customerName+"("+t.tel+")      "+t.provinceName+t.cityName+t.areaName+t.address,value:t.id}},[s("div",[s("span",{staticStyle:{float:"left","margin-right":"30px"}},[e._v(e._s(t.customerName)+" "+e._s(t.tel))]),e._v(" "),s("span",{staticStyle:{float:"right"}},[e._v(e._s(t.provinceName)+" "+e._s(t.cityName)+" "+e._s(t.areaName)+e._s(t.address))])])])}),1)],1)],1)],1),e._v(" "),s("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:e.handleClose}},[e._v("取 消")]),e._v(" "),s("el-button",{attrs:{type:"primary"},on:{click:e.deliverySave}},[e._v("确 定")])],1)])},staticRenderFns:[]};var c=s("C7Lr")(l,d,!1,function(e){s("BTnz")},null,null).exports,u=s("c/QX"),v={page:1,size:5,status:"2",payMode:"",orderNum:"",orderTimeBegin:"",orderTimeEnd:"",memberName:""},m={name:"orderList",mixins:[i.a],components:{delivery:c,printPage:u.default},data:function(){return{timer:[],activeStatus:"",queryParams:a()({},v)}},filters:{payMode:function(e){if(""===e)return"";return["","支付宝","微信","银联","余额"][e]},refund:function(e){return["待卖家确认","退款中","卖家拒绝","","待买家发货","待卖家收货","待买家收货","待卖家发货","已完成","买家已取消"][e]}},methods:{updateList:function(e){e&&this.query()},deliveryOrder:function(e){this.$refs.delivery.setDelivery(e)},cancelOrder:function(e){var t=this;this.$confirm("是否确认取消该订单","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(s){Object(n.a)({orderId:e}).then(function(e){200===e.code?(t.$successMessage("取消成功"),t.query()):t.$errorMessage(e.message)})}).catch(function(){})},printOrder:function(e){this.$refs.print.getOrderInfo(e).then(function(e){var t=e.innerHTML,s="";s=location.pathname.substring(0,location.pathname.lastIndexOf("/"))+"/static/print/print.html";var r=window.open(s,"");setTimeout(function(){return r.document.body.innerHTML=t,!1},50)})},changeOrderStatus:function(e){this.query()},setTimer:function(e){this.queryParams.orderTimeBegin=e[0],this.queryParams.orderTimeEnd=e[1],this.query()},showAttr:function(e){if(""===e)return"";var t="";return JSON.parse(e).forEach(function(e){var s=e.name+":"+e.value+"  ";t+=s}),t}},created:function(){this.getTableData(n.f,this.queryParams)}},p={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"cms-list-layout"},[s("cms-prompt",{attrs:{collapse:"true"}},[s("li",[e._v("显示店铺订单")]),e._v(" "),s("li",[e._v("点击订单号即可进入详情页面")])]),e._v(" "),s("section",{staticClass:"cms-list-query"},[s("div",{staticClass:"query-group"},[s("label",[e._v("订单号")]),e._v(" "),s("el-input",{nativeOn:{keyup:function(t){return"button"in t||!e._k(t.keyCode,"enter",13,t.key,"Enter")?e.query(t):null}},model:{value:e.queryParams.orderNum,callback:function(t){e.$set(e.queryParams,"orderNum",t)},expression:"queryParams.orderNum"}})],1),e._v(" "),s("div",{staticClass:"query-group"},[s("label",[e._v("买家名称")]),e._v(" "),s("el-input",{nativeOn:{keyup:function(t){return"button"in t||!e._k(t.keyCode,"enter",13,t.key,"Enter")?e.query(t):null}},model:{value:e.queryParams.memberName,callback:function(t){e.$set(e.queryParams,"memberName",t)},expression:"queryParams.memberName"}})],1),e._v(" "),s("div",{staticClass:"query-group"},[s("label",[e._v("下单时间")]),e._v(" "),s("cms-picker",{on:{change:e.setTimer},model:{value:e.timer,callback:function(t){e.timer=t},expression:"timer"}})],1),e._v(" "),s("div",{staticClass:"query-group"},[s("label",[e._v("支付方式")]),e._v(" "),s("el-select",{on:{change:e.query},model:{value:e.queryParams.payMode,callback:function(t){e.$set(e.queryParams,"payMode",t)},expression:"queryParams.payMode"}},[s("el-option",{attrs:{label:"全部",value:""}}),e._v(" "),s("el-option",{attrs:{label:"支付宝",value:1}}),e._v(" "),s("el-option",{attrs:{label:"微信",value:2}}),e._v(" "),s("el-option",{attrs:{label:"银联",value:3}}),e._v(" "),s("el-option",{attrs:{label:"余额",value:4}})],1)],1),e._v(" "),s("div",{staticClass:"query-group"},[s("cms-button",{attrs:{size:"small",colorPicker:!0},on:{click:e.query}},[e._v("查询")])],1)]),e._v(" "),s("table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"order-table"},[e._m(0),e._v(" "),e._l(e.tableData,function(t,r){return s("tbody",{key:r},[s("div",{staticStyle:{width:"100%",height:"25px",background:"#fff"}}),e._v(" "),s("tr",{staticClass:"order-header"},[s("td",{staticStyle:{border:"1px solid #e0e0e0"},attrs:{colspan:"11"}},[s("span",{staticStyle:{"margin-left":"20px"}},[e._v("订单编号：")]),e._v(" "),s("span",{staticStyle:{"margin-right":"50px"}},[e._v(e._s(t.orderCode))]),e._v(" "),s("span",[e._v("下单时间:")]),e._v(" "),s("span",{staticStyle:{"margin-right":"60px"}},[e._v(e._s(e.$moment(t.orderTime)))])])]),e._v(" "),e._l(t.items,function(r,a){return s("tr",{key:r.id},[s("td",{staticClass:"product-info",attrs:{colspan:"3"}},[t.items&&t.items.length>0?s("div",{staticClass:"product__inner"},[r.productInfo?s("img",{staticClass:"product-img",attrs:{src:e.$cms.filterUrl(r.productInfo.coverImageUrl)}}):e._e(),e._v(" "),s("div",{staticClass:"product-title"},[r.productInfo?s("h3",{staticClass:"title-h3"},[e._v(e._s(r.productInfo.productName))]):e._e(),e._v(" "),r.productInfo?s("p",{staticClass:"title-p",staticStyle:{"margin-top":"10px"}},[e._v(e._s(e.showAttr(r.productInfo.skuAttr)))]):e._e()])]):e._e()]),e._v(" "),s("td",{staticClass:"order-count"},[t.items&&t.items.length>0?s("span",[e._v("￥"+e._s(e.$cms.float(r.productPrice)))]):e._e()]),e._v(" "),s("td",{staticClass:"order-count"},[t.items&&t.items.length>0?s("span",[e._v("x "+e._s(r.productCount))]):e._e()]),e._v(" "),s("td",{staticClass:"order-count"},[t.newRefund?s("span",[e._v(e._s(e._f("refund")(t.newRefund.status)))]):e._e()]),e._v(" "),0==a?s("td",{staticClass:"order-user",attrs:{rowspan:t.items.length}},[t.member?s("span",[s("i",{staticClass:"iconfont icon-yonghu",staticStyle:{position:"relative",top:"2px"}}),e._v("\n            "+e._s(t.member.nickname||t.member.username)+"\n          ")]):e._e()]):e._e(),e._v(" "),0==a?s("td",{staticClass:"tr-price",attrs:{rowspan:t.items.length}},[s("p",{staticClass:"await"},[e._v("￥"+e._s(e.$cms.float(t.orderPayAmount)))]),e._v(" "),s("p",{staticStyle:{color:"#999999",margin:"10px 0 0 0"}},[e._v("(含运费：￥"+e._s(e.$cms.float(t.orderFreight))+")")]),e._v(" "),s("p",[s("i",{staticClass:"iconfont",staticStyle:{color:"#00C700","margin-right":"5px"}}),e._v("\n            "+e._s(e._f("payMode")(t.payMode))+"\n          ")])]):e._e(),e._v(" "),0==a?s("td",{staticClass:"order-status",attrs:{rowspan:t.items.length}},[t.status?s("div",{staticClass:"await cell"},[1==t.status?s("span",{staticClass:"info"},[e._v("待付款")]):e._e(),e._v(" "),2==t.status?s("span",{staticClass:"info"},[e._v("待发货")]):e._e(),e._v(" "),3==t.status?s("span",{staticClass:"info"},[e._v("待收货")]):e._e(),e._v(" "),4==t.status?s("span",{staticClass:"success"},[e._v("已完成")]):e._e(),e._v(" "),5==t.status?s("span",{staticClass:"error"},[e._v("已取消")]):e._e(),e._v(" "),6==t.status?s("span",{staticClass:"error"},[e._v("超时交易关闭")]):e._e()]):e._e(),e._v(" "),s("p",{staticClass:"link",staticStyle:{color:"#4196E4",margin:"10px 0 10px 0",cursor:"pointer"},on:{click:function(s){e.$routerLink("/orderManger/view","view",{id:t.id})}}},[e._v("订单详情")])]):e._e(),e._v(" "),0==a?s("td",{staticClass:"order-operation",attrs:{rowspan:t.items.length}},[s("div",{staticClass:"mb-10"},[s("cms-button",{staticStyle:{width:"110px"},attrs:{slot:"reference",size:"small",type:"info"},on:{click:function(s){e.printOrder(t.id)}},slot:"reference"},[e._v("打印运单")])],1),e._v(" "),s("div",{staticClass:"mb-10"},[!t.newRefund||t.newRefund&&(8==t.newRefund.status||9==t.newRefund.status||2==t.newRefund.status&&t.newRefund.lastIntervent&&2===t.newRefund.lastIntervent.platformStatus)?s("cms-button",{staticStyle:{width:"110px"},attrs:{slot:"reference",size:"small",type:"info"},on:{click:function(s){e.deliveryOrder(t)}},slot:"reference"},[e._v("发  货")]):e._e()],1)]):e._e()])})],2)})],2),e._v(" "),s("cms-pagination",{attrs:{total:e.total,size:5},on:{change:e.getPage}}),e._v(" "),s("delivery",{ref:"delivery",on:{change:e.updateList}}),e._v(" "),s("print-page",{ref:"print",staticStyle:{display:"none"}})],1)},staticRenderFns:[function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("tr",[s("th",{attrs:{colspan:"6"}},[e._v("订单详情")]),e._v(" "),s("th",[e._v("收货人")]),e._v(" "),s("th",[e._v("实收款")]),e._v(" "),s("th",[e._v("订单状态")]),e._v(" "),s("th",[e._v("操作选项")])])}]};var _=s("C7Lr")(m,p,!1,function(e){s("N4gh")},"data-v-562d3f84",null);t.default=_.exports},N4gh:function(e,t){}});
//# sourceMappingURL=29.70ca495161f19d750f17.js.map
webpackJsonp([17],{"6njJ":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r("aA9S"),o=r.n(a),n=r("m2ya"),s=r("x1ym"),i=r("lcoF"),l=r("zzd2"),c={roleName:"",remark:"",menuid:[]},u={name:"roleSave",components:{roleTree:n.a},mixins:[i.a],data:function(){return{roleStatus:!1,formData:o()({},c),rules:{roleName:[s.a.required("请填写角色名"),s.a.len(1,10)],remark:[s.a.max(140,"描述最大长度为140个字符")]}}},methods:{save:function(e){var t=this;this.formData.menuid=this.$refs.role.getPermsInfo().map(function(e){return e.id}),this.saveForm(l.d,this.formData,e,"/role","list").then(function(e){t.formData.menuid=[],t.roleStatus=!1,setTimeout(function(){t.roleStatus=!0},1)})},restData:function(){var e=this;this.loading=!0,this.roleStatus=!1,setTimeout(function(){e.roleStatus=!0,e.formData=o()({},c),e.loading=!1},1)}},created:function(){this.restData()}},m={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("cms-breadcrumb",{attrs:{to:"/role",type:"list"},on:{click:e.rest}},[r("li",[e._v(e._s(e.$route.name))])]),e._v(" "),r("div",{staticClass:"cms-form-layout"},[r("cms-prompt",{attrs:{collapse:!1}},[r("li",[e._v("可进行添加修改角色管理员，维护管理员权限")])]),e._v(" "),r("el-form",{ref:"form",attrs:{rules:e.rules,model:e.formData,"label-width":"210px"}},[r("el-form-item",{attrs:{label:"角色名",prop:"roleName",error:e.errorMessage.roleName}},[r("el-input",{ref:"first",attrs:{autofocus:!0},model:{value:e.formData.roleName,callback:function(t){e.$set(e.formData,"roleName",t)},expression:"formData.roleName"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"描述"}},[r("el-input",{attrs:{maxlength:"500",type:"textarea",autosize:{minRows:3}},model:{value:e.formData.remark,callback:function(t){e.$set(e.formData,"remark",t)},expression:"formData.remark"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"权限设置"}},[e.roleStatus?r("role-tree",{ref:"role",attrs:{menuIds:e.formData.menuid}}):e._e()],1)],1),e._v(" "),r("div",{staticClass:"cms-form-footer"},[r("cms-button",{directives:[{name:"color",rawName:"v-color"}],on:{click:function(t){e.save(!1)}}},[e._v("保存并新增")]),e._v(" "),r("cms-button",{directives:[{name:"color",rawName:"v-color"}],on:{click:function(t){e.save(!0)}}},[e._v("保存")]),e._v(" "),r("cms-button",{attrs:{type:"rest"},on:{click:e.restData}},[e._v("重置")])],1)],1)],1)},staticRenderFns:[]};var d=r("C7Lr")(u,m,!1,function(e){r("9n9J")},null,null);t.default=d.exports},"9n9J":function(e,t){},Gezs:function(e,t){},m2ya:function(e,t,r){"use strict";var a=r("HNM5"),o={name:"roleTree",props:{menuIds:{type:Array,default:function(){return[]}}},data:function(){return{treeObj:null,zNodes:[],clickFlag:null,setting:{callback:{onClick:this.setPermsInfo,onDblClick:this.setExpand},check:{enable:!0},data:{key:{children:"childs"}},view:{dblClickExpand:!1,expandSpeed:""}}}},methods:{getRoleTree:function(){var e,t=this;a.a.get("/admin/store/storeUserrole/tree",{params:e}).then(function(e){t.zNodes=e.data,t.$nextTick(function(){this.treeObj=$.fn.zTree.init($("#treeDemo"),this.setting,this.zNodes),this.defaultCheckNode(this.menuIds)})})},defaultCheckNode:function(e){if(0===e.length)return this.treeObj.checkAllNodes(!1),this.treeObj.expandAll(!1),!1;if(this.treeObj){this.treeObj.checkAllNodes(!1),this.treeObj.expandAll(!1);for(var t=0;t<e.length;t++){var r=this.treeObj.getNodeByParam("id",e[t]);this.treeObj.checkNode(r,!0,!1)}}},setPermsInfo:function(e,t,r,a){var o=this;this.clickFlag&&(this.clickFlag=clearTimeout(this.clickFlag)),this.clickFlag=setTimeout(function(){o.treeObj.checkNode(r,!r.checked,!0)},200)},getPermsInfo:function(){return this.treeObj.getCheckedNodes()},setExpand:function(e,t,r){this.clickFlag&&(this.clickFlag=clearTimeout(this.clickFlag)),this.treeObj.expandNode(r)}},created:function(){this.getRoleTree()},watch:{menuIds:{handler:function(){this.defaultCheckNode(this.menuIds)},deep:!0}},mounted:function(){}},n={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",[t("ul",{ref:"treeDemo",staticClass:"ztree",attrs:{id:"treeDemo"}})])},staticRenderFns:[]};var s=r("C7Lr")(o,n,!1,function(e){r("Gezs")},null,null);t.a=s.exports}});
//# sourceMappingURL=17.755357dc645f39b5f9ca.js.map
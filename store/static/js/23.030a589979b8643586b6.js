webpackJsonp([23],{V304:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=a("3cXf"),s=a.n(r),i=a("aA9S"),n=a.n(i),l=a("5HJ5"),o=a("yyHI"),c=a("tI4J"),u=a("hGXi"),d=a("c/QX"),v={page:1,size:10,source:"",orderType:"",status:"",payMode:"",orderNum:"",orderTimeBegin:"",orderTimeEnd:"",memberName:""},p={name:"orderList",mixins:[l.a],components:{changePrice:u.a,printPage:d.default},data:function(){return{timer:[],activeStatus:"",orderStatus:[{label:"全部",value:"0"},{label:"待付款",value:"1"},{label:"待发货",value:"2"},{label:"待收货",value:"3"},{label:"已完成",value:"4"},{label:"已取消 ",value:"5"}],queryParams:n()({},v)}},filters:{payMode:function(t){if(""===t)return"";return["","支付宝","微信","银联","余额"][t]},refund:function(t){return["待卖家确认","退款中","退款成功","退款失败","待买家发货","待卖家收货","待买家收货","待卖家发货","已完成","买家已取消","平台介入处理中"][t]}},methods:{updateList:function(t){t&&this.query()},setChangPrice:function(t){this.$refs.changePrice.setChangPrice(t)},cancelOrder:function(t){var e=this;this.$confirm("是否确认取消该订单","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(a){Object(o.a)({orderId:t}).then(function(t){200===t.code?(e.$successMessage("取消成功"),e.query()):e.$errorMessage(t.message)})}).catch(function(){})},printwayBillOrder:function(t){var e="",a=t.orderExt,r={orederId:a.expressNum,senderName:a.sellerName,senderTel:a.sellerTel,senderCompany:"",senderAddress:a.sellerAddress,senderCode:a.postalCode,desc:"",receiverName:a.customerName,receiverTel:a.customerTel,receiverAddress:a.customerAddress,receiverCode:a.customerAreaCode};Object(c.e)({waybillType:2}).then(function(t){if(200===t.code){localStorage.setItem("wayBillList",s()(t.data)),localStorage.setItem("wayBillInfo",s()(r));var a=location.pathname.substring(0,location.pathname.lastIndexOf("/"));e=a+"/static/print/wayBillPrint.html",window.open(e)}})},printOrder:function(t){this.$refs.print.getOrderInfo(t).then(function(t){var e=t.innerHTML,a="";a=location.pathname.substring(0,location.pathname.lastIndexOf("/"))+"/static/print/print.html";var r=window.open(a,"");setTimeout(function(){return r.document.body.innerHTML=e,!1},50)})},changeOrderStatus:function(){this.query()},setTimer:function(t){this.queryParams.orderTimeBegin=t[0],this.queryParams.orderTimeEnd=t[1],this.query()},showAttr:function(t){if(""===t)return"";var e="";return JSON.parse(t).forEach(function(t){var a=t.name+":"+t.value+"  ";e+=a}),e}},created:function(){this.getTableData(o.f,this.queryParams)}},m={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"cms-list-layout"},[a("cms-prompt",{attrs:{collapse:"true"}},[a("li",[t._v("显示店铺订单")]),t._v(" "),a("li",[t._v("点击订单号即可进入详情页面")])]),t._v(" "),a("section",{staticClass:"cms-list-query"},[a("div",{staticClass:"query-group"},[a("label",[t._v("订单号")]),t._v(" "),a("el-input",{nativeOn:{keyup:function(e){return"button"in e||!t._k(e.keyCode,"enter",13,e.key,"Enter")?t.query(e):null}},model:{value:t.queryParams.orderNum,callback:function(e){t.$set(t.queryParams,"orderNum",e)},expression:"queryParams.orderNum"}})],1),t._v(" "),a("div",{staticClass:"query-group"},[a("label",[t._v("买家账号")]),t._v(" "),a("el-input",{nativeOn:{keyup:function(e){return"button"in e||!t._k(e.keyCode,"enter",13,e.key,"Enter")?t.query(e):null}},model:{value:t.queryParams.memberName,callback:function(e){t.$set(t.queryParams,"memberName",e)},expression:"queryParams.memberName"}})],1),t._v(" "),a("div",{staticClass:"query-group"},[a("label",[t._v("订单状态")]),t._v(" "),a("el-select",{on:{change:t.query},model:{value:t.queryParams.status,callback:function(e){t.$set(t.queryParams,"status",e)},expression:"queryParams.status"}},t._l(t.orderStatus,function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}),1)],1),t._v(" "),a("div",{staticClass:"query-group"},[a("label",[t._v("订单来源")]),t._v(" "),a("el-select",{on:{change:t.query},model:{value:t.queryParams.source,callback:function(e){t.$set(t.queryParams,"source",e)},expression:"queryParams.source"}},[a("el-option",{attrs:{label:"全部",value:""}}),t._v(" "),a("el-option",{attrs:{label:"pc端",value:"1"}}),t._v(" "),a("el-option",{attrs:{label:"手机端",value:"2"}}),t._v(" "),a("el-option",{attrs:{label:"APP",value:"3"}}),t._v(" "),a("el-option",{attrs:{label:"公众号 ",value:"4"}}),t._v(" "),a("el-option",{attrs:{label:"小程序",value:"5"}}),t._v(" "),a("el-option",{attrs:{label:"平板",value:"6"}})],1)],1),t._v(" "),a("br"),t._v(" "),a("div",{staticClass:"query-group"},[a("label",[t._v("订单类型")]),t._v(" "),a("el-select",{on:{change:t.query},model:{value:t.queryParams.orderType,callback:function(e){t.$set(t.queryParams,"orderType",e)},expression:"queryParams.orderType"}},[a("el-option",{attrs:{label:"全部",value:""}}),t._v(" "),a("el-option",{attrs:{label:"实物订单",value:"1"}}),t._v(" "),a("el-option",{attrs:{label:"虚拟订单",value:"2"}})],1)],1),t._v(" "),a("div",{staticClass:"query-group"},[a("label",[t._v("支付方式")]),t._v(" "),a("el-select",{on:{change:t.query},model:{value:t.queryParams.payMode,callback:function(e){t.$set(t.queryParams,"payMode",e)},expression:"queryParams.payMode"}},[a("el-option",{attrs:{label:"全部",value:""}}),t._v(" "),a("el-option",{attrs:{label:"支付宝",value:1}}),t._v(" "),a("el-option",{attrs:{label:"微信",value:2}}),t._v(" "),a("el-option",{attrs:{label:"银联",value:3}}),t._v(" "),a("el-option",{attrs:{label:"余额",value:4}})],1)],1),t._v(" "),a("div",{staticClass:"query-group"},[a("label",[t._v("下单时间")]),t._v(" "),a("cms-picker",{on:{change:t.setTimer},model:{value:t.timer,callback:function(e){t.timer=e},expression:"timer"}})],1),t._v(" "),a("div",{staticClass:"query-group"},[a("cms-button",{attrs:{size:"small",colorPicker:!0},on:{click:t.query}},[t._v("查询")])],1)]),t._v(" "),a("el-tabs",{on:{"tab-click":t.changeOrderStatus},model:{value:t.queryParams.status,callback:function(e){t.$set(t.queryParams,"status",e)},expression:"queryParams.status"}},t._l(t.orderStatus,function(t){return a("el-tab-pane",{key:t.value,attrs:{label:t.label,name:t.value}})}),1),t._v(" "),a("table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"order-table"},[t._m(0),t._v(" "),t._l(t.tableData,function(e,r){return a("tbody",{key:r},[a("div",{staticStyle:{width:"100%",height:"25px",background:"#fff"}}),t._v(" "),a("tr",{staticClass:"order-header"},[a("td",{staticStyle:{border:"1px solid #e0e0e0"},attrs:{colspan:"11"}},[a("span",{staticStyle:{"margin-left":"20px"}},[t._v("订单编号：")]),t._v(" "),a("span",{staticStyle:{"margin-right":"50px"}},[t._v(t._s(e.orderCode))]),t._v(" "),a("span",[t._v("下单时间:")]),t._v(" "),a("span",{staticStyle:{"margin-right":"60px"}},[t._v(t._s(t.$moment(e.orderTime)))])])]),t._v(" "),t._l(e.items,function(r,s){return a("tr",{key:r.id},[a("td",{staticClass:"product-info",attrs:{colspan:"3"}},[e.items&&e.items.length>0?a("div",{staticClass:"product__inner"},[r.productInfo?a("img",{staticClass:"product-img",attrs:{src:t.$cms.filterUrl(r.productInfo.coverImageUrl)}}):t._e(),t._v(" "),a("div",{staticClass:"product-title"},[r.productInfo?a("h3",{staticClass:"title-h3"},[t._v(t._s(r.productInfo.productName))]):t._e(),t._v(" "),r.productInfo?a("p",{staticClass:"title-p",staticStyle:{"margin-top":"10px"}},[t._v(t._s(t.showAttr(r.productInfo.skuAttr)))]):t._e()])]):t._e()]),t._v(" "),a("td",{staticClass:"order-count"},[e.items&&e.items.length>0?a("span",[t._v("￥"+t._s(t.$cms.float(r.productPrice)))]):t._e()]),t._v(" "),a("td",{staticClass:"order-count"},[e.items&&e.items.length>0?a("span",[t._v("x "+t._s(r.productCount))]):t._e()]),t._v(" "),a("td",{staticClass:"order-count"},[e.newRefund?a("div",[e.newRefund.lastIntervent?a("span",[t._v("卖家拒绝"),a("br"),t._v("\n            "+t._s(2===e.newRefund.lastIntervent.platformStatus?"（平台已拒绝）":""))]):a("span",[t._v(t._s(t._f("refund")(e.newRefund.status)))])]):t._e()]),t._v(" "),0==s?a("td",{staticClass:"order-user",attrs:{rowspan:e.items.length}},[e.member?a("span",[a("i",{staticClass:"iconfont icon-yonghu",staticStyle:{position:"relative",top:"2px"}}),t._v("\n            "+t._s(e.member.username)+"\n          ")]):t._e()]):t._e(),t._v(" "),0==s?a("td",{staticClass:"tr-price",attrs:{rowspan:e.items.length}},[a("p",{staticClass:"await"},[t._v("￥"+t._s(t.$cms.float(e.orderPayAmount)))]),t._v(" "),a("p",{staticStyle:{color:"#999999",margin:"10px 0 0 0"}},[t._v("(含运费：￥"+t._s(t.$cms.float(e.orderFreight))+")")]),t._v(" "),a("p",[a("i",{staticClass:"iconfont",staticStyle:{color:"#00C700","margin-right":"5px"}}),t._v("\n            "+t._s(t._f("payMode")(e.payMode))+"\n          ")])]):t._e(),t._v(" "),0==s?a("td",{staticClass:"order-status",attrs:{rowspan:e.items.length}},[a("div",{staticClass:"await cell"},[1==e.status?a("span",{staticClass:"info"},[t._v("待付款")]):t._e(),t._v(" "),2==e.status?a("span",{staticClass:"info"},[t._v("待发货")]):t._e(),t._v(" "),3==e.status?a("span",{staticClass:"info"},[t._v("待收货")]):t._e(),t._v(" "),4==e.status?a("span",{staticClass:"success"},[t._v("已完成")]):t._e(),t._v(" "),5==e.status?a("span",{staticClass:"error"},[t._v("已取消")]):t._e(),t._v(" "),6==e.status?a("span",{staticClass:"error"},[t._v("超时交易关闭")]):t._e()]),t._v(" "),a("p",{staticClass:"link",staticStyle:{color:"#4196E4",margin:"10px 0 10px 0",cursor:"pointer"},on:{click:function(a){t.$routerLink("/orderManger/view","view",{id:e.id})}}},[t._v("订单详情")])]):t._e(),t._v(" "),0==s?a("td",{staticClass:"order-operation",attrs:{rowspan:e.items.length}},[1==e.status?a("div",{staticClass:"mb-10"},[a("cms-button",{staticStyle:{width:"94px"},attrs:{slot:"reference",size:"small",type:"info"},on:{click:function(a){t.setChangPrice(e)}},slot:"reference"},[t._v("修改价格")])],1):t._e(),t._v(" "),e.status<3?a("div",{staticClass:"mb-10"},[a("cms-button",{staticStyle:{width:"94px"},attrs:{slot:"reference",size:"small",type:"info"},on:{click:function(a){t.printOrder(e.id)}},slot:"reference"},[t._v("打印订单")])],1):t._e(),t._v(" "),3===e.status?a("div",{staticClass:"mb-10"},[a("cms-button",{staticStyle:{width:"94px"},attrs:{slot:"reference",size:"small",type:"info"},on:{click:function(a){t.printwayBillOrder(e)}},slot:"reference"},[t._v("打印运单")])],1):t._e(),t._v(" "),1==e.status?a("div",{staticClass:"mb-10"},[a("cms-button",{staticStyle:{width:"94px"},attrs:{slot:"reference",size:"small",type:"info"},on:{click:function(a){t.cancelOrder(e.id)}},slot:"reference"},[t._v("取  消")])],1):t._e()]):t._e()])})],2)})],2),t._v(" "),a("cms-pagination",{attrs:{total:t.total,size:5},on:{change:t.getPage}}),t._v(" "),a("change-price",{ref:"changePrice",on:{change:t.updateList}}),t._v(" "),a("print-page",{ref:"print",staticStyle:{display:"none"}})],1)},staticRenderFns:[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("tr",[a("th",{attrs:{colspan:"6"}},[t._v("订单详情")]),t._v(" "),a("th",[t._v("收货人")]),t._v(" "),a("th",[t._v("实收款")]),t._v(" "),a("th",[t._v("订单状态")]),t._v(" "),a("th",[t._v("操作选项")])])}]};var _=a("C7Lr")(p,m,!1,function(t){a("l46x")},"data-v-6c3e9b34",null);e.default=_.exports},hGXi:function(t,e,a){"use strict";var r=a("aA9S"),s=a.n(r),i=a("yyHI"),n={data:function(){return{priceVisible:!1,changeProductItems:[],updatePriceForm:{}}},methods:{setChangPrice:function(t){this.changeProductItems=t.items;var e={orderId:t.id,orderFreight:t.orderFreight,items:[]};t.items.forEach(function(t){e.items.push({oderItemId:t.id,discountAmount:0})}),this.updatePriceForm=s()({},e),this.priceVisible=!0},updateOrderInfo:function(){var t=this;this.$refs.form.validate(function(e){e&&Object(i.s)(t.updatePriceForm).then(function(e){200===e.code?(t.$successMessage("修改成功"),t.priceVisible=!1,t.$emit("change",!0)):(t.$errorMessage(e.message),t.$emit("change",!1))})})},showAttr:function(t){if(""===t)return"";var e="";return JSON.parse(t).forEach(function(t){var a=t.name+":"+t.value+"  ";e+=a}),e},validateNumber:function(t,e,a){e>=0?a():a(new Error("运费不能为负数"))},validatePrice:function(t,e,a,r){parseInt(e)+r>0?a():a(new Error("订单总额不能小于0"))},handleClose:function(){this.priceVisible=!1}}},l={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-dialog",{staticClass:"t-dialog",attrs:{visible:t.priceVisible,title:"价格修改","before-close":t.handleClose}},[a("el-form",{ref:"form",attrs:{model:t.updatePriceForm}},[a("table",{staticClass:"order-table"},[a("tr",[a("th",[t._v("商品")]),t._v(" "),a("th",{staticStyle:{"text-align":"left"}},[t._v("单价")]),t._v(" "),a("th",{staticStyle:{"text-align":"left"}},[t._v("数量")]),t._v(" "),a("th",{staticStyle:{"text-align":"left"}},[t._v("小计")]),t._v(" "),a("th",[t._v("优惠信息")])]),t._v(" "),a("tbody",t._l(t.changeProductItems,function(e,r){return a("tr",{key:e.id},[a("td",{staticClass:"product-info"},[a("div",{staticClass:"product__inner"},[e.productInfo?a("img",{staticClass:"product-img",attrs:{src:t.$cms.filterUrl(e.productInfo.coverImageUrl)}}):t._e(),t._v(" "),a("div",{staticClass:"product-title"},[e.productInfo?a("h3",{staticClass:"title-h3"},[t._v(t._s(e.productInfo.productName))]):t._e(),t._v(" "),e.productInfo?a("p",{staticClass:"title-p",staticStyle:{"margin-top":"10px"}},[t._v(t._s(t.showAttr(e.productInfo.skuAttr)))]):t._e()])])]),t._v(" "),a("td",{staticClass:"order-count"},[a("span",[t._v("￥"+t._s(t.$cms.float(e.productPrice)))])]),t._v(" "),a("td",{staticClass:"order-count"},[a("span",[t._v("x "+t._s(e.productCount))])]),t._v(" "),a("td",{staticClass:"order-count"},[a("span",[t._v(t._s(t.$cms.float(e.payAmount)))])]),t._v(" "),a("td",{staticClass:"order-count order-input"},[a("el-form-item",{attrs:{"label-width":"60px",label:"",prop:"items."+r+".discountAmount",rules:[{required:!0,message:"此项必填",trigger:"blur"},{validator:function(a,r,s){t.validatePrice(a,r,s,e.payAmount)},trigger:"blur"},{type:"number",message:"输入合法的数字"}]}},[a("el-input",{staticStyle:{width:"100px"},attrs:{maxlength:"7"},model:{value:t.updatePriceForm.items[r].discountAmount,callback:function(e){t.$set(t.updatePriceForm.items[r],"discountAmount",t._n(e))},expression:"updatePriceForm.items[index].discountAmount"}})],1),t._v(" "),a("span",{staticClass:"gray"},[t._v("优惠填入负数，增加填入正数")])],1)])}),0)]),t._v(" "),a("div",{staticClass:"clearfix",staticStyle:{padding:"6px 60px 9px 60px"}},[a("el-form-item",{staticClass:"fr",attrs:{"label-width":"80px",label:"运费",prop:"orderFreight",rules:[{required:!0,message:"此项必填",trigger:"blur"},{validator:function(e,a,r){t.validateNumber(e,a,r)},trigger:"blur"},{type:"number",message:"输入合法的数字"}]}},[a("el-input",{staticStyle:{width:"100px"},attrs:{maxlength:"7"},model:{value:t.updatePriceForm.orderFreight,callback:function(e){t.$set(t.updatePriceForm,"orderFreight",t._n(e))},expression:"updatePriceForm.orderFreight"}})],1)],1)]),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:t.handleClose}},[t._v("取 消")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:t.updateOrderInfo}},[t._v("确 定")])],1)],1)},staticRenderFns:[]};var o=a("C7Lr")(n,l,!1,function(t){a("thQH")},null,null);e.a=o.exports},l46x:function(t,e){},thQH:function(t,e){}});
//# sourceMappingURL=23.030a589979b8643586b6.js.map
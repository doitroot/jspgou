{"version":3,"sources":["webpack:///src/views/marketing/activityMange/edit.vue","webpack:///./src/views/marketing/activityMange/edit.vue?3932","webpack:///./src/views/marketing/activityMange/edit.vue"],"names":["defaultData","promote","name","promoteBeginTime","promoteEndTime","remark","enable","promoteType","product_flag_icon","rule","signBeginTime","signEndTime","signScope","oneFeeThird","oneFeeSelf","maxRefundRate","minPrice","minSale","minScore","minStock","discounts","conOrderAmount","discountAmount","signLimitCtgIds","couponIds","edit","components","categoryCascader","cmsCoupon","cmsProduct","mixins","mixins_form","data","coupons","productLimt","activeTimer","signTimer","formData","assign_default","signData","id","this","$route","query","productIds","checkedProductData","rules","required","methods","getSignData","_this","Object","marketing","promoteId","then","res","code","products","getFormData","_this2","status","loading","copyData","catch","res2","$moment","push","parseInt","ctgs","length","map","v","signPromote","_this3","$refs","form","validate","valid","item","$successMessage","setTimeout","$routerLink","$errorMessage","message","created","activityMange_edit","render","_vm","_h","$createElement","_c","_self","attrs","to","type","on","click","rest","_v","_s","staticClass","directives","rawName","value","expression","ref","model","label-width","nativeOn","submit","$event","preventDefault","label","error","errorMessage","_e","staticStyle","width","callback","$$v","$set","disEdit","_l","index","key","margin-bottom","$cms","float","indexOf","prop","staticRenderFns","Component","__webpack_require__","normalizeComponent","ssrContext","__webpack_exports__"],"mappings":"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","file":"static/js/71.e93bcf78a095d968df73.js","sourcesContent":["<template>\r\n  <div>\r\n    <cms-breadcrumb to=\"/platformActivity/list\" type='list' @click=\"rest\">\r\n      <li>{{$route.name}}</li>\r\n    </cms-breadcrumb>\r\n    <div class=\"cms-form-layout\" >\r\n      <el-form ref=\"form\" :rules=\"rules\" :model=\"signData\" label-width=\"210px\" @submit.native.prevent v-loading='loading'>\r\n        <el-form-item label=\"活动名称\" ref=\"promote_name\">\r\n          {{formData.promote.name}}\r\n        </el-form-item>\r\n        <el-form-item label=\"活动时间\"  ref=\"promote.promoteBeginTime\" :error=\"errorMessage['promote.promoteBeginTime']\">\r\n          {{activeTimer[0]}} 至 {{activeTimer[1]}}\r\n        </el-form-item>\r\n        <el-form-item label=\"报名时间\" ref=\"rule.signBeginTime\" :error=\"errorMessage['rule.signBeginTime']\">\r\n          {{signTimer[0]}} 至 {{signTimer[1]}}\r\n        </el-form-item>\r\n        <el-form-item label=\"活动说明\" ref=\"promote.remark\">\r\n          {{formData.promote.remark}}\r\n        </el-form-item>\r\n        <el-form-item label=\"活动报名限制\" ref=\"rule_signScope\">\r\n          <span v-if=\"formData.rule.signScope==1\">全部商品</span>\r\n          <span v-if=\"formData.rule.signScope==2\">自营商品</span>\r\n          <span v-if=\"formData.rule.signScope==3\">部分类目</span>\r\n        </el-form-item>\r\n        <el-form-item label=\"选择类目\" v-show=\"formData.rule.signScope===3\">\r\n          <category-cascader style=\"width:380px;\" v-model=\"formData.signLimitCtgIds\"></category-cascader>\r\n        </el-form-item>\r\n        <el-form-item label=\"活动支持优惠形式\"   ref=\"promote.promoteType\">\r\n          <span v-if=\"formData.promote.promoteType==4\">优惠券</span>\r\n          <span v-if=\"formData.promote.promoteType==3\">满减</span>\r\n        </el-form-item>\r\n        <el-form-item label=\"选择优惠券\" v-show=\"formData.promote.promoteType==4\">\r\n          <cms-coupon :disEdit=\"true\" v-model=\"formData.couponIds\" :data=\"coupons\"></cms-coupon>\r\n        </el-form-item>\r\n        <el-form-item label='满减信息' v-show=\"formData.promote.promoteType==3\">\r\n          <ul>\r\n            <li v-for=\"(item,index) in formData.discounts\" :key=\"index\" style=\"margin-bottom:10px;\">\r\n              满 {{item.conOrderAmount}}\r\n              减 {{item.discountAmount}}\r\n            </li>\r\n          </ul>\r\n        </el-form-item>\r\n        <el-form-item label=\"自营店铺单品收费\"  ref=\"rule.oneFeeThird\">\r\n          {{$cms.float(formData.rule.oneFeeThird)}}元\r\n        </el-form-item>\r\n        <el-form-item label=\"非自营店铺单品收费\" ref=\"rule.oneFeeSelf\">\r\n          {{$cms.float(formData.rule.oneFeeSelf)}}元\r\n        </el-form-item>\r\n        <el-form-item label=\"最新30天成交价>=\" ref=\"rule.minPrice\" v-if=\"productLimt.indexOf(1)>-1\">\r\n          {{$cms.float(formData.rule.minPrice)}}元\r\n        </el-form-item>\r\n        <el-form-item label=\"库存>=\"  ref=\"rule.minStock\" v-if=\"productLimt.indexOf(2)>-1\">\r\n          {{$cms.float(formData.rule.minStock)}}元\r\n        </el-form-item>\r\n        <el-form-item label=\"商品评分>=\"  ref=\"rule.minScore\" v-if=\"productLimt.indexOf(3)>-1\">\r\n          {{$cms.float(formData.rule.minScore)}}元\r\n        </el-form-item>\r\n        <el-form-item label=\"退款率<=\"  ref=\"rule.maxRefundRate\" v-if=\"productLimt.indexOf(4)>-1\">\r\n          {{formData.rule.maxRefundRate}}%\r\n        </el-form-item>\r\n        <el-form-item label=\"最新30天销量>=\"  ref=\"rule.minSale\" v-if=\"productLimt.indexOf(5)>-1\">\r\n          {{formData.rule.minSale}}件\r\n        </el-form-item>\r\n        <div v-if=\"$route.query.type=='save'\">\r\n        <h3 class=\"cms-segmentation\">活动报名</h3>\r\n       <el-form-item label=\"选择报名商品\"  prop=\"productIds\">\r\n         <cms-product :promoteId=\"$route.query.id\" v-model=\"signData.productIds\" :data=\"checkedProductData\"></cms-product>\r\n        </el-form-item>\r\n           <el-form-item label=\"\" >\r\n         <el-button type=\"primary\" @click=\"signPromote\">报名</el-button>\r\n        </el-form-item>\r\n        </div>\r\n      </el-form>\r\n    </div>\r\n  </div>\r\n</template>\r\n<script>\r\nimport rules from '@/rules/index.js'\r\nimport form from '@/mixins/form.js'\r\nimport { activityPlatformGet, signPlatformPromote, getActivityPlatformSign } from '@/api/marketing/index.js'\r\nimport categoryCascader from '@/components/cms/categoryCascader'\r\nimport cmsCoupon from './../../../components/operation/cmsCoupon'\r\nimport cmsProduct from './../../../components/operation/cmsProduct'\r\nvar defaultData = {\r\n  promote: {\r\n    name: '',\r\n    promoteBeginTime: '',\r\n    promoteEndTime: '',\r\n    remark: '',\r\n    enable: false,\r\n    promoteType: '',\r\n    product_flag_icon: ''\r\n  },\r\n  rule: {\r\n    signBeginTime: '',\r\n    signEndTime: '',\r\n    signScope: '',\r\n    oneFeeThird: '',\r\n    oneFeeSelf: '',\r\n    maxRefundRate: '',\r\n    minPrice: '',\r\n    minSale: '',\r\n    minScore: '',\r\n    minStock: ''\r\n  },\r\n  discounts: [\r\n    {\r\n      conOrderAmount: 0,\r\n      discountAmount: 0\r\n    }\r\n  ],\r\n  signLimitCtgIds: [],\r\n  couponIds: []\r\n}\r\nexport default {\r\n  components: { categoryCascader, cmsCoupon, cmsProduct },\r\n  mixins: [form],\r\n  data() {\r\n    return {\r\n      coupons: [],\r\n      productLimt: [], // 商品报名限制\r\n      activeTimer: [],\r\n      signTimer: [],\r\n      formData: Object.assign({}, defaultData),\r\n      signData: {\r\n        id: this.$route.query.id,\r\n        productIds: []\r\n      },\r\n      checkedProductData: [], // 回填显示选中的商品数组\r\n      rules: {\r\n        'productIds': [rules.required('至少选择一件商品')]\r\n      }\r\n    }\r\n  },\r\n  methods: {\r\n    getSignData(id) {\r\n      getActivityPlatformSign({ promoteId: id }).then(res => {\r\n        if (res.code === 200) {\r\n          this.checkedProductData = res.data.products\r\n        }\r\n      })\r\n    },\r\n    getFormData(id) {\r\n      this.status = false\r\n      this.loading = true\r\n      activityPlatformGet({ id: id })\r\n        .then(res => {\r\n          if (res.code === 200) {\r\n            this.copyData(res.data)\r\n            this.status = true\r\n            this.loading = false\r\n          } else {\r\n            this.loading = false\r\n          }\r\n        })\r\n        .catch(res2 => {\r\n          this.loading = false\r\n        })\r\n    },\r\n    copyData(data) {\r\n      const promote = this.formData.promote\r\n      const rule = this.formData.rule\r\n      promote.id = data.id\r\n      promote.name = data.name\r\n      promote.promoteBeginTime = this.$moment(data.promoteBeginTime, 'YYYY-MM-DD')\r\n      promote.promoteEndTime = this.$moment(data.promoteEndTime, 'YYYY-MM-DD')\r\n      this.activeTimer = [promote.promoteBeginTime, promote.promoteEndTime]\r\n      promote.remark = data.remark\r\n      promote.enable = data.enable\r\n      promote.promoteType = data.promoteType\r\n      rule.signBeginTime = this.$moment(data.rule.signBeginTime, 'YYYY-MM-DD')\r\n      rule.signEndTime = this.$moment(data.rule.signEndTime, 'YYYY-MM-DD')\r\n      this.signTimer = [rule.signBeginTime, rule.signEndTime]\r\n      rule.signScope = data.rule.signScope\r\n      rule.oneFeeThird = data.rule.oneFeeThird\r\n      rule.oneFeeSelf = data.rule.oneFeeSelf\r\n      rule.maxRefundRate = data.rule.maxRefundRate\r\n      rule.id = data.id\r\n      if (data.rule.minPrice > 1) {\r\n        this.productLimt.push(parseInt(1))\r\n      }\r\n      if (data.rule.minStock > 2) {\r\n        this.productLimt.push(parseInt(2))\r\n      }\r\n      if (data.rule.minScore > 3) {\r\n        this.productLimt.push(parseInt(3))\r\n      }\r\n\r\n      if (data.rule.maxRefundRate > 4) {\r\n        this.productLimt.push(parseInt(4))\r\n      }\r\n      if (data.rule.minSale > 5) {\r\n        this.productLimt.push(parseInt(5))\r\n      }\r\n      rule.minPrice = data.rule.minPrice\r\n      rule.minSale = data.rule.minSale\r\n      rule.minScore = data.rule.minScore\r\n      rule.minStock = data.rule.minStock\r\n      this.formData.discounts = data.discounts\r\n      if (data.rule.ctgs && data.rule.ctgs.length > 0) {\r\n        this.formData.signLimitCtgIds = data.rule.ctgs.map(v => v.id)\r\n      }\r\n      if (data.coupons && data.coupons.length > 0) {\r\n        this.coupons = data.coupons\r\n        this.formData.couponIds = data.coupons.map(v => v.id)\r\n      }\r\n    },\r\n    signPromote() { // 报名参加活动\r\n      this.$refs.form.validate((valid, item) => {\r\n        if (valid) {\r\n          signPlatformPromote(this.signData).then(res => {\r\n            if (res.code === 200) {\r\n              this.$successMessage('报名成功')\r\n              setTimeout(() => {\r\n                this.$routerLink('/platformActivity/list')\r\n              }, 1000)\r\n            } else {\r\n              this.$errorMessage(res.message)\r\n            }\r\n          })\r\n        } else {\r\n          return false\r\n        }\r\n      })\r\n    }\r\n  },\r\n  created() {\r\n    this.getSignData(this.$route.query.id)\r\n    this.getFormData(this.$route.query.id)\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.discounts__add {\r\n  cursor: pointer;\r\n}\r\n.discounts__add .iconfont {\r\n  position: relative;\r\n  top: 1px;\r\n  margin-right: 3px;\r\n}\r\n</style>\r\n\n\n\n// WEBPACK FOOTER //\n// src/views/marketing/activityMange/edit.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('cms-breadcrumb',{attrs:{\"to\":\"/platformActivity/list\",\"type\":\"list\"},on:{\"click\":_vm.rest}},[_c('li',[_vm._v(_vm._s(_vm.$route.name))])]),_vm._v(\" \"),_c('div',{staticClass:\"cms-form-layout\"},[_c('el-form',{directives:[{name:\"loading\",rawName:\"v-loading\",value:(_vm.loading),expression:\"loading\"}],ref:\"form\",attrs:{\"rules\":_vm.rules,\"model\":_vm.signData,\"label-width\":\"210px\"},nativeOn:{\"submit\":function($event){$event.preventDefault();}}},[_c('el-form-item',{ref:\"promote_name\",attrs:{\"label\":\"活动名称\"}},[_vm._v(\"\\n        \"+_vm._s(_vm.formData.promote.name)+\"\\n      \")]),_vm._v(\" \"),_c('el-form-item',{ref:\"promote.promoteBeginTime\",attrs:{\"label\":\"活动时间\",\"error\":_vm.errorMessage['promote.promoteBeginTime']}},[_vm._v(\"\\n        \"+_vm._s(_vm.activeTimer[0])+\" 至 \"+_vm._s(_vm.activeTimer[1])+\"\\n      \")]),_vm._v(\" \"),_c('el-form-item',{ref:\"rule.signBeginTime\",attrs:{\"label\":\"报名时间\",\"error\":_vm.errorMessage['rule.signBeginTime']}},[_vm._v(\"\\n        \"+_vm._s(_vm.signTimer[0])+\" 至 \"+_vm._s(_vm.signTimer[1])+\"\\n      \")]),_vm._v(\" \"),_c('el-form-item',{ref:\"promote.remark\",attrs:{\"label\":\"活动说明\"}},[_vm._v(\"\\n        \"+_vm._s(_vm.formData.promote.remark)+\"\\n      \")]),_vm._v(\" \"),_c('el-form-item',{ref:\"rule_signScope\",attrs:{\"label\":\"活动报名限制\"}},[(_vm.formData.rule.signScope==1)?_c('span',[_vm._v(\"全部商品\")]):_vm._e(),_vm._v(\" \"),(_vm.formData.rule.signScope==2)?_c('span',[_vm._v(\"自营商品\")]):_vm._e(),_vm._v(\" \"),(_vm.formData.rule.signScope==3)?_c('span',[_vm._v(\"部分类目\")]):_vm._e()]),_vm._v(\" \"),_c('el-form-item',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.formData.rule.signScope===3),expression:\"formData.rule.signScope===3\"}],attrs:{\"label\":\"选择类目\"}},[_c('category-cascader',{staticStyle:{\"width\":\"380px\"},model:{value:(_vm.formData.signLimitCtgIds),callback:function ($$v) {_vm.$set(_vm.formData, \"signLimitCtgIds\", $$v)},expression:\"formData.signLimitCtgIds\"}})],1),_vm._v(\" \"),_c('el-form-item',{ref:\"promote.promoteType\",attrs:{\"label\":\"活动支持优惠形式\"}},[(_vm.formData.promote.promoteType==4)?_c('span',[_vm._v(\"优惠券\")]):_vm._e(),_vm._v(\" \"),(_vm.formData.promote.promoteType==3)?_c('span',[_vm._v(\"满减\")]):_vm._e()]),_vm._v(\" \"),_c('el-form-item',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.formData.promote.promoteType==4),expression:\"formData.promote.promoteType==4\"}],attrs:{\"label\":\"选择优惠券\"}},[_c('cms-coupon',{attrs:{\"disEdit\":true,\"data\":_vm.coupons},model:{value:(_vm.formData.couponIds),callback:function ($$v) {_vm.$set(_vm.formData, \"couponIds\", $$v)},expression:\"formData.couponIds\"}})],1),_vm._v(\" \"),_c('el-form-item',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.formData.promote.promoteType==3),expression:\"formData.promote.promoteType==3\"}],attrs:{\"label\":\"满减信息\"}},[_c('ul',_vm._l((_vm.formData.discounts),function(item,index){return _c('li',{key:index,staticStyle:{\"margin-bottom\":\"10px\"}},[_vm._v(\"\\n            满 \"+_vm._s(item.conOrderAmount)+\"\\n            减 \"+_vm._s(item.discountAmount)+\"\\n          \")])}),0)]),_vm._v(\" \"),_c('el-form-item',{ref:\"rule.oneFeeThird\",attrs:{\"label\":\"自营店铺单品收费\"}},[_vm._v(\"\\n        \"+_vm._s(_vm.$cms.float(_vm.formData.rule.oneFeeThird))+\"元\\n      \")]),_vm._v(\" \"),_c('el-form-item',{ref:\"rule.oneFeeSelf\",attrs:{\"label\":\"非自营店铺单品收费\"}},[_vm._v(\"\\n        \"+_vm._s(_vm.$cms.float(_vm.formData.rule.oneFeeSelf))+\"元\\n      \")]),_vm._v(\" \"),(_vm.productLimt.indexOf(1)>-1)?_c('el-form-item',{ref:\"rule.minPrice\",attrs:{\"label\":\"最新30天成交价>=\"}},[_vm._v(\"\\n        \"+_vm._s(_vm.$cms.float(_vm.formData.rule.minPrice))+\"元\\n      \")]):_vm._e(),_vm._v(\" \"),(_vm.productLimt.indexOf(2)>-1)?_c('el-form-item',{ref:\"rule.minStock\",attrs:{\"label\":\"库存>=\"}},[_vm._v(\"\\n        \"+_vm._s(_vm.$cms.float(_vm.formData.rule.minStock))+\"元\\n      \")]):_vm._e(),_vm._v(\" \"),(_vm.productLimt.indexOf(3)>-1)?_c('el-form-item',{ref:\"rule.minScore\",attrs:{\"label\":\"商品评分>=\"}},[_vm._v(\"\\n        \"+_vm._s(_vm.$cms.float(_vm.formData.rule.minScore))+\"元\\n      \")]):_vm._e(),_vm._v(\" \"),(_vm.productLimt.indexOf(4)>-1)?_c('el-form-item',{ref:\"rule.maxRefundRate\",attrs:{\"label\":\"退款率<=\"}},[_vm._v(\"\\n        \"+_vm._s(_vm.formData.rule.maxRefundRate)+\"%\\n      \")]):_vm._e(),_vm._v(\" \"),(_vm.productLimt.indexOf(5)>-1)?_c('el-form-item',{ref:\"rule.minSale\",attrs:{\"label\":\"最新30天销量>=\"}},[_vm._v(\"\\n        \"+_vm._s(_vm.formData.rule.minSale)+\"件\\n      \")]):_vm._e(),_vm._v(\" \"),(_vm.$route.query.type=='save')?_c('div',[_c('h3',{staticClass:\"cms-segmentation\"},[_vm._v(\"活动报名\")]),_vm._v(\" \"),_c('el-form-item',{attrs:{\"label\":\"选择报名商品\",\"prop\":\"productIds\"}},[_c('cms-product',{attrs:{\"promoteId\":_vm.$route.query.id,\"data\":_vm.checkedProductData},model:{value:(_vm.signData.productIds),callback:function ($$v) {_vm.$set(_vm.signData, \"productIds\", $$v)},expression:\"signData.productIds\"}})],1),_vm._v(\" \"),_c('el-form-item',{attrs:{\"label\":\"\"}},[_c('el-button',{attrs:{\"type\":\"primary\"},on:{\"click\":_vm.signPromote}},[_vm._v(\"报名\")])],1)],1):_vm._e()],1)],1)],1)}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/_vue-loader@13.7.3@vue-loader/lib/template-compiler?{\"id\":\"data-v-2347b8a7\",\"hasScoped\":true,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/_vue-loader@13.7.3@vue-loader/lib/selector.js?type=template&index=0!./src/views/marketing/activityMange/edit.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../../../node_modules/_extract-text-webpack-plugin@3.0.2@extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true,\\\"publicPath\\\":\\\"../../\\\"}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../../../node_modules/_vue-loader@13.7.3@vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-2347b8a7\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!../../../../node_modules/_vue-loader@13.7.3@vue-loader/lib/selector?type=styles&index=0!./edit.vue\")\n}\nvar normalizeComponent = require(\"!../../../../node_modules/_vue-loader@13.7.3@vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../../../node_modules/_vue-loader@13.7.3@vue-loader/lib/selector?type=script&index=0!./edit.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../../node_modules/_vue-loader@13.7.3@vue-loader/lib/selector?type=script&index=0!./edit.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../../node_modules/_vue-loader@13.7.3@vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-2347b8a7\\\",\\\"hasScoped\\\":true,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../../node_modules/_vue-loader@13.7.3@vue-loader/lib/selector?type=template&index=0!./edit.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-2347b8a7\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/views/marketing/activityMange/edit.vue\n// module id = null\n// module chunks = "],"sourceRoot":""}
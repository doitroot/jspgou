webpackJsonp([47],{XJK7:function(e,t){},cOd5:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a("kfHR"),o=a.n(s),n=a("lRwf"),i=a.n(n);function r(e,t,a,s,n){var c=[],l=0;return o()(e).forEach(function(e){if(e.nodeIds&&(l=e.nodeIds.length-1),i.a.set(e,"_expanded",!0),i.a.set(e,"_show",!0),i.a.set(e,"_load",!1),i.a.set(e,"_level",l),c.push(e),e.childs&&e.childs.length>0){var a=r(e.childs,t,e,l,n);c=c.concat(a)}}),c}var c=a("AsmT"),l={mixins:[a("5HJ5").a],data:function(){return{typeList:[],tableData:[],expandAll:!1,queryParams:{cateName:""},selfId:0,columnState:!0}},computed:{backUrl:function(){return"selfShop"===this.$route.query.type?"/selfShops/list":"/shopManage/list"}},methods:{showRow:function(e){var t=e.row._show;return e.row._show=t,t?"animation:treeTableShow 1s;-webkit-animation:treeTableShow 1s;":"display:none;"},toggleExpanded:function(e){var t=this,a=this.tableData[e];a._expanded?a._load?(this.chidView(a,!0),a._expanded=!1):(this.queryParams.parentId=a.id,this.loading=!0,Object(c.d)(this.queryParams).then(function(s){if(200===s.code){for(var o=r(s.data),n=0;n<o.length;n++)t.tableData.splice(e+(n+1),0,o[n]);a._expanded=!1,a._load=!0,t.loading=!1}})):(a._expanded=!0,this.chidView(a,!1))},switchShow:function(e){var t=this;console.log(e),Object(c.c)(e).then(function(e){200===e.code?t.$successMessage("修改成功"):t.$errorMessage(e.code)})},chidView:function(e,t){var a=[];o()(this.tableData).forEach(function(s){s.nodeIds.indexOf(e.id)>-1&&s.id!==e.id&&(s._show=t),a.push(s)}),this.tableData=a},iconShow:function(e,t){return!t.isChild},getTableData:function(e,t){var a=this;this.loading=!0,e(t).then(function(e){200===e.code&&(a.tableData=r(e.data),a.loading=!1)})},deleteData:function(e,t){var a=this;this.$confirm("是否确定删除店铺商品分类?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"error"}).then(function(){a.loading=!0,Object(c.a)({ids:[e.id]}).then(function(s){a.loading=!1,200===s.code?(e.isChild?a.tableData.splice(t,1):(a.queryParams.parentId="",a.getTableData(c.d,a.queryParams)),a.$successMessage("删除成功")):a.$errorMessage("删除失败,"+s.message)})}).catch(function(){})},addNew:function(){this.$router.push({path:"/store/category/save",query:{storeId:this.$route.query.id}})},query:function(){this.getTableData(c.d,this.queryParams)},getTypeList:function(){this.getTableData(c.d,this.queryParams)}},activated:function(){this.getTableData(c.d,this.queryParams)},created:function(){this.getTableData(c.d,this.queryParams)}},d={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"cms-list-layout"},[a("cms-prompt",{attrs:{collapse:"true"}},[a("li",[e._v("显示商品分类列表信息")]),e._v(" "),a("li",[e._v("可对商品分类进行新增、修改、删除及查看、新增下级商品分类")])]),e._v(" "),a("section",{staticClass:"cms-list-query"},[a("div",{staticClass:"query-group"},[a("label",[e._v("分类名称")]),e._v(" "),a("el-input",{model:{value:e.queryParams.cateName,callback:function(t){e.$set(e.queryParams,"cateName",t)},expression:"queryParams.cateName"}})],1),e._v(" "),a("div",{staticClass:"query-group"},[a("cms-button",{attrs:{size:"small",colorPicker:!0},on:{click:e.query}},[e._v("查询")])],1)]),e._v(" "),a("section",{staticClass:"cms-batch"},[a("cms-button",{directives:[{name:"prem",rawName:"v-prem",value:"/store/category/save",expression:"'/store/category/save'"}],attrs:{icon:"add",type:"success",size:"small"},on:{click:function(t){e.$routerLink("/store/category/save",e.$route.query.type,{nodeIds:"0"})}}},[e._v("添加分类\n      ")])],1),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.tableData,"row-style":e.showRow}},[a("el-table-column",{attrs:{label:"分类名称","min-width":"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[e.iconShow(t.$index,t.row)?a("div",{staticClass:"menu-name",style:{marginLeft:16*t.row._level+"px"},on:{click:function(a){e.toggleExpanded(t.$index)}}},[a("span",{staticClass:"tree-ctrl"},[t.row._expanded?a("i",{staticClass:"el-icon-caret-right"}):a("i",{staticClass:"el-icon-caret-bottom"})]),e._v(" "),a("span",[e._v(e._s(t.row.cateName))])]):a("div",{style:{marginLeft:16*t.row._level+"px"}},[a("span",{staticClass:"icon-dot"},[e._v("○")]),e._v(" "),a("span",[e._v(e._s(t.row.cateName))])])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"排序",prop:"sortNum"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.sortNum))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"是否显示",prop:"isShow"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("cms-switch",{on:{change:function(a){e.switchShow(t.row)}},model:{value:t.row.isShow,callback:function(a){e.$set(t.row,"isShow",a)},expression:"scope.row.isShow"}})]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"是否显示店铺导航栏",prop:"isTop","min-width":"200",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("cms-switch",{on:{change:function(a){e.switchShow(t.row)}},model:{value:t.row.isTop,callback:function(a){e.$set(t.row,"isTop",a)},expression:"scope.row.isTop"}})]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"updateTime",label:"更新时间","min-width":"160"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n          "+e._s(e.$moment(t.row.updateTime))+"\n        ")]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"操作",width:"280",fixed:"right",align:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.nodeIds.length<2?a("cms-button",{attrs:{icon:"add",size:"small",type:"info"},on:{click:function(a){e.$routerLink("/store/category/save",e.$route.query.type,{storeId:e.$route.query.id,nodeIds:t.row.nodeIds.toString()})}}},[e._v("新增下级分类\n          ")]):e._e(),e._v(" "),a("cms-button",{directives:[{name:"prem",rawName:"v-prem",value:"/store/category/update",expression:"'/store/category/update'"}],attrs:{icon:"edit",size:"small",type:"info"},on:{click:function(a){e.$routerLink("/store/category/update","update",{id:t.row.id,nodeIds:t.row.nodeIds.toString()})}}},[e._v("编辑\n          ")]),e._v(" "),a("cms-button",{attrs:{icon:"delete",size:"small",type:"info"},on:{click:function(a){a.stopPropagation(),e.deleteData(t.row,t.$index)}}},[e._v("删除")])]}}])})],1)],1)])},staticRenderFns:[]};var u=a("C7Lr")(l,d,!1,function(e){a("XJK7")},"data-v-6b4906ce",null);t.default=u.exports}});
//# sourceMappingURL=47.f15a1a0f8b1d171d4723.js.map
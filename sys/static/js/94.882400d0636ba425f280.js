webpackJsonp([94],{J88y:function(e,t){},"RxL/":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a("ZLEe"),i=a.n(s),l=a("aA9S"),r=a.n(l),o=a("x1ym"),n=a("lcoF"),m=a("gfuC"),d={id:"",mesCode:"",mesTitle:"",remark:"",hasDeleted:"",details:[{id:"",isOpen:"",mesType:"1",mesContent:""},{id:"",isOpen:"",mesType:"2",mesContent:"",mesTitle:""},{id:"",isOpen:"",mesType:"3",mesContent:""},{id:"",isOpen:"",mesType:"5",mesContent:"",pushParams:""}]},c={name:"messageSetShopEdit",mixins:[n.a],data:function(){return{activeName:"1",formData:r()({},d),isEdit:[!1,!1,!1,!1],tempData:"",saveRules:{mesCode:[o.a.required("请填写模板标识"),o.a.english(),o.a.len(1,150)],mesTitle:[o.a.required("请填写模板标题"),o.a.len(1,150)],remark:[o.a.len(1,500)]}}},methods:{setEdit:function(e){this.tempData=this.formData.details[e].extendedField,this.$set(this.isEdit,e,!0)},setCancel:function(e){this.$set(this.formData.details[e],"extendedField",this.tempData),this.$set(this.isEdit,e,!1)},getFormData:function(e){var t=this;Object(m.e)({id:e}).then(function(e){t.formData=r()(d,e.data)})},update:function(){var e=this;this.formData.mesType=this.$route.query.mesType,this.$refs.form.validate(function(t,a){var s=i()(a),l="",r=/\d/;if(s.length>0&&s.forEach(function(e){l=e.match(r)}),l&&(e.activeName=String(parseInt(l[0])+1)),!t||!e.validateTplId())return!1;delete e.formData.hasDeleted,Object(m.d)(e.formData).then(function(t){200===t.code?(e.$successMessage("保存成功"),1===e.$route.query.mesType?e.$routerLink("/messageSet/userTpl/list","list"):2===e.$route.query.mesType?e.$routerLink("/messageSet/shopTpl/list","list"):e.$routerLink("/messageSet/platformTpl/list","list")):e.$errorMessage(t.message)})})},validateTplId:function(){return!this.formData.details[2].isOpen||(!!/^\w+$/.test(this.formData.details[2].tplId)||(this.$errorMessage("短信模板ID格式不正确"),!1))},changeOpen:function(e){e||this.$refs.form.clearValidate()},reset:function(){this.getFormData(this.$route.query.id),this.$refs.form.clearValidate()},changeTabs:function(e,t){this.activeName=e.name}},created:function(){this.getFormData(this.$route.query.id)}},f={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[2==e.$route.query.mesType?a("cms-breadcrumb",{attrs:{to:"/messageSet/shopTpl/list"}},[a("li",[e._v("商家消息模板-修改")])]):e._e(),e._v(" "),1==e.$route.query.mesType?a("cms-breadcrumb",{attrs:{to:"/messageSet/userTpl/list"}},[a("li",[e._v("用户消息模板-修改")])]):e._e(),e._v(" "),4==e.$route.query.mesType?a("cms-breadcrumb",{attrs:{to:"/messageSet/platformTpl/list"}},[a("li",[e._v("平台消息模板-修改")])]):e._e(),e._v(" "),a("div",{staticClass:"cms-form-layout"},[a("cms-prompt",{attrs:{collapse:!1}},[1!=e.$route.query.mesType?a("li",[e._v(" 修改系统对商家发送消息的内容、方式")]):e._e(),e._v(" "),1==e.$route.query.mesType?a("li",[e._v(" 修改系统对用户发送消息的内容、方式")]):e._e()]),e._v(" "),a("el-form",{ref:"form",attrs:{rules:e.saveRules,model:e.formData,"label-width":"210px"}},[a("el-form-item",{attrs:{label:"模板标题",prop:"mesTitle",error:e.errorMessage.mesTitle}},[a("el-input",{ref:"first",attrs:{autofocus:!0,maxlength:"100"},model:{value:e.formData.mesTitle,callback:function(t){e.$set(e.formData,"mesTitle",t)},expression:"formData.mesTitle"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"模板标识",prop:"mesCode",error:e.errorMessage.mesCode}},[a("div",{staticClass:"message-flow"},[e._v(e._s(e.formData.mesCode))])]),e._v(" "),a("el-form-item",{attrs:{label:"模板描述",prop:"remark",error:e.errorMessage.remark}},[a("el-input",{attrs:{type:"textarea",rows:6,maxlength:"200"},model:{value:e.formData.remark,callback:function(t){e.$set(e.formData,"remark",t)},expression:"formData.remark"}})],1),e._v(" "),a("el-tabs",{on:{"tab-click":e.changeTabs},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[a("el-tab-pane",{attrs:{label:"站内信",name:"1"}},[a("el-form-item",{attrs:{label:"是否开启"}},[a("cms-switch",{on:{change:e.changeOpen},model:{value:e.formData.details[0].isOpen,callback:function(t){e.$set(e.formData.details[0],"isOpen",t)},expression:"formData.details[0].isOpen"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"模板内容",prop:"details[0].mesContent",rules:e.formData.details[0].isOpen?[{required:!0,message:"模板内容必须填写",trigger:"blur"}]:[]}},[a("el-input",{attrs:{type:"textarea",rows:4,maxlength:"200"},model:{value:e.formData.details[0].mesContent,callback:function(t){e.$set(e.formData.details[0],"mesContent",t)},expression:"formData.details[0].mesContent"}}),e._v(" "),e.isEdit[0]?e._e():a("span",{staticClass:"gray message-flow text-overflow"},[e._v(e._s(e.formData.details[0].extendedField)+" \n              "),a("i",{staticClass:"el-icon-edit message-icon",attrs:{title:"修改"},on:{click:function(t){e.setEdit(0)}}})])],1),e._v(" "),e.isEdit[0]?a("el-form-item",{attrs:{label:"提示文案",prop:"details[0].extendedField"}},[a("el-input",{attrs:{maxlength:"200"},model:{value:e.formData.details[0].extendedField,callback:function(t){e.$set(e.formData.details[0],"extendedField",t)},expression:"formData.details[0].extendedField"}}),e._v(" "),a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(t){e.setCancel(0)}}},[e._v("取消")])],1):e._e()],1),e._v(" "),a("el-tab-pane",{attrs:{label:"邮件",name:"2"}},[a("el-form-item",{attrs:{label:"是否开启"}},[a("cms-switch",{on:{change:e.changeOpen},model:{value:e.formData.details[1].isOpen,callback:function(t){e.$set(e.formData.details[1],"isOpen",t)},expression:"formData.details[1].isOpen"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"消息标题",prop:"details[1].mesTitle",rules:e.formData.details[1].isOpen?[{required:!0,message:"消息标题必须填写",trigger:"blur"}]:[]}},[a("el-input",{attrs:{maxlength:"100"},model:{value:e.formData.details[1].mesTitle,callback:function(t){e.$set(e.formData.details[1],"mesTitle",t)},expression:"formData.details[1].mesTitle"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"模板内容",prop:"details[1].mesContent",rules:e.formData.details[1].isOpen?[{required:!0,message:"模板内容必须填写",trigger:"blur"}]:[]}},[a("el-input",{attrs:{type:"textarea",rows:4,maxlength:"200"},model:{value:e.formData.details[1].mesContent,callback:function(t){e.$set(e.formData.details[1],"mesContent",t)},expression:"formData.details[1].mesContent"}}),e._v(" "),e.isEdit[1]?e._e():a("span",{staticClass:"gray message-flow text-overflow"},[e._v(e._s(e.formData.details[1].extendedField)+" \n              "),a("i",{staticClass:"el-icon-edit message-icon",attrs:{title:"修改"},on:{click:function(t){e.setEdit(1)}}})])],1),e._v(" "),e.isEdit[1]?a("el-form-item",{attrs:{label:"提示文案",prop:"details[1].extendedField"}},[a("el-input",{attrs:{maxlength:"200"},model:{value:e.formData.details[1].extendedField,callback:function(t){e.$set(e.formData.details[1],"extendedField",t)},expression:"formData.details[1].extendedField"}}),e._v(" "),a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(t){e.setCancel(1)}}},[e._v("取消")])],1):e._e()],1),e._v(" "),a("el-tab-pane",{attrs:{label:"手机",name:"3"}},[a("el-form-item",{attrs:{label:"是否开启"}},[a("cms-switch",{on:{change:e.changeOpen},model:{value:e.formData.details[2].isOpen,callback:function(t){e.$set(e.formData.details[2],"isOpen",t)},expression:"formData.details[2].isOpen"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"模板id",prop:"details[2].tplId",rules:e.formData.details[2].isOpen?[{required:!0,message:"模板id必须填写",trigger:"blur"}]:[]}},[a("el-input",{attrs:{maxlength:"100"},model:{value:e.formData.details[2].tplId,callback:function(t){e.$set(e.formData.details[2],"tplId",t)},expression:"formData.details[2].tplId"}}),e._v(" "),a("div",{staticClass:"gray"},[e._v("对应系统开启的短信服务商设置好的短信模板ID")])],1),e._v(" "),a("el-form-item",{attrs:{label:"模板内容",prop:"details[2].mesContent",rules:e.formData.details[2].isOpen?[{required:!0,message:"模板内容必须填写",trigger:"blur"}]:[]}},[a("el-input",{attrs:{type:"textarea",rows:4,maxlength:"200"},model:{value:e.formData.details[2].mesContent,callback:function(t){e.$set(e.formData.details[2],"mesContent",t)},expression:"formData.details[2].mesContent"}}),e._v(" "),e.isEdit[2]?e._e():a("span",{staticClass:"gray message-flow text-overflow"},[e._v(e._s(e.formData.details[2].extendedField)+" \n              "),a("i",{staticClass:"el-icon-edit message-icon",attrs:{title:"修改"},on:{click:function(t){e.setEdit(2)}}})])],1),e._v(" "),e.isEdit[2]?a("el-form-item",{attrs:{label:"提示文案",prop:"details[2].extendedField"}},[a("el-input",{attrs:{maxlength:"200"},model:{value:e.formData.details[2].extendedField,callback:function(t){e.$set(e.formData.details[2],"extendedField",t)},expression:"formData.details[2].extendedField"}}),e._v(" "),a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(t){e.setCancel(2)}}},[e._v("取消")])],1):e._e()],1),e._v(" "),1==e.$route.query.mesType?a("el-tab-pane",{attrs:{label:"推送",name:"4"}},[a("el-form-item",{attrs:{label:"是否开启推送"}},[a("cms-switch",{on:{change:e.changeOpen},model:{value:e.formData.details[3].isOpen,callback:function(t){e.$set(e.formData.details[3],"isOpen",t)},expression:"formData.details[3].isOpen"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"标题",prop:"details[3].mesTitle",rules:e.formData.details[3].isOpen?[{required:!0,message:"标题必须填写",trigger:"blur"}]:[]}},[a("el-input",{attrs:{maxlength:"100"},model:{value:e.formData.details[3].mesTitle,callback:function(t){e.$set(e.formData.details[3],"mesTitle",t)},expression:"formData.details[3].mesTitle"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"内容",prop:"details[3].mesContent",rules:e.formData.details[3].isOpen?[{required:!0,message:"内容必须填写",trigger:"blur"}]:[]}},[a("el-input",{attrs:{type:"textarea",rows:4,maxlength:"200"},model:{value:e.formData.details[3].mesContent,callback:function(t){e.$set(e.formData.details[3],"mesContent",t)},expression:"formData.details[3].mesContent"}}),e._v(" "),e.isEdit[3]?e._e():a("span",{staticClass:"gray message-flow text-overflow"},[e._v(e._s(e.formData.details[3].extendedField)+" \n              "),a("i",{staticClass:"el-icon-edit message-icon",attrs:{title:"修改"},on:{click:function(t){e.setEdit(3)}}})])],1),e._v(" "),e.isEdit[3]?a("el-form-item",{attrs:{label:"提示文案",prop:"details[3].extendedField"}},[a("el-input",{attrs:{maxlength:"200"},model:{value:e.formData.details[3].extendedField,callback:function(t){e.$set(e.formData.details[3],"extendedField",t)},expression:"formData.details[3].extendedField"}}),e._v(" "),a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(t){e.setCancel(3)}}},[e._v("取消")])],1):e._e(),e._v(" "),a("el-form-item",{attrs:{label:"参数结构",prop:"details[3].pushParams",rules:e.formData.details[3].isOpen?[{required:!0,message:"参数结构必须填写",trigger:"blur"}]:[]}},[a("el-input",{attrs:{type:"textarea",rows:4,maxlength:"500"},model:{value:e.formData.details[3].pushParams,callback:function(t){e.$set(e.formData.details[3],"pushParams",t)},expression:"formData.details[3].pushParams"}})],1)],1):e._e()],1),e._v(" "),a("div",{staticClass:"cms-form-footer"},[a("cms-button",{directives:[{name:"color",rawName:"v-color"}],on:{click:e.update}},[e._v("保存")]),e._v(" "),a("cms-button",{attrs:{type:"rest"},on:{click:e.reset}},[e._v("重置")])],1)],1)],1)],1)},staticRenderFns:[]};var p=a("C7Lr")(c,f,!1,function(e){a("J88y")},"data-v-a18417ea",null);t.default=p.exports}});
//# sourceMappingURL=94.882400d0636ba425f280.js.map
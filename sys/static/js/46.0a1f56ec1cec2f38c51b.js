webpackJsonp([46],{"+W/3":function(e,t){},Si0U:function(e,t){},kRtb:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a("kfHR"),s=a.n(n),r=a("oW3I"),i=a("X2f8"),o={mixins:[a("5HJ5").a],data:function(){return{typeList:[],tableData:[],expandAll:!1,queryParams:{hasDeleted:"",parentId:"",platformType:"1"},selfId:0,columnState:!0}},methods:{toggleVisable:function(e,t){var a=this;e?Object(i.g)({ids:[t]}).then(function(e){200!==e.code&&a.$errorMessage("操作失败")}):Object(i.d)({ids:[t]}).then(function(e){200!==e.code&&a.$errorMessage("操作失败")})},sortNum:function(e,t){var a=this,n=e.target.value;if(""===n)return!1;/^[1-9][0-9]{0,1}$/.test(n)?(e.target.className="el-input__inner",Object(i.h)({sorts:[{id:t,sortNum:n}]}).then(function(e){200===e.code?a.$successMessage("修改成功"):a.$errorMessage("修改失败")})):(e.target.className="cms-error el-input__inner",this.$cmsMessage({message:"只能输入1-99的正整数",type:"error",timer:"1000",fastClick:!1}))},showRow:function(e){var t=e.row._show;return e.row._show=t,t?"animation:treeTableShow 1s;-webkit-animation:treeTableShow 1s;":"display:none;"},toggleExpanded:function(e){var t=this,a=this.tableData[e];a._expanded?a._load?(this.chidView(a,!0),a._expanded=!1):(this.queryParams.parentId=a.id,this.loading=!0,Object(i.e)(this.queryParams).then(function(n){if(200===n.code){for(var s=Object(r.a)(n.data),i=0;i<s.length;i++)t.tableData.splice(e+(i+1),0,s[i]);a._expanded=!1,a._load=!0,t.loading=!1}})):(a._expanded=!0,this.chidView(a,!1))},chidView:function(e,t){var a=[];s()(this.tableData).forEach(function(n){n.nodeIds.indexOf(e.id)>-1&&n.id!==e.id&&(n._show=t),a.push(n)}),this.tableData=a},iconShow:function(e,t){return!t.isChild},getTableData:function(e,t){var a=this;e(t).then(function(e){200===e.code&&(a.tableData=Object(r.a)(e.data)),a.loading=!1})},deleteData:function(e,t){var a=this;this.$confirm("删除菜单可能会影响系统正常运行,请确定是否删除!","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"error"}).then(function(){a.loading=!0,Object(i.b)({ids:[e.id]}).then(function(n){a.loading=!1,200===n.code?(e.isChild?a.tableData.splice(t,1):(a.queryParams.parentId="",a.getTableData(i.e,a.queryParams)),a.$successMessage("删除成功")):a.$errorMessage("删除失败,"+n.message)})}).catch(function(){})},changeTabs:function(e){this.loading=!0,this.queryParams.platformType=e.name,this.queryParams.parentId="",this.getTableData(i.e,this.queryParams)},getTypeList:function(){this.getTableData(i.e,this.queryParams)}},created:function(){this.loading=!1,"list"===this.$route.query.type&&(this.queryParams.platformType=this.$route.query.platformType),this.getTypeList()}},l={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"cms-list-layout"},[a("el-tabs",{on:{"tab-click":e.changeTabs},model:{value:e.queryParams.platformType,callback:function(t){e.$set(e.queryParams,"platformType",t)},expression:"queryParams.platformType"}},[a("el-tab-pane",{attrs:{label:"平台管理",name:"1"}}),e._v(" "),a("el-tab-pane",{attrs:{label:"商家管理",name:"2"}})],1),e._v(" "),a("cms-prompt",[a("li",[e._v("系统菜单的权限设置管理")])]),e._v(" "),a("cms-sticky",[a("section",{staticClass:"cms-batch",staticStyle:{border:"0"}},[a("cms-button",{directives:[{name:"prem",rawName:"v-prem",value:"/menuManager/save",expression:"'/menuManager/save'"}],attrs:{icon:"add",type:"success",size:"small"},on:{click:function(t){e.$routerLink("/menuManager/save","save",{nodeIds:"0",platformType:e.queryParams.platformType})}}},[e._v("添加菜单\n    ")])],1)]),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.tableData,"row-style":e.showRow}},[a("el-table-column",{attrs:{label:"菜单名称","min-width":"240"},scopedSlots:e._u([{key:"default",fn:function(t){return[e.iconShow(t.$index,t.row)?a("div",{staticClass:"menu-name",style:{marginLeft:16*t.row._level+"px"},on:{click:function(a){e.toggleExpanded(t.$index)}}},[a("span",{staticClass:"tree-ctrl"},[t.row._expanded?a("i",{staticClass:"el-icon-caret-right"}):a("i",{staticClass:"el-icon-caret-bottom"})]),e._v(" "),a("span",[e._v(e._s(t.row.menuName))])]):a("div",{style:{marginLeft:16*t.row._level+"px"}},[a("span",{staticClass:"icon-dot"},[e._v("○")]),e._v(" "),a("span",[e._v(e._s(t.row.menuName))])])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"链接地址",prop:"pagePath","min-width":"220"}}),e._v(" "),a("el-table-column",{attrs:{label:"类型",prop:"menuType"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n        "+e._s(1===t.row.menuType?"菜单":"权限")+"\n      ")]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"可见",prop:"show"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("cms-switch",{attrs:{id:t.row.id},on:{change:e.toggleVisable},model:{value:t.row.show,callback:function(a){e.$set(t.row,"show",a)},expression:"scope.row.show"}})]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"权限标识",prop:"accessIdentifier","min-width":"220"}}),e._v(" "),a("el-table-column",{attrs:{label:"排序",prop:"sortNum"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-input",{nativeOn:{keyup:function(a){if(!("button"in a)&&e._k(a.keyCode,"enter",13,a.key,"Enter"))return null;e.sortNum(a,t.row.id)}},model:{value:t.row.sortNum,callback:function(a){e.$set(t.row,"sortNum",a)},expression:"scope.row.sortNum"}})]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"操作",width:"280",fixed:"right",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticStyle:{"text-align":"right"}},[1===t.row.menuType?a("cms-button",{directives:[{name:"prem",rawName:"v-prem",value:"/menuManager/save",expression:"'/menuManager/save'"}],attrs:{icon:"add",size:"small",type:"info"},on:{click:function(a){e.$routerLink("/menuManager/save","save",{nodeIds:t.row.nodeIds.toString(),platformType:e.queryParams.platformType})}}},[e._v("添加下层菜单\n         ")]):e._e(),e._v(" "),a("cms-button",{directives:[{name:"prem",rawName:"v-prem",value:"/menuManager/update",expression:"'/menuManager/update'"}],attrs:{icon:"edit",size:"small",type:"info"},on:{click:function(a){e.$routerLink("/menuManager/update","update",{id:t.row.id,platformType:e.queryParams.platformType,nodeIds:t.row.nodeIds.toString()})}}},[e._v("编辑\n         ")]),e._v(" "),a("cms-button",{directives:[{name:"prem",rawName:"v-prem",value:"/menuManager/delete",expression:"'/menuManager/delete'"}],attrs:{icon:"delete",size:"small",type:"info"},on:{click:function(a){a.stopPropagation(),e.deleteData(t.row,t.$index)}}},[e._v("删除\n         ")])],1)]}}])})],1)],1)},staticRenderFns:[]};var c=a("C7Lr")(o,l,!1,function(e){a("Si0U"),a("+W/3")},"data-v-6eef6004",null);t.default=c.exports}});
//# sourceMappingURL=46.0a1f56ec1cec2f38c51b.js.map
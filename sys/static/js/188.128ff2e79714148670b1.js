webpackJsonp([188],{EgZG:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=i("HzJ8"),a=i.n(s),r=i("BOZ4"),c=i("+FNC"),n={components:{wxPictureZone:r.a},data:function(){return{getData:{},articles:[{title:"",thumb_media_id:"",author:"",digest:"",show_cover_pic:0,thumbMediaUrl:null,content:"",content_source_url:""}],activeIndex:0,ue:null,options:{toolbars:[["source","|","undo","redo","|","bold","italic","underline","fontborder","strikethrough","superscript","subscript","removeformat","formatmatch","autotypeset","blockquote","pasteplain","|","forecolor","backcolor","insertorderedlist","insertunorderedlist","selectall","cleardoc","|","rowspacingtop","rowspacingbottom","lineheight","|","customstyle","paragraph","fontfamily","fontsize","|","directionalityltr","directionalityrtl","indent","|","justifyleft","justifycenter","justifyright","justifyjustify","|","touppercase","tolowercase","|","link","unlink","anchor","|","imagenone","imageleft","imageright","imagecenter","|","insertcode","pagebreak","background","|","horizontal","date","time","wordimage","|","inserttable","deletetable","insertparagraphbeforetable","insertrow","deleterow","insertcol","deletecol","mergecells","mergeright","mergedown","splittocells","splittorows","splittocols","|"]],initialFrameHeight:500}}},methods:{validateData:function(t){var e=!0,i=!0,s=!1,r=void 0;try{for(var c,n=a()(this.articles);!(i=(c=n.next()).done);i=!0){var l=c.value;if(""===l.title){this.$errorMessage("必须填写一个标题"),e=!1;break}if(""===l.content){this.$errorMessage("图文内容不能为空"),e=!1;break}if(""===l.thumb_media_id){this.$errorMessage("图文需要一个封面"),e=!1;break}}}catch(t){s=!0,r=t}finally{try{!i&&n.return&&n.return()}finally{if(s)throw r}}return e},saveArticles:function(){var t=this;this.validateData()&&Object(c.R)({articles:this.articles}).then(function(e){200===e.code?(t.$successMessage("保存成功"),t.$routerLink("/wechatMaterial/list")):t.$errorMessage(e.message)})},updateArticles:function(){var t=this,e={id:this.getData.id,media_id:this.getData.mediaId,articles:this.articles};this.validateData()&&(e.articles.forEach(function(t,e){t.index=e}),Object(c.W)(e).then(function(e){200===e.code?(t.$successMessage("编辑成功"),t.$routerLink("/wechatMaterial/list")):t.$errorMessage(e.message)}))},addArticles:function(){this.articles.length<8?(this.articles.push({title:"",thumb_media_id:"",author:"",digest:"",show_cover_pic:0,thumbMediaUrl:"",content:"",content_source_url:""}),this.activeIndex=this.activeIndex+1):this.$errorMessage("最多只能添加8条图文信息")},setActiveIndex:function(t){this.activeIndex=t},getCover:function(t,e){this.$set(this.articles[e],"thumbMediaUrl",t[0].request.url),this.$set(this.articles[e],"thumb_media_id",t[0].mediaId)},getVideos:function(t){},getContentImg:function(t,e){var i="<img src="+t[0].request.url+"  style='max-width:750px'/>";this.ue.execCommand("insertHtml",i)},getEditor:function(t){this.ue=t},deleteArticle:function(t){var e=this;this.$nextTick(function(){e.activeIndex=t-1}),this.articles.splice(t,1)},articlesMove:function(t,e){if(this.articles.length>1)if("next"===e){var i=this.articles[t-1];this.$set(this.articles,t-1,this.articles[t]),this.$set(this.articles,t,i)}else{var s=this.articles[t+1];this.$set(this.articles,t+1,this.articles[t]),this.$set(this.articles,t,s)}}},created:function(){var t=this;"update"===this.$route.query.type&&(this.loading=!0,Object(c.M)({mediaId:this.$route.query.mediaId,type:"news"}).then(function(e){200===e.code&&(t.getData=e.data,t.articles=e.data.requestArray,t.loading=!1)}))}},l={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("cms-breadcrumb",{attrs:{to:"/wechatMaterial/list"}},[i("li",[t._v(t._s(t.$route.name))])]),t._v(" "),i("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"wx-msg cms-form-layout"},[i("div",{staticClass:"wx-msg-list"},[i("h3",{staticClass:"wx-msg__header"},[t._v("图文列表")]),t._v(" "),i("el-scrollbar",[i("div",{staticClass:"wx-msg-list__body"},[t._l(t.articles,function(e,s){return[0==s?i("div",{key:s,staticClass:" wx-msg-list__thumb wx-msg-item",class:t.activeIndex==s?"is-active":"",on:{click:function(e){t.setActiveIndex(s)}}},[i("div",{staticClass:"wx-msg-list__img",style:""!=e.thumbMediaUrl?{backgroundImage:"url("+t.$cms.weChatUrl(e.thumbMediaUrl)+")"}:""}),t._v(" "),i("div",{staticClass:"wx-msg-list__title"},[t._v("\n                "+t._s(""!=e.title?e.title:"标题")+"\n              ")]),t._v(" "),i("div",{staticClass:"wx-msg-item__cover"},[i("span",{staticClass:"wx-msg-item__cover--move"},[i("i",{staticClass:"el-icon-arrow-down",on:{click:function(e){t.articlesMove(s,"prev")}}})])])]):i("div",{key:s,staticClass:"wx-msg-list__sub wx-msg-item",class:t.activeIndex==s?"is-active":"",on:{click:function(e){t.setActiveIndex(s)}}},[i("div",{staticClass:"wx-msg-list__img--sub",style:""!=e.thumbMediaUrl?{backgroundImage:"url("+t.$cms.weChatUrl(e.thumbMediaUrl)+")"}:""}),t._v(" "),i("div",{staticClass:"wx-msg-list__title--sub"},[t._v("\n                "+t._s(""!=e.title?e.title:"标题"))]),t._v(" "),i("div",{staticClass:"wx-msg-item__cover"},[i("span",{staticClass:"wx-msg-item__cover--move"},[i("i",{staticClass:"el-icon-arrow-up",on:{click:function(e){t.articlesMove(s,"next")}}})]),t._v(" "),t.articles.length!=s+1?i("span",{staticClass:"wx-msg-item__cover--move "},[i("i",{staticClass:"el-icon-arrow-down",on:{click:function(e){t.articlesMove(s,"prev")}}})]):t._e(),t._v(" "),i("span",{staticClass:"wx-msg-item__cover--delete "},[i("i",{staticClass:"el-icon-delete",on:{click:function(e){t.deleteArticle(s)}}})])])])]})],2)]),t._v(" "),i("div",{staticClass:"wx-msg-list__add",on:{click:t.addArticles}},[i("i",{staticClass:"el-icon-plus"})])],1),t._v(" "),i("div",{staticClass:"wx-msg-content"},[i("div",{staticClass:"wx-msg-content__inner"},[i("input",{directives:[{name:"model",rawName:"v-model",value:t.articles[t.activeIndex].title,expression:"articles[activeIndex].title"}],staticClass:"wx-content__title",attrs:{type:"text",placeholder:"请在这里输入标题",autofocus:"",maxlength:"48"},domProps:{value:t.articles[t.activeIndex].title},on:{input:function(e){e.target.composing||t.$set(t.articles[t.activeIndex],"title",e.target.value)}}}),t._v(" "),i("label",{staticClass:"wx-content__label"},[t._v(t._s(t.articles[t.activeIndex].title.length)+"/48")])]),t._v(" "),i("div",{staticClass:"wx-msg-content__inner"},[i("input",{directives:[{name:"model",rawName:"v-model",value:t.articles[t.activeIndex].author,expression:"articles[activeIndex].author"}],staticClass:"wx-content__author",attrs:{type:"text",placeholder:"请输入作者",maxlength:"8"},domProps:{value:t.articles[t.activeIndex].author},on:{input:function(e){e.target.composing||t.$set(t.articles[t.activeIndex],"author",e.target.value)}}}),t._v(" "),i("label",{staticClass:"wx-content__label"},[t._v(t._s(t.articles[t.activeIndex].author.length)+"/8")])]),t._v(" "),i("div",{staticClass:"wx-msg-content__inner"},[i("input",{directives:[{name:"model",rawName:"v-model",value:t.articles[t.activeIndex].content_source_url,expression:"articles[activeIndex].content_source_url"}],staticClass:"wx-content__author",attrs:{type:"text",placeholder:"原创链接地址",maxlength:"100"},domProps:{value:t.articles[t.activeIndex].content_source_url},on:{input:function(e){e.target.composing||t.$set(t.articles[t.activeIndex],"content_source_url",e.target.value)}}})]),t._v(" "),i("div",{staticClass:"wx-msg-contet__editor"},[i("cms-editor",{attrs:{config:t.options},on:{ready:t.getEditor},model:{value:t.articles[t.activeIndex].content,callback:function(e){t.$set(t.articles[t.activeIndex],"content",e)},expression:"articles[activeIndex].content"}})],1)]),t._v(" "),i("div",{staticClass:"wx-msg-media"},[i("h3",{staticClass:"wx-msg__header"},[t._v("多媒体")]),t._v(" "),i("ul",{staticClass:"wx-msg-media__items"},[i("li",{staticClass:"wx-msg-media__item wx-msg-media__item--bn"},[i("wx-picture-zone",{attrs:{index:t.activeIndex},on:{change:t.getContentImg}},[t._v("图片")])],1)]),t._v(" "),i("h3",{staticClass:"wx-msg__header"},[t._v("封面")]),t._v(" "),i("ul",{staticClass:"wx-msg-media__items"},[i("wx-picture-zone",{staticClass:"wx-msg-media__item wx-msg-media__item--bn",attrs:{index:t.activeIndex},on:{change:t.getCover}},[t._v("新增封面")])],1)])]),t._v(" "),i("div",{staticClass:"wx-msg__footer"},["update"==t.$route.query.type?i("el-button",{attrs:{type:"primary"},on:{click:t.updateArticles}},[t._v("修改并保存")]):i("el-button",{attrs:{type:"primary"},on:{click:t.saveArticles}},[t._v("保存")])],1)],1)},staticRenderFns:[]};var o=i("C7Lr")(n,l,!1,function(t){i("x1vX")},null,null);e.default=o.exports},x1vX:function(t,e){}});
//# sourceMappingURL=188.128ff2e79714148670b1.js.map
webpackJsonp([100],{Fa7L:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a("aA9S"),o=a.n(r),s=a("5HJ5"),l=a("x1ym"),i=a("QkjJ"),n=a("CPCM"),c={mixins:[s.a],components:{categoryCascader:n.a},data:function(){return{clientType:[{name:"PC端",value:"pc"},{name:"WAP端",value:"wap"},{name:"小程序",value:"miniprogram"}],queryParams:{page:1,size:10,clientType:"pc"},formLoading:!1,visible:!1,formData:{clientType:"pc",proCategoryId:"",alias:"",logoResId:"",sortNum:10},rules:{clientType:[l.a.required()],proCategoryId:[l.a.required("必须选择一个分类","change")],alias:[l.a.required(),l.a.len(1,30)],logoResId:[l.a.required("必须选择一个图标","change")],sortNum:[l.a.required(),l.a.number()]}}},methods:{addIndexNav:function(){this.visible=!0},editForm:function(e){this.formData=o()({},e),this.visible=!0},saveForm:function(){this.submitForm(i.E)},updateForm:function(){this.submitForm(i.G)},submitForm:function(e){var t=this;this.$refs.form.validate(function(a){a&&(t.formLoading=!0,e(t.formData).then(function(e){t.formLoading=!1,200===e.code?(t.$successMessage("操作成功"),t.getTableData(i.D,t.queryParams),t.close()):t.$errorMessage(e.message)}))})},close:function(){var e=this;this.visible=!1,setTimeout(function(){e.formData=o()({},{clientType:e.queryParams.clientType,proCategoryId:"",alias:"",logoResId:"",sortNum:10}),e.$refs.form.clearValidate()},5)},getTypeName:function(e){return this.clientType.filter(function(t){return t.value===e})[0].name},tabClick:function(){this.formData.clientType=this.queryParams.clientType,this.query()},deleteData:function(e){this.deleteTableData(i.C,e)},deleteDatas:function(){this.deleteTableDatas(i.C,this.ids)},sortNum:function(e,t){var a=this,r=e.target.value;if(""===r)return!1;/^[1-9][0-9]{0,1}$/.test(r)?(e.target.className="el-input__inner",Object(i.F)({sorts:[{id:t,sortNum:r}]}).then(function(e){200===e.code?a.$successMessage("修改成功"):a.$errorMessage("修改失败")})):(e.target.className="cms-error el-input__inner",this.$cmsMessage({message:"只能输入1-99的正整数",type:"error",timer:"1000",fastClick:!1}))},getCategory:function(e){console.log(e)}},created:function(){this.getTableData(i.D,this.queryParams)}},m={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"cms-list-layout"},[a("el-tabs",{on:{"tab-click":e.tabClick},model:{value:e.queryParams.clientType,callback:function(t){e.$set(e.queryParams,"clientType",t)},expression:"queryParams.clientType"}},e._l(e.clientType,function(e){return a("el-tab-pane",{key:e.name,attrs:{label:e.name,name:e.value}})}),1),e._v(" "),a("section",{staticClass:"cms-batch"},[a("cms-button",{attrs:{icon:"add",type:"success",size:"small"},on:{click:e.addIndexNav}},[e._v("新增")]),e._v(" "),a("cms-button",{attrs:{icon:"error",type:"error",size:"small"},on:{click:function(t){e.deleteDatas()}}},[e._v("批量删除")])],1),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"dataTable",staticClass:"brands-form",staticStyle:{width:"100%"},attrs:{data:e.tableData,stripe:""},on:{"selection-change":e.getCheckItems,"row-click":e.checkRows}},[a("el-table-column",{attrs:{type:"selection",width:"46",fixed:"left"}}),e._v(" "),a("el-table-column",{attrs:{prop:"id",label:"id",width:"60"}}),e._v(" "),a("el-table-column",{attrs:{prop:"alias",label:"分类名称","min-width":"200"},scopedSlots:e._u([{key:"default",fn:function(t){return a("div",{},[e._v(e._s(t.row.productCategory.cateName))])}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"alias",label:"别名","min-width":"150"}}),e._v(" "),"pc"!==e.queryParams.clientType?a("el-table-column",{attrs:{label:"图标","min-width":"180",prop:"logo"},scopedSlots:e._u([{key:"default",fn:function(t){return a("div",{staticClass:"table-img"},[t.row.logoResource?a("img",{attrs:{src:e.$cms.filterUrl(t.row.logoResource.url),alt:"mockimg"}}):e._e()])}}])}):e._e(),e._v(" "),a("el-table-column",{attrs:{label:"排序",prop:"sortNum","min-width":"150"},scopedSlots:e._u([{key:"default",fn:function(t){return a("div",{},[a("el-input",{nativeOn:{keyup:function(a){if(!("button"in a)&&e._k(a.keyCode,"enter",13,a.key,"Enter"))return null;a.stopPropagation(),e.sortNum(a,t.row.id)}},model:{value:t.row.sortNum,callback:function(a){e.$set(t.row,"sortNum",a)},expression:"scope.row.sortNum"}})],1)}}])}),e._v(" "),a("el-table-column",{attrs:{label:"操作",width:"175",fixed:"right",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return a("div",{},[a("cms-button",{directives:[{name:"prem",rawName:"v-prem",value:"/brand/edit",expression:"'/brand/edit'"}],attrs:{icon:"edit",size:"small",type:"info"},on:{click:function(a){a.stopPropagation(),e.editForm(t.row)}}},[e._v("编辑")]),e._v(" "),a("cms-button",{directives:[{name:"prem",rawName:"v-prem",value:"/brand/delete",expression:"'/brand/delete'"}],attrs:{icon:"error",size:"small",type:"info"},on:{click:function(a){e.deleteData(t.row.id)}}},[e._v("删除")])],1)}}])})],1),e._v(" "),a("cms-pagination",{attrs:{total:e.total},on:{change:e.getPage}}),e._v(" "),a("el-dialog",{attrs:{title:"导航设置",visible:e.visible,"close-on-click-modal":!1,"before-close":e.close}},[a("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.formLoading,expression:"formLoading"}],ref:"form",attrs:{model:e.formData,rules:e.rules,"label-width":"110px","element-loading-text":"正在提交..."}},[a("el-form-item",{attrs:{label:"终端:",prop:"clientType"}},[e._v(e._s(e.getTypeName(e.formData.clientType)))]),e._v(" "),a("el-form-item",{attrs:{label:"选择分类:",prop:"proCategoryId"}},[a("category-cascader",{attrs:{multiple:!1},on:{input:e.getCategory},model:{value:e.formData.proCategoryId,callback:function(t){e.$set(e.formData,"proCategoryId",t)},expression:"formData.proCategoryId"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"别名:",prop:"alias"}},[a("el-input",{attrs:{placeholder:""},model:{value:e.formData.alias,callback:function(t){e.$set(e.formData,"alias",t)},expression:"formData.alias"}}),e._v(" "),a("span",{staticClass:"gray"},[e._v("商城默认优先显示别名数据")])],1),e._v(" "),a("el-form-item",{attrs:{label:"排序值:",prop:"sortNum"}},[a("el-input",{attrs:{maxlength:"3"},model:{value:e.formData.sortNum,callback:function(t){e.$set(e.formData,"sortNum",t)},expression:"formData.sortNum"}})],1),e._v(" "),"pc"!==e.formData.clientType?a("el-form-item",{attrs:{label:"图标:",prop:"logoResId"}},[e.visible?a("cms-picture-zone",{attrs:{data:e.formData.logoResource},model:{value:e.formData.logoResId,callback:function(t){e.$set(e.formData,"logoResId",t)},expression:"formData.logoResId"}},[a("el-button",{attrs:{size:"mini",type:"primary"}},[e._v("上传图标")]),e._v(" "),a("span",{staticClass:"gray"},[e._v("建议上传85*85尺寸正方形图片")])],1):e._e()],1):e._e(),e._v(" "),a("div",{staticClass:"cms-form-footer"},[e.formData.id?a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.updateForm}},[e._v("修改")]):a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.saveForm}},[e._v("添加")]),e._v(" "),a("el-button",{attrs:{size:"small"},on:{click:e.close}},[e._v("取消")])],1)],1)],1)],1)},staticRenderFns:[]};var u=a("C7Lr")(c,m,!1,function(e){a("WNGN")},null,null);t.default=u.exports},WNGN:function(e,t){}});
//# sourceMappingURL=100.f96b1960d4260880cb51.js.map
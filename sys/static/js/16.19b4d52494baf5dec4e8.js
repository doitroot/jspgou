webpackJsonp([16],{MCJ8:function(t,e){},RY9C:function(t,e){},Sy33:function(t,e){},WxRM:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=s("aA9S"),a=s.n(i),l=s("QkjJ"),r=s("AsmT"),n=s("5HJ5"),c={mixins:[n.a],data:function(){return{multiple:!1,dialogVisible:!1,checkItems:[],selectIndex:"",queryParams:{storeName:"",storeGradeId:"",storeType:"",categoryId:"",startTime:"",endTime:"",enabled:!0,storeUsername:"",page:1,size:10,status:1}}},methods:{checkRows:function(t){this.multiple?this.$refs.dataTable.toggleRowSelection(t):(this.selectIndex=this.tableData.indexOf(t),this.checkItems=[t])},determine:function(){this.$emit("get",this.multiple?this.checkItems:this.checkItems[0]),this.selectIndex=""},close:function(){this.selectIndex="",this.$emit("close",!0)}},created:function(){this.getTableData(r.o,this.queryParams)}},o={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("section",{staticClass:"cms-list-query"},[s("div",{staticClass:"query-group"},[s("label",[t._v("店铺名称")]),t._v(" "),s("el-input",{nativeOn:{keyup:function(e){return"button"in e||!t._k(e.keyCode,"enter",13,e.key,"Enter")?t.query(e):null}},model:{value:t.queryParams.storeName,callback:function(e){t.$set(t.queryParams,"storeName",e)},expression:"queryParams.storeName"}})],1),t._v(" "),s("div",{staticClass:"query-group"},[s("label",[t._v("商家账号")]),t._v(" "),s("el-input",{nativeOn:{keyup:function(e){return"button"in e||!t._k(e.keyCode,"enter",13,e.key,"Enter")?t.query(e):null}},model:{value:t.queryParams.storeUsername,callback:function(e){t.$set(t.queryParams,"storeUsername",e)},expression:"queryParams.storeUsername"}})],1),t._v(" "),s("div",{staticClass:"query-group"},[s("cms-button",{attrs:{size:"small",colorPicker:!0},on:{click:t.query}},[t._v("查询")])],1)]),t._v(" "),s("el-table",{ref:"dataTable",staticStyle:{cursor:"pointer"},attrs:{data:t.tableData,"max-height":"500"},on:{"selection-change":t.getCheckItems,"row-click":t.checkRows}},[t.multiple?s("el-table-column",{attrs:{width:"60",type:"selection"}}):s("el-table-column",{attrs:{width:"60",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return s("div",{},[s("el-radio",{attrs:{label:e.$index},model:{value:t.selectIndex,callback:function(e){t.selectIndex=e},expression:"selectIndex"}},[t._v(" ")])],1)}}])}),t._v(" "),s("el-table-column",{attrs:{prop:"storeName",label:"店铺名称","min-width":"160"}})],1),t._v(" "),s("cms-pagination",{attrs:{total:t.total},on:{change:t.getPage}}),t._v(" "),s("div",{staticClass:"dialog-footer",staticStyle:{"text-align":"right"},attrs:{slot:"footer"},slot:"footer"},[s("el-button",{attrs:{type:"primary",size:"mini"},on:{click:t.determine}},[t._v("确 定")]),t._v(" "),s("el-button",{attrs:{type:"info",size:"mini"},on:{click:t.close}},[t._v("取 消")])],1)],1)},staticRenderFns:[]};var d=s("C7Lr")(c,o,!1,function(t){s("u8qG")},null,null).exports,u=s("NyU8"),m={mixins:[n.a],data:function(){return{multiple:!1,dialogVisible:!1,checkItems:[],selectIndex:"",queryParams:{page:1,size:10,status:3,name:"",categoryId:"",itemCode:"",storeId:"",sellGoodsSale:"",storeCategoryId:"",storeName:"",itemNumber:""}}},methods:{showProductImg:function(t){if(t.length>0){var e=t.filter(function(t){return!0===t.isCover});return e[0].imageResouce?this.$cms.filterUrl(e[0].imageResouce.url):"/static/img/error.png"}return"/static/img/error.png"},checkRows:function(t){this.multiple?this.$refs.dataTable.toggleRowSelection(t):(this.selectIndex=this.tableData.indexOf(t),this.checkItems=[t])},determine:function(){this.$emit("get",this.multiple?this.checkItems:this.checkItems[0]),this.selectIndex=""},close:function(){this.selectIndex="",this.$emit("close",!0)}},created:function(){this.getTableData(u.i,this.queryParams)}},h={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("section",{staticClass:"cms-list-query"},[s("div",{staticClass:"query-group"},[s("label",[t._v("商品名称")]),t._v(" "),s("el-input",{nativeOn:{keyup:function(e){return"button"in e||!t._k(e.keyCode,"enter",13,e.key,"Enter")?t.query(e):null}},model:{value:t.queryParams.name,callback:function(e){t.$set(t.queryParams,"name",e)},expression:"queryParams.name"}})],1),t._v(" "),s("div",{staticClass:"query-group"},[s("cms-button",{attrs:{size:"small",colorPicker:!0},on:{click:t.query}},[t._v("查询")])],1)]),t._v(" "),s("el-table",{ref:"dataTable",staticStyle:{cursor:"pointer"},attrs:{data:t.tableData,"max-height":"450"},on:{"selection-change":t.getCheckItems,"row-click":t.checkRows}},[t.multiple?s("el-table-column",{attrs:{width:"60",type:"selection"}}):s("el-table-column",{attrs:{width:"60",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return s("div",{},[s("el-radio",{attrs:{label:e.$index},model:{value:t.selectIndex,callback:function(e){t.selectIndex=e},expression:"selectIndex"}},[t._v(" ")])],1)}}])}),t._v(" "),s("el-table-column",{attrs:{prop:"name",label:"商品名称","min-width":"240"}}),t._v(" "),s("el-table-column",{attrs:{prop:"store.storeName",label:"店铺名称","min-width":"140"}})],1),t._v(" "),s("cms-pagination",{attrs:{total:t.total},on:{change:t.getPage}}),t._v(" "),s("div",{staticClass:"dialog-footer",staticStyle:{"text-align":"right"},attrs:{slot:"footer"},slot:"footer"},[s("el-button",{attrs:{type:"primary",size:"mini"},on:{click:t.determine}},[t._v("确 定")]),t._v(" "),s("el-button",{attrs:{type:"info",size:"mini"},on:{click:t.close}},[t._v("取 消")])],1)],1)},staticRenderFns:[]};var v=s("C7Lr")(m,h,!1,function(t){s("Sy33")},null,null).exports,p=s("Sy1Y"),f={mixins:[n.a],data:function(){return{multiple:!1,dialogVisible:!1,checkItems:[],selectIndex:"",queryParams:{cateId:"",title:"",size:10,page:1}}},methods:{checkRows:function(t){this.multiple?this.$refs.dataTable.toggleRowSelection(t):(this.selectIndex=this.tableData.indexOf(t),this.checkItems=[t])},determine:function(){this.$emit("get",this.multiple?this.checkItems:this.checkItems[0]),this.selectIndex=""},close:function(){this.selectIndex="",this.$emit("close",!0)}},created:function(){this.getTableData(p.f,this.queryParams)}},g={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("section",{staticClass:"cms-list-query"},[s("div",{staticClass:"query-group"},[s("label",[t._v("文章标题")]),t._v(" "),s("el-input",{nativeOn:{keyup:function(e){return"button"in e||!t._k(e.keyCode,"enter",13,e.key,"Enter")?t.query(e):null}},model:{value:t.queryParams.title,callback:function(e){t.$set(t.queryParams,"title",e)},expression:"queryParams.title"}})],1),t._v(" "),s("div",{staticClass:"query-group"},[s("cms-button",{attrs:{size:"small",colorPicker:!0},on:{click:t.query}},[t._v("查询")])],1)]),t._v(" "),s("el-table",{ref:"dataTable",staticStyle:{cursor:"pointer"},attrs:{data:t.tableData,"max-height":"500"},on:{"selection-change":t.getCheckItems,"row-click":t.checkRows}},[t.multiple?s("el-table-column",{attrs:{width:"60",type:"selection"}}):s("el-table-column",{attrs:{width:"60",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return s("div",{},[s("el-radio",{attrs:{label:e.$index},model:{value:t.selectIndex,callback:function(e){t.selectIndex=e},expression:"selectIndex"}},[t._v(" ")])],1)}}])}),t._v(" "),s("el-table-column",{attrs:{prop:"title",label:"文章标题","min-width":"160"}}),t._v(" "),s("el-table-column",{attrs:{prop:"category.name",label:"文章分类","min-width":"160"}})],1),t._v(" "),s("cms-pagination",{attrs:{total:t.total},on:{change:t.getPage}}),t._v(" "),s("div",{staticClass:"dialog-footer",staticStyle:{"text-align":"right"},attrs:{slot:"footer"},slot:"footer"},[s("el-button",{attrs:{type:"primary",size:"mini"},on:{click:t.determine}},[t._v("确 定")]),t._v(" "),s("el-button",{attrs:{type:"info",size:"mini"},on:{click:t.close}},[t._v("取 消")])],1)],1)},staticRenderFns:[]};var _=s("C7Lr")(f,g,!1,function(t){s("RY9C")},null,null).exports,b=s("GBzI"),y={mixins:[n.a],data:function(){return{multiple:!1,dialogVisible:!1,checkItems:[],selectIndex:"",parentIds:[],options:[],props:{value:"id",label:"cateName",children:"childs",disabled:"isAuth"}}},methods:{getMenuTree:function(){var t=this;Object(b.k)().then(function(e){t.options=e.data})},checkRows:function(t){var e={id:t[t.length-1],cateName:this.$refs.cascader.currentLabels[this.$refs.cascader.currentLabels.length-1]};this.checkItems=e},determine:function(){this.$emit("get",this.checkItems),this.parentIds=[]},close:function(){this.parentIds=[],this.$emit("close",!0)}},created:function(){this.getMenuTree()}},k={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("el-form",{ref:"form",attrs:{"label-width":"84px"}},[s("el-form-item",{attrs:{label:"选择分类"}},[s("el-cascader",{ref:"cascader",attrs:{options:t.options,props:t.props,"change-on-select":!0,"show-all-levels":!1},on:{change:t.checkRows},model:{value:t.parentIds,callback:function(e){t.parentIds=e},expression:"parentIds"}})],1),t._v(" "),s("el-form-item",{attrs:{label:" "}},[s("el-button",{attrs:{type:"primary",size:"mini"},on:{click:t.determine}},[t._v("确 定")]),t._v(" "),s("el-button",{attrs:{type:"info",size:"mini"},on:{click:t.close}},[t._v("取 消")])],1)],1)],1)},staticRenderFns:[]};var x={components:{storeList:d,productList:v,articleList:_,categoryList:s("C7Lr")(y,k,!1,function(t){s("vppc")},null,null).exports},data:function(){return{active:"1",visible:!1,index:"",linkUrl:""}},methods:{showDialog:function(t){this.index=t,this.visible=!0},close:function(){this.visible=!1,this.linkUrl=""},closeDialog:function(t){this.$emit("change",t,this.index),this.visible=!1},getStoreData:function(t){var e={type:2,id:t.id,storeName:t.storeName};this.closeDialog(e)},getProductData:function(t){var e={type:1,id:t.id,name:t.name};this.closeDialog(e)},getArticleList:function(t){var e={type:3,id:t.id,title:t.title};this.closeDialog(e)},getCategoryList:function(t){var e={type:4,id:t.id,cateName:t.cateName};this.closeDialog(e)},getUrlData:function(){if(/(http|https):\/\/[\w\-_]+(\.[\w\-_]+)+([\w\-\.,@?^=%&amp;:/~\+#]*[\w\-\@?^=%&amp;/~\+#])?/.test(this.linkUrl)){var t={type:5,linkUrl:this.linkUrl};this.closeDialog(t)}else this.$errorMessage("链接地址格式不正确")}}},I={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[t._t("default"),t._v(" "),s("el-dialog",{attrs:{title:"选择链接",width:"80%",visible:t.visible,"before-close":t.close}},[s("div",{staticStyle:{padding:"10px 15px"}},[s("el-tabs",{model:{value:t.active,callback:function(e){t.active=e},expression:"active"}},[s("el-tab-pane",{attrs:{label:"商品",name:"1"}},[s("product-list",{on:{get:t.getProductData,close:t.close}})],1),t._v(" "),s("el-tab-pane",{attrs:{label:"店铺",name:"2",lazy:""}},[s("store-list",{on:{get:t.getStoreData,close:t.close}})],1),t._v(" "),s("el-tab-pane",{attrs:{label:"文章",name:"3",lazy:""}},[s("article-list",{on:{get:t.getArticleList,close:t.close}})],1),t._v(" "),s("el-tab-pane",{attrs:{label:"商品分类",name:"4",lazy:""}},[s("category-list",{on:{get:t.getCategoryList,close:t.close}})],1),t._v(" "),s("el-tab-pane",{attrs:{label:"固定地址",name:"5",lazy:""}},[s("div",[s("el-form",{ref:"forms",attrs:{"label-width":"85px"}},[s("el-form-item",{attrs:{label:"链接地址",prop:"linkurl"}},[s("el-input",{attrs:{maxlength:"100",type:"url"},model:{value:t.linkUrl,callback:function(e){t.linkUrl=e},expression:"linkUrl"}}),t._v(" "),s("span",{staticClass:"gray"},[t._v("请输入正确的url地址，必须以https://或http://开头")])],1),t._v(" "),s("el-form-item",{attrs:{label:" "}},[s("el-button",{attrs:{type:"primary",size:"mini"},on:{click:t.getUrlData}},[t._v("确 定")]),t._v(" "),s("el-button",{attrs:{type:"info",size:"mini"},on:{click:t.close}},[t._v("取 消")])],1)],1)],1)])],1)],1)])],2)},staticRenderFns:[]};var $=s("C7Lr")(x,I,!1,function(t){s("qdpf")},null,null).exports,C={positionName:"",positionCode:"",page:1,size:10},w={mixins:[s("lcoF").a],components:{dataDialog:$},data:function(){return{formData:a()({},C),advertList:[]}},filters:{filterType:function(t,e){var s="";switch(t){case 1:s="[商品] "+e.product.name;break;case 2:s="[店铺] "+e.store.storeName;break;case 3:s="[文章] "+e.article.title;break;case 4:s="[商品分类] "+e.productCategory.cateName;break;case 5:s="[URL] "+e.linkUrl}return s}},methods:{addForm:function(){var t={title:"广告",adPositionId:this.id,isTarget:!0,isShow:!0,isEdit:!0,productId:"",articleId:"",storeId:"",productCateId:"",linkUrl:"",pictureId:"",resourcesSpaceData:{}};this.advertList.push(t)},cancelForm:function(t,e){t.isEdit=!1},submitForm:function(t,e){var s=this;""===t.pictureId?this.$errorMessage("必须上传一个广告图片"):""===t.title?this.$errorMessage("广告标题不能为空"):t.id?Object(l.o)(t).then(function(t){200===t.code?(s.advertList.splice(e,1,t.data),s.$set(s.advertList[e],"isEdit",!1),s.$successMessage("修改成功")):s.$errorMessage(t.message)}):Object(l.n)(t).then(function(t){200===t.code?(s.getAdvertList(s.id),s.$successMessage("保存成功")):s.$errorMessage(t.message)})},showDataDialog:function(t){this.$refs.dataDialog.showDialog(t)},getData:function(t,e){switch(t.type){case 1:this.clearOldData(e),this.$set(this.advertList[e],"linkType",t.type),this.$set(this.advertList[e],"product",t),this.$set(this.advertList[e],"productId",t.id);break;case 2:this.clearOldData(e),this.$set(this.advertList[e],"linkType",t.type),this.$set(this.advertList[e],"store",t),this.$set(this.advertList[e],"storeId",t.id);break;case 3:this.clearOldData(e),this.$set(this.advertList[e],"linkType",t.type),this.$set(this.advertList[e],"article",t),this.$set(this.advertList[e],"articleId",t.id);break;case 4:this.clearOldData(e),this.$set(this.advertList[e],"linkType",t.type),this.$set(this.advertList[e],"productCategory",t),this.$set(this.advertList[e],"productCateId",t.id);break;case 5:this.clearOldData(e),this.$set(this.advertList[e],"linkType",t.type),this.$set(this.advertList[e],"linkUrl",t.linkUrl);break;default:return null}},clearOldData:function(t){this.$set(this.advertList[t],"productId",""),this.$set(this.advertList[t],"articleId",""),this.$set(this.advertList[t],"storeId",""),this.$set(this.advertList[t],"store",""),this.$set(this.advertList[t],"productCateId",""),this.$set(this.advertList[t],"linkUrl","")},getImgUrl:function(t,e){this.$set(this.advertList[e],"resourcesSpaceData",t[0]),this.$set(this.advertList[e],"pictureId",t[0].id)},changeEdit:function(t){this.advertList[t].isEdit?this.submitForm(this.advertList[t],t):this.$set(this.advertList[t],"isEdit",!0)},deleteAdvert:function(t,e){var s=this;void 0===t?this.advertList.splice(e,1):Object(l.g)({ids:[t]}).then(function(t){200===t.code?(s.$successMessage("删除成功"),s.advertList.splice(e,1),s.getAdvertList(s.id)):s.$errorMessage("删除失败")})},getAdvertList:function(t){var e=this;Object(l.j)({id:t}).then(function(t){200===t.code&&(e.formData=t.data,e.advertList=t.data.sysAds,e.advertList.forEach(function(t,s){e.$set(e.advertList[s],"isEdit",!1)}),e.addForm())})}},created:function(){this.getAdvertList(this.id)}},L={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("cms-breadcrumb",{attrs:{to:"/advert/position/list",type:"list"}},[s("li",[t._v(t._s(t.$route.name)+"-"+t._s(t.$route.query.name))])]),t._v(" "),s("div",{staticClass:"cms-list-layout"},[s("cms-prompt",[s("li",[t._v("显示系统使用的广告版位")]),t._v(" "),s("li",[t._v(" 可对版位内的广告进行管理")])]),t._v(" "),s("el-row",{staticStyle:{"margin-top":"20px"},attrs:{gutter:25}},t._l(t.advertList,function(e,i){return s("el-col",{key:e.id,attrs:{span:12}},[s("div",{staticClass:"advert-item"},[e.isEdit?s("div",{staticClass:"isEdit"},[s("el-button",{staticClass:"advert-operate__btn",attrs:{type:"primary",size:"mini"},on:{click:function(s){t.submitForm(e,i)}}},[t._v("保存\n            ")]),t._v(" "),e.id?s("el-button",{staticClass:"advert-operate__btn",attrs:{type:"info",size:"mini"},on:{click:function(s){t.cancelForm(e,i)}}},[t._v("取消\n            ")]):t._e()],1):s("div",{staticClass:"advert-operate"},[s("span",{staticClass:"el-icon-edit-outline",on:{click:function(e){t.changeEdit(i)}}}),t._v(" "),s("span",{staticClass:"el-icon-close",on:{click:function(s){t.deleteAdvert(e.id,i)}}})]),t._v(" "),s("el-row",{attrs:{gutter:20}},[s("el-col",{attrs:{span:6}},[s("div",{staticClass:"advert-item__pic",staticStyle:{"margin-top":"10px"}},[s("cms-picture-zone",{attrs:{preview:!1,float:!1,index:i},on:{change:t.getImgUrl}},[s("div",{staticClass:"pic-view"},[e.resourcesSpaceData?s("img",{attrs:{src:t.$cms.filterUrl(e.resourcesSpaceData.url)}}):t._e(),t._v(" "),s("span",{directives:[{name:"show",rawName:"v-show",value:!e.resourcesSpaceData.url,expression:"!item.resourcesSpaceData.url"}],staticClass:"pic-icon"},[t._v("+")])])])],1)]),t._v(" "),s("el-col",{attrs:{span:18}},[s("div",{staticClass:"advert-item__info"},[s("div",{staticClass:"info-flex"},[s("label",{staticClass:"info__inner--label"},[t._v("广告标题")]),t._v(" "),s("div",{staticClass:"info__inner"},[e.isEdit?s("el-input",{staticStyle:{"min-width":"80px","max-width":"70%"},attrs:{maxlength:"20"},model:{value:e.title,callback:function(s){t.$set(e,"title",s)},expression:"item.title"}}):s("span",[t._v(t._s(e.title))])],1)]),t._v(" "),s("div",{staticClass:"info-flex"},[s("label",{staticClass:"info__inner--label"},[t._v("打开方式")]),t._v(" "),s("div",{staticClass:"info__inner"},[e.isEdit?s("el-radio-group",{model:{value:e.isTarget,callback:function(s){t.$set(e,"isTarget",s)},expression:"item.isTarget"}},[s("el-radio",{attrs:{label:!0}},[t._v("新窗口打开")]),t._v(" "),s("el-radio",{attrs:{label:!1}},[t._v("本页打开")])],1):s("span",[t._v(t._s(e.isTarget?"新窗口打开":"本页打开"))])],1)]),t._v(" "),s("div",{staticClass:"info-flex"},[s("label",{staticClass:"info__inner--label"},[t._v("是否显示")]),t._v(" "),s("div",{staticClass:"info__inner"},[e.isEdit?s("cms-switch",{model:{value:e.isShow,callback:function(s){t.$set(e,"isShow",s)},expression:"item.isShow"}}):s("span",[t._v(t._s(e.isShow?"显示":"不显示"))])],1)]),t._v(" "),s("div",{staticClass:"info-flex"},[s("label",{staticClass:"info__inner--label"},[t._v("跳转目标")]),t._v(" "),s("div",{staticClass:"info__inner"},[s("div",{staticClass:"info__inner--desc"},[t._v("\n                      "+t._s(t._f("filterType")(e.linkType,e))+"\n                    ")]),t._v(" "),e.isEdit?s("el-button",{staticClass:"fl set-btn",attrs:{type:"text",size:"mini"},on:{click:function(e){t.showDataDialog(i)}}},[t._v("设置")]):t._e()],1)])])])],1)],1)])}),1),t._v(" "),s("data-dialog",{ref:"dataDialog",on:{change:t.getData}})],1)],1)},staticRenderFns:[]};var D=s("C7Lr")(w,L,!1,function(t){s("MCJ8")},"data-v-0b554311",null);e.default=D.exports},qdpf:function(t,e){},u8qG:function(t,e){},vppc:function(t,e){}});
//# sourceMappingURL=16.19b4d52494baf5dec4e8.js.map
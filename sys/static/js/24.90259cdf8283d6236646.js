webpackJsonp([24],{B1Xs:function(a,t){a.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAACJklEQVRYR+2XP2gUQRTGv7d3WoggWKjYhNgp3i7IISioIFFEbSzEQgTBwk7ERvF2JsvMxsoEFf8hkjRRUBDBxsZClHCFBNm5IKiVoCJqKYh/cp+csMJJsu7l7jyRm3J4s++33/C9eU/Q4yU9zo8mgCh6u6Re+HABkAMQLO0A3A1TKR2CCOf7VhOAit0oiC0ETwFevR0ADxyEYByC3abi388FoGP3hOAtGwZn20mentVx8hzEOaOCKzkBkmnQu2lUabQTAMq6ZxBetGFwuQ/QV+D/VmA4ntlI1C8BKGe6h/hEerusXj+VxjUVIh0vzIY6Tu6RWFSY9fdEkcxbwLR1JyHYYUJ/qKMAyrqHAjij/GNZCui4to9kxSr/l1IdUeAngGBbnuJFYrorABDUSLmTBeFJ/QQpq7sCIOBdo4LzmVdg3VUC5T5AX4F/WwFSPgpYzePpNKYOHBbKuNW+adsFpCwD8LoVAAE2UWTShqUjbQMspCXTsSPJx1YFW7sOsP82C2tfuAkQ1bTZ1Da5TpHPf6USnh6prSyS70hUrfI3N/64AQCRTPlTZf7wFuRry0PrhijFlyPhulcpAEXe2NAfzr6C5AwhOzNs6CYBLPe+l/Zmveu/J9HWjUG4ylT8g1lTkIrdhIADJgy2z9kPhDYZ9EQeAFjTigsasSS+imBx1jmSTwsix6PQfzQnQGMziuixOLNhlq3Phu9XfJm6drT8rRX4nk/HPwDmfcMwmtIsbAAAAABJRU5ErkJggg=="},CK99:function(a,t){},EeUd:function(a,t){},uWgS:function(a,t){a.exports="data:image/png;base64,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"},xkXW:function(a,t,e){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=e("aA9S"),r=e.n(s),i=e("lcoF"),o=e("x1ym"),n=e("HNM5"),l=function(a){return n.a.post("/admin/platform/pay/update",a)},c={props:{data:{type:[String,Object],default:{}},status:{type:[String,Number],default:0}},watch:{status:{handler:function(a,t){this.formData=r()({},this.data)},immediate:!0,deep:!0}},data:function(){return{rules:{appSecret:[o.a.required()],paySecretKey:[o.a.required()],payAccount:[o.a.required()]},formData:{isAuthorization:"0",appId:"",appKey:"",isEnable:!0,reMark:""},baseUrl:window.location.protocol+window.location.host}},methods:{openBox:function(a){var t=this;this.$alert("请在新窗口中完成"+a,"系统提示",{confirmButtonText:"刷新授权结果",showClose:!1,callback:function(a){t.$emit("refreshData")}})},subData:function(a){var t=this;this.$refs.wechatForm.validate(function(e){e&&l({details:[a]}).then(function(a){200===a.code?t.$successMessage("保存成功"):t.$errorMessage("保存失败")})})},openPublic:function(a,t,e){this.openBox(e),window.open(a,t)}},created:function(){}},m={render:function(){var a=this,t=a.$createElement,e=a._self._c||t;return e("div",[2==a.formData.isAuthorization?e("div",[0===a.status?e("div",[e("h3",{staticClass:"cms-segmentation"},[a._v("第一步：添加支付授权目录")]),a._v(" "),a._m(0),a._v(" "),e("h3",{staticClass:"cms-segmentation"},[a._v("第二步：填写支付参数")])]):a._e(),a._v(" "),e("el-form",{ref:"wechatForm",staticStyle:{"margin-top":"20px"},attrs:{rules:a.rules,model:a.formData,"label-width":"210px"}},[e("el-form-item",{attrs:{label:"是否开启",prop:"isEnable"}},[e("cms-switch",{model:{value:a.formData.isEnable,callback:function(t){a.$set(a.formData,"isEnable",t)},expression:"formData.isEnable"}})],1),a._v(" "),e("el-form-item",{attrs:{label:(a.status?"小程序":"公众号")+"AppId"}},[e("span",[a._v(a._s(a.formData.appId))])]),a._v(" "),e("el-form-item",{attrs:{label:"商户号",prop:"payAccount"}},[e("el-input",{attrs:{maxlength:"100"},model:{value:a.formData.payAccount,callback:function(t){a.$set(a.formData,"payAccount",t)},expression:"formData.payAccount"}}),a._v(" "),e("div",{staticClass:"gray"},[a._v("填写"+a._s(a.status?"小程序":"公众号")+"绑定的的商户号")])],1),a._v(" "),e("el-form-item",{attrs:{label:"商户密钥",prop:"paySecretKey"}},[e("el-input",{attrs:{maxlength:"100"},model:{value:a.formData.paySecretKey,callback:function(t){a.$set(a.formData,"paySecretKey",t)},expression:"formData.paySecretKey"}}),a._v(" "),e("div",{staticClass:"gray"},[a._v("填写"+a._s(a.status?"小程序":"公众号")+"绑定的商户密钥")])],1)],1),a._v(" "),e("div",{staticClass:"cms-form-footer"},[e("cms-button",{directives:[{name:"color",rawName:"v-color"}],on:{click:function(t){a.subData(a.formData)}}},[a._v("保存")])],1)],1):e("div",[0==a.status?e("div",{staticClass:"t-authorize"},[1==a.formData.isAuthorization?e("div",{staticClass:"t-14"},[a._v("开启微信公众号支付，需要授权绑定已认证的微信公众号！")]):a._e(),a._v(" "),e("div",{staticClass:"cms-form-footer"},[1==a.formData.isAuthorization?e("cms-button",{directives:[{name:"color",rawName:"v-color"}],on:{click:function(t){a.openPublic("/#/wechatPublic/list","_blank","微信公众号授权")}}},[a._v("授权公众号")]):e("cms-button",{directives:[{name:"color",rawName:"v-color"}],on:{click:function(t){a.openPublic("/#/wxConfig","_blank","微信开放平台配置")}}},[a._v("配置微信开放平台")])],1)]):a._e(),a._v(" "),1==a.status?e("div",{staticClass:"t-authorize"},[1==a.formData.isAuthorization?e("div",{staticClass:"t-14"},[a._v("开启小程序支付，需要授权绑定已认证的小程序！")]):a._e(),a._v(" "),e("div",{staticClass:"cms-form-footer"},[1==a.formData.isAuthorization?e("cms-button",{directives:[{name:"color",rawName:"v-color"}],on:{click:function(t){a.openPublic("#/wechatPublic/list?activeStatus=2&type=list","_blank","微信小程序授权")}}},[a._v("授权小程序")]):e("cms-button",{directives:[{name:"color",rawName:"v-color"}],on:{click:function(t){a.openPublic("/#/wxConfig","_blank","微信开放平台配置")}}},[a._v("配置微信开放平台")])],1)]):a._e()])])},staticRenderFns:[function(){var a=this,t=a.$createElement,e=a._self._c||t;return e("div",{staticStyle:{"padding-left":"30px"}},[e("p",{staticClass:" t-14 notes"},[a._v("\n        请将商城站点域名，前往微信商户平台添加支付授权目录。如商城访问站点为http://www.jeecms.com或 "),e("br"),a._v("\n        http://jspgou.jeecms.com，商户平台需要将公众号支付及H5支付设置成如下所示。\n        "),e("a",{attrs:{href:"https://pay.weixin.qq.com/index.php/core/home/login?return_url=%2Findex.php",target:"_blank"}},[a._v("添加")])]),a._v(" "),e("p",{staticClass:" t-14 notes t-line"},[e("span",{staticClass:"t-18"},[a._v("• ")]),a._v(" 公众号支付授权目录：http://www.jeecms.com/ 或 http://jspgou.jeecms.com/")]),a._v(" "),e("p",{staticClass:" t-14 notes t-line"},[e("span",{staticClass:"t-18"},[a._v("• ")]),a._v(" H5支付授权域名：jeecms.com")])])}]};var p=e("C7Lr")(c,m,!1,function(a){e("CK99")},"data-v-b202f66c",null).exports,u={unionpay:{},wechat:{},miniprogram:{},alipay:{},balance:{}},f={name:"paymentList",mixins:[i.a],components:{wechatPay:p},data:function(){return{formData:r()({},u),activeName:"balance",weStatus:0,weActive:"0",weData:null,rules:{unionpayPassword:[o.a.required()],payAccount:[o.a.required()],paySecretKey:[o.a.required()],appId:[o.a.required()]}}},methods:{reshData:function(){this.getFormData(),this.editData()},editData:function(){switch(this.weStatus){case 0:this.weData=this.formData.wechat;break;case 1:this.weData=this.formData.miniprogram}},handleOpen:function(a){this.weStatus=parseInt(a.index),this.editData()},getFormData:function(){var a,t=this;n.a.get("/admin/platform/pay/list",{params:a}).then(function(a){if(200===a.code){for(var e=a.data,s=0;s<e.length;s++)switch(e[s].payTypeCode){case"alipay":t.$set(t.formData,"alipay",e[s]);break;case"balance":t.$set(t.formData,"balance",e[s]);break;case"wechat":t.$set(t.formData,"wechat",e[s]);break;case"miniprogram":t.$set(t.formData,"miniprogram",e[s]);break;case"unionpay":t.$set(t.formData,"unionpay",e[s]);break;default:return!1}t.editData()}else t.$errorMessage(a.message)}).catch(function(){t.loading=!1,t.$errorMessage("加载失败，请重试！")})},saveData:function(a){var t={details:[]};"alipay"===a?(t.details.push(this.formData.alipay),this.submitForm("alipayForm",t)):"balance"===a?(t.details.push(this.formData.balance),this.submitForm("balanceForm",t)):"weChat"===a?(t.details.push(this.formData.wechat),t.details.push(this.formData.miniprogram)):"unionpay"===a&&(t.details.push(this.formData.unionpay),this.submitForm("unionpayForm",t))},submitForm:function(a,t){var e=this;this.$refs[a].validate(function(a){if(!a)return!1;l(t).then(function(a){200===a.code?e.$successMessage("保存成功"):e.$errorMessage("保存失败")})})}},created:function(){this.getFormData()}},v={render:function(){var a=this,t=a.$createElement,s=a._self._c||t;return s("div",[s("div",{staticClass:"cms-form-layout"},[s("cms-prompt",{attrs:{collapse:"true"}},[s("li",[a._v("设置系统使用的支付方式")]),a._v(" "),s("li",[a._v("可开启/关闭支付方式")])]),a._v(" "),s("el-tabs",{model:{value:a.activeName,callback:function(t){a.activeName=t},expression:"activeName"}},[s("el-tab-pane",{attrs:{label:"账户余额",name:"balance"}},[s("el-form",{ref:"balanceForm",attrs:{model:a.formData,"label-width":"210px"}},[s("el-form-item",{attrs:{label:"是否开启"}},[s("cms-switch",{on:{change:function(t){a.saveData("balance")}},model:{value:a.formData.balance.isEnable,callback:function(t){a.$set(a.formData.balance,"isEnable",t)},expression:"formData.balance.isEnable"}})],1)],1)],1),a._v(" "),s("el-tab-pane",{attrs:{label:"支付宝",name:"alipay"}},[s("el-form",{ref:"alipayForm",attrs:{rules:a.rules,model:a.formData.alipay,"label-width":"210px"}},[s("el-form-item",{attrs:{label:"是否开启"}},[s("cms-switch",{model:{value:a.formData.alipay.isEnable,callback:function(t){a.$set(a.formData.alipay,"isEnable",t)},expression:"formData.alipay.isEnable"}})],1),a._v(" "),s("el-form-item",{attrs:{label:"应用Id",prop:"appId"}},[s("el-input",{ref:"first",attrs:{maxlength:"30",autofocus:!0},model:{value:a.formData.alipay.appId,callback:function(t){a.$set(a.formData.alipay,"appId",t)},expression:"formData.alipay.appId"}})],1),a._v(" "),s("el-form-item",{attrs:{label:"应用私钥",prop:"paySecretKey"}},[s("el-input",{attrs:{maxlength:"1700",type:"textarea",rows:8},model:{value:a.formData.alipay.paySecretKey,callback:function(t){a.$set(a.formData.alipay,"paySecretKey",t)},expression:"formData.alipay.paySecretKey"}}),a._v(" "),s("div",{staticClass:"gray"},[a._v("点击获取\n              "),s("a",{attrs:{href:"https://b.alipay.com/order/pidKey.htm",target:"_blank"}},[a._v("PID和Key")])])],1),a._v(" "),s("el-form-item",{attrs:{label:"应用公钥",prop:"paySecretKey"}},[s("el-input",{attrs:{maxlength:"1700",type:"textarea",rows:8},model:{value:a.formData.alipay.paySecretKey,callback:function(t){a.$set(a.formData.alipay,"paySecretKey",t)},expression:"formData.alipay.paySecretKey"}})],1)],1),a._v(" "),s("div",{staticClass:"cms-form-footer"},[s("cms-button",{directives:[{name:"color",rawName:"v-color"}],on:{click:function(t){a.saveData("alipay")}}},[a._v("保存")])],1)],1),a._v(" "),s("el-tab-pane",{attrs:{label:"微信",name:"weChat"}},[s("el-tabs",{staticClass:"we-menu",attrs:{"tab-position":"left"},on:{"tab-click":a.handleOpen},model:{value:a.weActive,callback:function(t){a.weActive=t},expression:"weActive"}},[s("el-tab-pane",{attrs:{name:"0"}},[s("div",{staticClass:"we-menu-name",attrs:{slot:"label"},slot:"label"},[s("el-popover",{attrs:{placement:"right-start",width:"340",transition:"fade-in-linear","visible-arrow":!1,trigger:"hover"}},[s("span",[a._v("适用于微信扫码支付、公众号支付、H5支付")]),a._v(" "),s("img",{attrs:{slot:"reference",src:e("B1Xs"),alt:""},slot:"reference"})]),a._v(" "),s("p",{staticClass:"we-menu-tit"},[a._v("微信公众号")])],1),a._v(" "),a.weData?s("div",{staticClass:"we-layout"},[s("wechat-pay",{attrs:{status:a.weStatus,data:a.weData},on:{refreshData:a.reshData}})],1):a._e()]),a._v(" "),s("el-tab-pane",{attrs:{name:"1"}},[s("div",{staticClass:"we-menu-name",attrs:{slot:"label"},slot:"label"},[s("el-popover",{attrs:{placement:"right-start",width:"220",transition:"fade-in-linear","visible-arrow":!1,trigger:"hover"}},[s("span",[a._v("适用于微信小程序支付")]),a._v(" "),s("img",{attrs:{slot:"reference",src:e("uWgS"),alt:""},slot:"reference"})]),a._v(" "),s("p",{staticClass:"we-menu-tit"},[a._v("小程序")])],1),a._v(" "),a.weData?s("div",{staticClass:"we-layout"},[s("wechat-pay",{attrs:{status:a.weStatus,data:a.weData},on:{refreshData:a.reshData}})],1):a._e()])],1)],1)],1)],1)])},staticRenderFns:[]};var d=e("C7Lr")(f,v,!1,function(a){e("EeUd")},null,null);t.default=d.exports}});
//# sourceMappingURL=24.90259cdf8283d6236646.js.map
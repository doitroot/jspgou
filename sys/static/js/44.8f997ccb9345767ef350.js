webpackJsonp([44],{"87FE":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a("aA9S"),s=a.n(r),o=a("x1ym"),l=a("lcoF"),i=a("fz7a"),n=a("sRls"),m=a("AsmT"),c={mixins:[a("5HJ5").a],name:"cmsArticleCategory",props:{value:{},multiple:{type:Boolean,default:!0},labelName:{type:String,default:"name"},labelData:{}},data:function(){return{dialogVisible:!1,checkItems:[],selectIndex:"",queryParams:{storeName:"",storeGradeId:"",storeType:"",categoryId:"",startTime:"",endTime:"",enabled:"",storeUsername:"",page:1,size:10,status:1},checkedNames:"",checkedNamesTwo:""}},watch:{labelData:{handler:function(){var e=this;if(this.multiple){var t=this.labelData.map(function(t){return t[e.labelName]}).toString();this.checkedNames=t}else{var a=this.labelData[this.labelName];this.checkedNames=a}}}},methods:{initData:function(){this.dialogVisible=!0,this.getTableData(m.o,this.queryParams)},checkRows:function(e){this.multiple?this.$refs.dataTable.toggleRowSelection(e):(this.selectIndex=this.tableData.indexOf(e),this.checkItems=[e])},determine:function(){var e=this;this.$emit("get",this.multiple?this.checkItems:this.checkItems[0]),this.$emit("update:labelData",this.multiple?this.checkItems:this.checkItems[0]),this.$emit("input",this.checkItems.map(function(e){return e.id})),this.checkedNames=this.checkItems.map(function(t){return t[e.labelName]}).toString(),this.checkedNamesTwo=this.checkItems.map(function(t){return t[e.labelName]}).toString(),this.close()},close:function(e){this.checkItems=[],this.selectIndex="",this.$refs.dataTable.clearSelection(),this.dialogVisible=!1}}},u={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-input",{staticStyle:{width:"380px",cursor:"pointer"},attrs:{readonly:!0},model:{value:e.checkedNamesTwo,callback:function(t){e.checkedNamesTwo=t},expression:"checkedNamesTwo"}},[a("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:e.initData},slot:"append"})],1),e._v(" "),a("el-dialog",{attrs:{title:"商家选择",visible:e.dialogVisible,width:"900px","before-close":e.close}},[a("div",{staticClass:"cms-dialog__body"},[a("section",{staticClass:"cms-list-query"},[a("div",{staticClass:"query-group"},[a("label",[e._v("店铺名称")]),e._v(" "),a("el-input",{nativeOn:{keyup:function(t){return"button"in t||!e._k(t.keyCode,"enter",13,t.key,"Enter")?e.query(t):null}},model:{value:e.queryParams.storeName,callback:function(t){e.$set(e.queryParams,"storeName",t)},expression:"queryParams.storeName"}})],1),e._v(" "),a("div",{staticClass:"query-group"},[a("label",[e._v("商家账号")]),e._v(" "),a("el-input",{nativeOn:{keyup:function(t){return"button"in t||!e._k(t.keyCode,"enter",13,t.key,"Enter")?e.query(t):null}},model:{value:e.queryParams.storeUsername,callback:function(t){e.$set(e.queryParams,"storeUsername",t)},expression:"queryParams.storeUsername"}})],1),e._v(" "),a("div",{staticClass:"query-group"},[a("cms-button",{staticStyle:{"margin-left":"50px"},attrs:{size:"small",colorPicker:!0},on:{click:e.query}},[e._v("查询")])],1)]),e._v(" "),a("el-table",{ref:"dataTable",staticStyle:{cursor:"pointer"},attrs:{data:e.tableData,"max-height":"500"},on:{"selection-change":e.getCheckItems,"row-click":e.checkRows}},[e.multiple?a("el-table-column",{attrs:{width:"60",type:"selection"}}):a("el-table-column",{attrs:{width:"60",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return a("div",{},[a("el-radio",{attrs:{label:t.$index},model:{value:e.selectIndex,callback:function(t){e.selectIndex=t},expression:"selectIndex"}},[e._v(" ")])],1)}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"id",label:"id",width:"60"}}),e._v(" "),a("el-table-column",{attrs:{prop:"storeName",label:"店铺名称","min-width":"160"}}),e._v(" "),a("el-table-column",{attrs:{prop:"storeUsername",label:"商家账号","min-width":"160"}}),e._v(" "),a("el-table-column",{attrs:{prop:"storeType",label:"店铺类型","min-width":"90"},scopedSlots:e._u([{key:"default",fn:function(t){return a("div",{},[1===t.row.storeType?a("span",{staticClass:"error"},[e._v("个人店铺")]):2===t.row.storeType?a("span",{staticClass:"success"},[e._v("企业店铺")]):e._e()])}}])})],1),e._v(" "),a("cms-pagination",{attrs:{total:e.total},on:{change:e.getPage}})],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("cms-button",{attrs:{type:"primary"},on:{click:e.determine}},[e._v("确 定")]),e._v(" "),a("cms-button",{attrs:{type:"info"},on:{click:e.close}},[e._v("取 消")])],1)])],1)},staticRenderFns:[]};var d=a("C7Lr")(c,u,!1,function(e){a("yQJf")},null,null).exports,f=a("s9+M"),p=a("FvUg"),h={title:"",content:"",mesType:1,recTargetType:1,memeberGroupId:"",storeGroupId:"",memeberId:[],storeId:[]},b={name:"mailSave",mixins:[l.a],data:function(){return{memberLevelList:[],storeLevelList:[],formData:s()({},h),rules:{mesType:[o.a.required()],recTargetType:[o.a.required("请选择发送对象","change")],title:[o.a.required()],content:[o.a.required(),o.a.len(1,250)],memeberGroupId:[o.a.required()]}}},components:{cmsMember:n.a,cmsShops:d},methods:{save:function(e){2===this.formData.recTargetType&&""===this.formData.memeberGroupId?this.$errorMessage("请选择会员等级"):3===this.formData.recTargetType&&""===this.formData.storeGroupId?this.$errorMessage("请选择商家等级"):4===this.formData.recTargetType&&this.formData.memeberId.length<1?this.$errorMessage("请选择指定会员"):5===this.formData.recTargetType&&this.formData.storeId<1?this.$errorMessage("请选择指定商家"):(this.setParams(this.formData.recTargetType),this.saveForm(i.c,this.formData,e,"/mail/list","list"))},setParams:function(e){switch(e){case 1:this.formData.memeberGroupId="",this.formData.storeGroupId="",this.formData.memeberId=[],this.formData.storeId=[];break;case 2:this.formData.storeGroupId="",this.formData.memeberId=[],this.formData.storeId=[];break;case 3:this.formData.memeberGroupId="",this.formData.memeberId=[],this.formData.storeId=[];break;case 4:this.formData.memeberGroupId="",this.formData.storeGroupId="",this.formData.storeId=[];break;case 5:this.formData.memeberGroupId="",this.formData.storeGroupId="",this.formData.memeberId=[]}},getMemberLevelList:function(){var e=this;Object(f.f)({page:1,size:20}).then(function(t){200===t.code?e.memberLevelList=t.data.content:e.$errorMessage(t.message)})},getStoreLevelList:function(){var e=this;Object(p.c)({page:1,size:20}).then(function(t){200===t.code?e.storeLevelList=t.data.content:e.$errorMessage(t.message)})},changeMesType:function(e){this.formData.recTargetType=1===e?1:4}},activated:function(){"save"===this.$route.query.type&&(this.formData=s()({},h))},created:function(){this.getMemberLevelList(),this.getStoreLevelList()}},v={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"cms-list-layout"},[a("cms-breadcrumb",{attrs:{to:"/mail/list"},on:{click:e.rest}},[a("li",[e._v(e._s(e.$route.name))])]),e._v(" "),a("div",{staticClass:"cms-form-layout"},[a("cms-prompt",{attrs:{collapse:!1}},[a("li",[e._v("会员及商家选择可支持多选操作")])]),e._v(" "),a("el-form",{ref:"form",attrs:{rules:e.rules,model:e.formData,"label-width":"210px"},nativeOn:{submit:function(e){e.preventDefault()}}},[a("el-form-item",{attrs:{label:"消息类型",prop:"mesType",error:e.errorMessage.mesType}},[a("el-radio-group",{on:{change:e.changeMesType},model:{value:e.formData.mesType,callback:function(t){e.$set(e.formData,"mesType",t)},expression:"formData.mesType"}},[a("el-radio",{attrs:{label:1}},[e._v("系统")]),e._v(" "),a("el-radio",{attrs:{label:2}},[e._v("私信")])],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"发送对象",prop:"recTargetType",error:e.errorMessage.recTargetType}},[2===e.formData.mesType?a("el-radio-group",{model:{value:e.formData.recTargetType,callback:function(t){e.$set(e.formData,"recTargetType",t)},expression:"formData.recTargetType"}},[a("el-radio",{attrs:{label:4}},[e._v("指定会员")]),e._v(" "),a("el-radio",{attrs:{label:5}},[e._v("指定商家")])],1):a("el-radio-group",{model:{value:e.formData.recTargetType,callback:function(t){e.$set(e.formData,"recTargetType",t)},expression:"formData.recTargetType"}},[a("el-radio",{attrs:{label:1}},[e._v("全部")]),e._v(" "),a("el-radio",{attrs:{label:2}},[e._v("会员等级")]),e._v(" "),a("el-radio",{attrs:{label:3}},[e._v("商家等级")])],1)],1),e._v(" "),a("el-form-item",[2===e.formData.recTargetType?a("el-select",{attrs:{placeholder:"请选择会员等级"},model:{value:e.formData.memeberGroupId,callback:function(t){e.$set(e.formData,"memeberGroupId",t)},expression:"formData.memeberGroupId"}},e._l(e.memberLevelList,function(e){return a("el-option",{key:e.id,attrs:{label:e.levelName,value:e.id}})}),1):e._e(),e._v(" "),3===e.formData.recTargetType?a("el-select",{attrs:{placeholder:"请选择商家等级"},model:{value:e.formData.storeGroupId,callback:function(t){e.$set(e.formData,"storeGroupId",t)},expression:"formData.storeGroupId"}},e._l(e.storeLevelList,function(e){return a("el-option",{key:e.id,attrs:{label:e.levelName,value:e.id}})}),1):4===e.formData.recTargetType?a("cms-member",{attrs:{labelName:"username",isOpenStore:!0},model:{value:e.formData.memeberId,callback:function(t){e.$set(e.formData,"memeberId",t)},expression:"formData.memeberId"}}):5===e.formData.recTargetType?a("cms-shops",{attrs:{labelData:e.formData.storeId,labelName:"storeName"},on:{"update:labelData":function(t){e.$set(e.formData,"storeId",t)}},model:{value:e.formData.storeId,callback:function(t){e.$set(e.formData,"storeId",t)},expression:"formData.storeId"}}):e._e()],1),e._v(" "),a("el-form-item",{attrs:{label:"标题",prop:"title",error:e.errorMessage.title}},[a("el-input",{attrs:{maxlength:"100"},model:{value:e.formData.title,callback:function(t){e.$set(e.formData,"title",e._n(t))},expression:"formData.title"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"内容",prop:"content",error:e.errorMessage.content}},[a("el-input",{attrs:{type:"textarea",rows:5,maxlength:"250"},model:{value:e.formData.content,callback:function(t){e.$set(e.formData,"content",t)},expression:"formData.content"}})],1)],1),e._v(" "),a("div",{staticClass:"cms-form-footer"},[a("cms-button",{directives:[{name:"color",rawName:"v-color"}],on:{click:function(t){e.save(!0)}}},[e._v("发送")])],1)],1)],1)},staticRenderFns:[]};var g=a("C7Lr")(b,v,!1,function(e){a("ZAUq")},"data-v-dfc63ea0",null);t.default=g.exports},ZAUq:function(e,t){},fz7a:function(e,t,a){"use strict";a.d(t,"a",function(){return s}),a.d(t,"b",function(){return o}),a.d(t,"c",function(){return l});var r=a("HNM5"),s=function(e){return r.a.post("/admin/platform/sysmessage/delete",e)},o=function(e){return r.a.get("/admin/platform/sysmessage/page",{params:e})},l=function(e){return r.a.post("/admin/platform/sysmessage/save",e)}},yQJf:function(e,t){}});
//# sourceMappingURL=44.8f997ccb9345767ef350.js.map
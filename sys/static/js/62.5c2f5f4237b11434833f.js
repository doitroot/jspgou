webpackJsonp([62],{"5/5/":function(e,t){},Z2vj:function(e,t,a){"use strict";a.d(t,"d",function(){return r}),a.d(t,"c",function(){return s}),a.d(t,"b",function(){return l}),a.d(t,"a",function(){return o});var n=a("HNM5"),r=function(e){return n.a.get("/admin/platform/platformLog/page",{params:e})},s=function(e){return n.a.get("/admin/platform/platformLog/delete",{params:e})},l=function(e){return n.a.get("/admin/platform/storeLog/page",{params:e})},o=function(e){return n.a.get("/admin/platform/storeLog/delete",{params:e})}},kQ93:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a("aA9S"),r=a.n(n),s=a("5HJ5"),l=a("Z2vj"),o={username:"",clientIp:""},i={name:"paltLog",mixins:[s.a],data:function(){return{queryParams:r()({},o),logData:{},logShow:{}}},methods:{showData:function(e){this.logData[e.id]?this.logShow=r()([],this.logData[e.id]):(this.logShow=e,this.logData[e.id]=e)},deleteDatas:function(){this.queryParams.type?this.deleteTableType():this.$errorMessage("请先选择时间段")},deleteTableType:function(){var e=this;0!==this.type?this.$confirm("您确定要批量删除数据吗","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.loading=!0,Object(l.c)({type:parseInt(e.queryParams.type)}).then(function(t){200===t.code?(e.getTableData(e.callback,e.queryParams,e.isPage),e.$successMessage("删除成功"),e.loading=!1):(e.$errorMessage("删除失败,"+t.message),e.loading=!1)})}).catch(function(){}):this.$errorMessage("请选择类型!")}},created:function(){this.getTableData(l.d,this.queryParams)}},u={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"cms-list-layout"},[a("cms-tabs",[a("cms-tab",{attrs:{to:"/log/paltLog"}},[e._v("平台操作日志")]),e._v(" "),a("cms-tab",{attrs:{to:"/log/storeLog"}},[e._v("商家操作日志")])],1),e._v(" "),a("cms-prompt",{attrs:{collapse:"true"}},[a("li",[e._v("显示平台所有的操作日志")])]),e._v(" "),a("section",{staticClass:"cms-list-query"},[a("div",{staticClass:"query-group"},[a("label",[e._v("操作用户")]),e._v(" "),a("el-input",{nativeOn:{keyup:function(t){return"button"in t||!e._k(t.keyCode,"enter",13,t.key,"Enter")?e.query(t):null}},model:{value:e.queryParams.username,callback:function(t){e.$set(e.queryParams,"username",t)},expression:"queryParams.username"}})],1),e._v(" "),a("div",{staticClass:"query-group"},[a("label",[e._v("IP")]),e._v(" "),a("el-input",{nativeOn:{keyup:function(t){return"button"in t||!e._k(t.keyCode,"enter",13,t.key,"Enter")?e.query(t):null}},model:{value:e.queryParams.clientIp,callback:function(t){e.$set(e.queryParams,"clientIp",t)},expression:"queryParams.clientIp"}})],1),e._v(" "),a("div",{staticClass:"query-group"},[a("cms-button",{attrs:{size:"small",colorPicker:!0},on:{click:e.query}},[e._v("查询")])],1),e._v(" "),a("div",{staticClass:"query-group"},[a("label",[e._v("请选择清除时间段")]),e._v(" "),a("el-select",{model:{value:e.queryParams.type,callback:function(t){e.$set(e.queryParams,"type",e._n(t))},expression:"queryParams.type"}},[a("el-option",{attrs:{label:"3个月前",value:1}}),e._v(" "),a("el-option",{attrs:{label:"半年前",value:2}}),e._v(" "),a("el-option",{attrs:{label:"一年前",value:3}})],1),e._v(" "),a("cms-button",{directives:[{name:"prem",rawName:"v-prem",value:"/paltLog/delete",expression:"'/paltLog/delete'"}],staticStyle:{"margin-left":"10px"},attrs:{icon:"error",type:"error",size:"small"},on:{click:function(t){e.deleteDatas()}}},[e._v("删除\n      ")])],1)]),e._v(" "),a("el-table",{ref:"dataTable",staticStyle:{width:"100%"},attrs:{data:e.tableData,stripe:""},on:{"selection-change":e.getCheckItems,"row-click":e.checkRows}},[a("el-table-column",{attrs:{prop:"uri",label:"请求地址","min-width":"260"}}),e._v(" "),a("el-table-column",{attrs:{prop:"clientIp",label:"访问IP","min-width":"150"}}),e._v(" "),a("el-table-column",{attrs:{prop:"method",label:"请求方式","min-width":"150"}}),e._v(" "),a("el-table-column",{attrs:{prop:"username",label:"操作用户","min-width":"150"}}),e._v(" "),a("el-table-column",{attrs:{prop:"createTime",label:"请求时间","min-width":"170"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n        "+e._s(e.$moment(t.row.createTime))+"\n      ")]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"更多",width:"175",fixed:"right",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return a("div",{},[a("el-popover",{attrs:{placement:"left-start",width:"300",trigger:"hover"},on:{show:function(a){e.showData(t.row)}}},[a("div",{staticStyle:{padding:"10px","font-size":"12px"}},[a("p",[e._v("sessionId："+e._s(e.logShow.sessionId))]),e._v(" "),a("p",[e._v("状态码："+e._s(e.logShow.httpStatusCode))]),e._v(" "),a("p",[e._v("耗时："+e._s(e.logShow.timeConsuming))]),e._v(" "),a("p",[e._v("请求参数："+e._s(e.logShow.paramData))]),e._v(" "),a("p",[e._v("响应参数："+e._s(e.logShow.returnData))])]),e._v(" "),a("cms-button",{attrs:{slot:"reference",icon:"edit",size:"small",type:"info"},slot:"reference"},[e._v("查看")])],1)],1)}}])})],1),e._v(" "),a("cms-pagination",{attrs:{total:e.total},on:{change:e.getPage}})],1)},staticRenderFns:[]};var c=a("C7Lr")(i,u,!1,function(e){a("5/5/")},null,null);t.default=c.exports}});
//# sourceMappingURL=62.5c2f5f4237b11434833f.js.map
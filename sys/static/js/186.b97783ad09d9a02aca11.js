webpackJsonp([186],{"7jL8":function(o,e){},"Zd3/":function(o,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var t=a("aA9S"),r=a.n(t),n=a("x1ym"),u=a("lcoF"),c=a("QkjJ"),s={coupon:{conOrderAmount:"",discountAmount:"",getMode:"",getNum:"",expirateType:"",issueNum:"",name:"",useBeginTime:"",useEndTime:"",useDay:"",couponType:"",couponScope:""},ctgIds:[]},p={components:{categoryCascader:a("CPCM").a},mixins:[u.a],data:function(){var o=this,e=function(o,e,a){"0"===e?a(new Error("请输入大于0的正整数")):a()};return{timer:[],formData:r()({},s),updateRules:{"coupon.name":[n.a.required("请填写优惠券名称"),n.a.len(1,20)],"coupon.couponType":[n.a.required()],"coupon.useDay":[n.a.required(),n.a.number(),n.a.custom(e)],"coupon.conOrderAmount":[n.a.required(),n.a.number(),n.a.custom(e)],"coupon.issueNum":[n.a.required(),n.a.number()],"coupon.getNum":[n.a.required(),n.a.number(),n.a.custom(e)],"coupon.discountAmount":[n.a.required("此项必填"),n.a.number(),n.a.custom(function(e,a,t){Number(a)<Number(o.formData.coupon.conOrderAmount)?t():t(new Error("面值不能大于使用条件"))})],"coupon.useEndTime":[n.a.required()]}}},methods:{getFormData:function(o){var e=this;this.status=!1,this.loading=!0,Object(c.x)({id:o}).then(function(o){200===o.code&&(e.formData.coupon=r()({},o.data),o.data.useBeginTime&&""!==o.data.useBeginTime&&(e.timer=[e.$moment(o.data.useBeginTime),e.$moment(o.data.useEndTime)]),delete e.formData.coupon.ctgs,e.$set(e.formData,"ctgIds",o.data.ctgs.map(function(o){return o.id})),e.status=!0,e.loading=!1)})},changeType:function(o){this.formData.coupon.expirateType=o},getTimer:function(o){this.formData.coupon.useBeginTime=o[0],this.formData.coupon.useEndTime=o[1],this.$refs.form.clearValidate("coupon.useBeginTime")},update:function(){var o=this.$cms.deepCopy(this.formData);this.updateForm(c.A,o,"/coupon/list","list")}},created:function(){this.getFormData(this.$route.query.id)}},m={render:function(){var o=this,e=o.$createElement,a=o._self._c||e;return a("div",[a("cms-breadcrumb",{attrs:{to:"/coupon/list",type:"list"},on:{click:o.rest}},[a("li",[o._v(o._s(o.$route.name))])]),o._v(" "),a("div",{staticClass:"cms-form-layout"},[a("cms-prompt",{attrs:{collapse:!1}},[a("li",[o._v("可进行添加平台优惠券")])]),o._v(" "),a("el-form",{directives:[{name:"loading",rawName:"v-loading",value:o.loading,expression:"loading"}],ref:"form",attrs:{rules:o.updateRules,model:o.formData,"label-width":"210px"}},[a("el-form-item",{attrs:{label:"优惠券名称",prop:"coupon.name",error:o.errorMessage.coupon_name}},[a("el-input",{model:{value:o.formData.coupon.name,callback:function(e){o.$set(o.formData.coupon,"name",e)},expression:"formData.coupon.name"}})],1),o._v(" "),a("el-form-item",{attrs:{label:"优惠券类型",prop:"coupon.couponType",error:o.errorMessage.coupon_couponType}},[a("el-radio-group",{on:{change:o.changeType},model:{value:o.formData.coupon.couponType,callback:function(e){o.$set(o.formData.coupon,"couponType",e)},expression:"formData.coupon.couponType"}},[a("el-radio",{attrs:{label:1}},[o._v("活动优惠券")]),o._v(" "),a("el-radio",{attrs:{label:2}},[o._v("普通优惠券")])],1)],1),o._v(" "),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:2==o.formData.coupon.couponType,expression:"formData.coupon.couponType==2"}],attrs:{label:"有效期",prop:"coupon.useDay",error:o.errorMessage.coupon_useDay,rules:2==o.formData.coupon.couponType?o.updateRules["coupon.useDay"]:[]}},[2==o.formData.coupon.couponType?a("el-input",{attrs:{maxlength:"3"},model:{value:o.formData.coupon.useDay,callback:function(e){o.$set(o.formData.coupon,"useDay",e)},expression:"formData.coupon.useDay"}},[a("template",{slot:"prepend"},[o._v("固定天数")]),o._v(" "),a("template",{slot:"append"},[o._v("天")])],2):o._e()],1),o._v(" "),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:1==o.formData.coupon.couponType,expression:"formData.coupon.couponType==1"}],attrs:{label:"有效期",prop:"coupon.useEndTime",error:o.errorMessage.coupon_useDay,rules:1==o.formData.coupon.couponType?[{required:!0,message:"请选择有效期",trigger:"change"}]:[]}},[1==o.formData.coupon.couponType?a("cms-picker",{staticStyle:{width:"380px"},attrs:{disabledType:"todayAfter"},on:{change:o.getTimer},model:{value:o.timer,callback:function(e){o.timer=e},expression:"timer"}}):o._e()],1),o._v(" "),a("el-form-item",{attrs:{label:"使用条件",prop:"coupon.conOrderAmount",error:o.errorMessage.coupon_conOrderAmount}},[a("el-input",{attrs:{maxlength:"8"},model:{value:o.formData.coupon.conOrderAmount,callback:function(e){o.$set(o.formData.coupon,"conOrderAmount",e)},expression:"formData.coupon.conOrderAmount"}},[a("template",{slot:"prepend"},[o._v("满")]),o._v(" "),a("template",{slot:"append"},[o._v("元")])],2)],1),o._v(" "),a("el-form-item",{attrs:{label:"面值",prop:"coupon.discountAmount",error:o.errorMessage.coupon_discountAmount}},[a("el-input",{attrs:{maxlength:"8"},model:{value:o.formData.coupon.discountAmount,callback:function(e){o.$set(o.formData.coupon,"discountAmount",e)},expression:"formData.coupon.discountAmount"}},[a("template",{slot:"append"},[o._v("元")])],2)],1),o._v(" "),a("el-form-item",{attrs:{label:"发放限制",prop:"coupon.issueNum"}},[a("el-input",{attrs:{maxlength:"8"},model:{value:o.formData.coupon.issueNum,callback:function(e){o.$set(o.formData.coupon,"issueNum",e)},expression:"formData.coupon.issueNum"}}),o._v(" "),a("div",{staticClass:"gray"},[o._v("输入几表示限制几张，输入0表示不限制")])],1),o._v(" "),a("el-form-item",{attrs:{label:"领取限制",prop:"coupon.getNum",error:o.errorMessage.coupon_getNum}},[a("el-input",{attrs:{maxlength:"6"},model:{value:o.formData.coupon.getNum,callback:function(e){o.$set(o.formData.coupon,"getNum",e)},expression:"formData.coupon.getNum"}},[a("template",{slot:"prepend"},[o._v("每用户")]),o._v(" "),a("template",{slot:"append"},[o._v("张")])],2)],1),o._v(" "),a("el-form-item",{attrs:{label:"优惠券使用范围",prop:"coupon.couponScope",error:o.errorMessage.coupon_couponScope}},[a("el-radio-group",{model:{value:o.formData.coupon.couponScope,callback:function(e){o.$set(o.formData.coupon,"couponScope",e)},expression:"formData.coupon.couponScope"}},[a("el-radio",{attrs:{label:1}},[o._v("全部商品")]),o._v(" "),a("el-radio",{attrs:{label:2}},[o._v("自营商品")]),o._v(" "),a("el-radio",{attrs:{label:3}},[o._v("部分类目")])],1),o._v(" "),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:3===o.formData.coupon.couponScope,expression:"formData.coupon.couponScope===3"}],attrs:{label:"选择类目","label-width":"80px"}},[o.status?a("category-cascader",{staticStyle:{width:"298px"},model:{value:o.formData.ctgIds,callback:function(e){o.$set(o.formData,"ctgIds",e)},expression:"formData.ctgIds"}}):o._e()],1)],1)],1),o._v(" "),a("div",{staticClass:"cms-form-footer"},[a("cms-button",{directives:[{name:"color",rawName:"v-color"}],on:{click:o.update}},[o._v("保存")])],1)],1)],1)},staticRenderFns:[]};var i=a("C7Lr")(p,m,!1,function(o){a("7jL8")},null,null);e.default=i.exports}});
//# sourceMappingURL=186.b97783ad09d9a02aca11.js.map
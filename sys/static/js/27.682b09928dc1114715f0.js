webpackJsonp([27],{QYVn:function(e,t){},b11x:function(e,t){e.exports="data:image/png;base64,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"},mVWm:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=s("+FNC"),i=s("x1vo"),n=s("3b5A"),c=s("BOZ4"),r=s("80N3"),o=s("wVwR"),l={data:function(){return{options:{toolbars:[],enableContextMenu:!1,maximumWords:600,enableAutoSave:!1,saveInterval:0,elementPathEnabled:!1,imageScaleEnabled:!1,iframeCssUrl:"/static/css/emoji.css"},txt:"",emojiList:Object(i.b)(),ue:null,visable:!1}},watch:{txt:function(){this.$emit("change",this.replaceEmoji(this.ue.getContent()))},visable:function(e){e?window.addEventListener("click",this.closeMenu):window.removeEventListener("click",this.closeMenu)}},methods:{test:function(){},getEditor:function(e){this.ue=e},addEmoji:function(e,t){var s="<img class='emoji emoji"+e+"' data-value='"+t+"'/>";this.ue.execCommand("insertHtml",s)},closeMenu:function(){this.visable=!1},replaceEmoji:function(e){var t="${emoji}".length,s=e.match(/<img.*?(?:>|\/>)/gi);if(null===s)return e.replace(/<\/?.+?>/g,"");e=(e=e.replace(/<img\/?.+?>/g,"${emoji}")).replace(/<\/?.+?>/g,"");for(var a=/data-value=[\'\"]?([^\'\"]*)[\'\"]?/i,i=0;i<s.length;i++){var n=s[i].match(a),c="";null!=n&&(c=n[1]);var r=e.indexOf("${emoji}");e=this.replacePos(e,r,t,c)}return e},replacePos:function(e,t,s,a){return e=e.substr(0,t)+a+e.substring(t+s,e.length)}},mounted:function(){}},d={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("cms-editor",{attrs:{config:e.options},on:{ready:e.getEditor},model:{value:e.txt,callback:function(t){e.txt=t},expression:"txt"}}),e._v(" "),a("div",{staticClass:"wx-editor__toolbar"},[a("div",{staticClass:"wx-emotion"},[a("span",{staticClass:"wx-emotion__tag",on:{click:function(t){e.visable=!0}}},[a("img",{attrs:{src:s("b11x"),alt:""}})]),e._v(" "),a("ul",{directives:[{name:"show",rawName:"v-show",value:e.visable,expression:"visable"}],staticClass:"wx-emotion__items"},e._l(e.emojiList,function(t,s,i){return a("li",{key:i,staticClass:"wx-emotion__item",attrs:{"data-value":s},on:{click:function(a){e.addEmoji(t,s)}}},[a("i",{staticClass:"emoji",class:"emoji"+t})])}),0)])])],1)},staticRenderFns:[]};var m=s("C7Lr")(l,d,!1,function(e){s("rYNe")},null,null).exports,v={name:"fans-editor",components:{imageTextZone:n.a,imageZone:c.a,audioZone:r.a,videoZone:o.a,editor:m},props:{openId:{type:String}},data:function(){return{activeName:"mpnews",news:[],images:[],videos:[],voices:[],text:""}},methods:{getNews:function(e){this.news=e},getImages:function(e){this.images=e},getVoice:function(e){this.voices=e},getVideo:function(e){this.videos=e},getText:function(e){this.text=e},sendMessage:function(){var e=this,t={touser:this.openId,msgtype:"",content:"",media_id:""};if("mpnews"===this.activeName&&this.news.length>0&&(t.msgtype="mpnews",t.media_id=this.news[0].mediaId),"image"===this.activeName&&this.images.length>0&&(t.msgtype="image",t.media_id=this.images[0].mediaId),"mpvideo"===this.activeName&&this.videos.length>0&&(t.msgtype="mpvideo",t.media_id=this.videos[0].mediaId),"voice"===this.activeName&&this.voices.length>0&&(t.msgtype="voice",t.media_id=this.voices[0].mediaId),"text"===this.activeName&&""!==this.text&&(t.msgtype="text",t.media_id="",t.content=this.text),""!==t.msgtype){var s=this.$loading({target:"#sendLoading",text:"正在发送..."});Object(a.u)(t).then(function(t){s.close(),200===t.code?e.$successMessage("发送成功"):e.$errorMessage(t.message)})}else this.$errorMessage("请选择发送的内容")}}},_={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"sendLoading"}},[a("el-tabs",{staticClass:"visable",staticStyle:{margin:"25px 0"},attrs:{type:"border-card"},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[a("el-tab-pane",{attrs:{label:"图文消息",name:"mpnews"}},[e.news.length<=0?a("div",{staticClass:"wx-create"},[a("image-text-zone",{staticClass:"wx-create__item",on:{change:e.getNews}},[a("div",{staticClass:"wx-create__item"},[a("p",{staticClass:"t-icon"},[a("img",{attrs:{src:s("o3Eb"),alt:""}})]),e._v(" "),a("p",{staticClass:"wx-create__title"},[e._v("从素材库选择")])])]),e._v(" "),a("div",{staticClass:"wx-create__item",on:{click:function(t){e.$routerLink("/wechatMaterial/imageText/save","save")}}},[a("p",{staticClass:"iconfont icon-jiaoxueneirong_zhongmingming"}),e._v(" "),a("p",{staticClass:"wx-create__title"},[e._v("新建图文")])])],1):a("div",{staticClass:"wx-create__inner",staticStyle:{width:"340px"}},e._l(e.news,function(t){return a("div",{key:t.id,staticClass:"we-card__warpper"},[e._l(t.requestArray,function(t,s){return[0==s?a("div",{key:s,staticClass:"we-card__item we-card__item--thumb"},[a("a",{staticClass:"we-card__link",attrs:{href:t.url,target:"_blank"}},[a("img",{staticClass:"we-card__img",attrs:{src:e.$cms.weChatUrl(t.thumbMediaUrl),alt:""}}),e._v(" "),""!=t.title?a("span",{staticClass:"we-card__title--thumb"},[e._v("\n                  "+e._s(t.title)+"\n                ")]):e._e()]),e._v(" "),a("div",{staticClass:"we-card-mask__preview"},[a("a",{attrs:{href:t.url,target:"_blank"}},[e._v("预览文章")])])]):a("div",{key:s,staticClass:"we-card__item  we-card__item--sub"},[a("a",{staticClass:"we-card__link",attrs:{href:t.url,target:"_blank"}},[a("div",{staticClass:"we-card__sub--inner"},[a("div",{staticClass:"we-card__sub--img"},[a("img",{attrs:{src:e.$cms.weChatUrl(t.thumbMediaUrl),alt:""}})]),e._v(" "),a("div",{staticClass:"we-card__sub--title"},[e._v("\n                    "+e._s(t.title)+"\n                  ")])])]),e._v(" "),a("div",{staticClass:"we-card-mask__preview"},[a("a",{attrs:{href:t.url,target:"_blank"}},[e._v("预览文章")])])])]}),e._v(" "),a("div",{staticClass:"we-card__footer"},[a("span",{staticClass:"fl"},[e._v("\n              更新时间 "+e._s(e.$cms.getDateDiff(1e3*t.wechatUpdateTime))+"\n            ")]),e._v(" "),a("span",{staticClass:"fr"},[a("i",{staticClass:"el-icon-delete",on:{click:function(t){e.news=[]}}})])])],2)}),0)]),e._v(" "),a("el-tab-pane",{attrs:{label:"文字",name:"text"}},[a("editor",{on:{change:e.getText}})],1),e._v(" "),a("el-tab-pane",{attrs:{label:"图片消息",name:"image"}},[e.images.length<=0?a("div",{staticClass:"wx-create"},[a("image-zone",{staticClass:"wx-create__item",on:{change:e.getImages}},[a("div",{staticClass:"wx-create__item"},[a("p",{staticClass:"t-icon"},[a("img",{attrs:{src:s("IZIg"),alt:""}})]),e._v(" "),a("p",{staticClass:"wx-create__title"},[e._v("从素材库选择图片")])])])],1):a("div",{staticClass:"wx-create__inner",staticStyle:{width:"340px"}},[a("div",{staticClass:"relative"},[a("img",{staticClass:"wx-create__img",attrs:{src:e.$cms.weChatUrl(e.images[0].request.url),alt:""}}),e._v(" "),a("image-zone",{staticClass:"wx-repalce__warpper",on:{change:e.getImages}},[a("div",{staticClass:"wx-repalce__btn"},[e._v("替换素材")])])],1)])]),e._v(" "),a("el-tab-pane",{attrs:{label:"语音消息",name:"voice"}},[e.voices.length<=0?a("div",{staticClass:"wx-create"},[a("audio-zone",{staticClass:"wx-create__item",on:{change:e.getVoice}},[a("div",{staticClass:"wx-create__item"},[a("p",{staticClass:"t-icon"},[a("img",{attrs:{src:s("NeDh"),alt:""}})]),e._v(" "),a("p",{staticClass:"wx-create__title"},[e._v("从素材库选择音频")])])])],1):a("div",{staticClass:"wx-create__inner",staticStyle:{width:"340px"}},[a("div",{staticClass:"relative"},[a("div",{staticClass:"preview-audio__context"},[a("div",{staticClass:"preview-audio__player"}),e._v(" "),a("div",{staticClass:"preview-audio__name"},[e._v("\n                "+e._s(e.voices[0].request.name)+"\n             ")])]),e._v(" "),a("audio-zone",{staticClass:"wx-repalce__warpper",on:{change:e.getVoice}},[a("div",{staticClass:"wx-repalce__btn"},[e._v("替换素材")])])],1)])]),e._v(" "),a("el-tab-pane",{attrs:{label:"视频消息",name:"mpvideo"}},[e.videos.length<=0?a("div",{staticClass:"wx-create"},[a("video-zone",{staticClass:"wx-create__item",on:{change:e.getVideo}},[a("div",{staticClass:"wx-create__item"},[a("p",{staticClass:"t-icon"},[a("img",{attrs:{src:s("rrsa"),alt:""}})]),e._v(" "),a("p",{staticClass:"wx-create__title"},[e._v("从素材库选择视频")])])])],1):a("div",{staticClass:"wx-create__inner",staticStyle:{width:"340px"}},[a("div",{staticClass:"relative"},[a("div",{staticClass:"preview-audio__context"},[a("div",{staticClass:"preview-audio__player"}),e._v(" "),a("div",{staticClass:"preview-audio__name"},[e._v("\n                "+e._s(e.videos[0].request.name)+"\n             ")])]),e._v(" "),a("video-zone",{staticClass:"wx-repalce__warpper",on:{change:e.getVoice}},[a("div",{staticClass:"wx-repalce__btn"},[e._v("替换素材")])])],1)])])],1),e._v(" "),a("div",{staticClass:"center"},[a("el-button",{attrs:{type:"primary"},on:{click:e.sendMessage}},[e._v("\n      发送\n    ")])],1)],1)},staticRenderFns:[]};var u={components:{fansEditor:s("C7Lr")(v,_,!1,function(e){s("oG2H")},"data-v-d00ab1f0",null).exports},data:function(){return{userData:{},sendItems:[],loading:!1}},methods:{delSend:function(e){var t=this,s=[];s.push(e),Object(a.v)({ids:s}).then(function(e){200===e.code?(t.$successMessage("删除成功"),t.getFansData(t.$route.query.id)):t.$errorMessage(e.message)})},showEmojiName:function(e){var t=Object(i.a)(e);return t=Object(i.c)(t)},getFansData:function(e){var t=this;this.loading=!0,Object(a.f)({id:e}).then(function(e){t.loading=!1,200===e.code&&(t.userData=e.data,t.userData.nickname=t.showEmojiName(e.data.nickname),t.getSendIList(t.userData.openid))})},getSendIList:function(e){var t=this;Object(a.w)({openid:e,page:1,size:30}).then(function(e){200===e.code&&(e.data.content.forEach(function(e){"text"!==e.msgType&&(e.mediaJson=JSON.parse(e.mediaJson))}),t.sendItems=e.data.content)})}},created:function(){this.getFansData(this.$route.query.id)}},p={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}]},[s("cms-breadcrumb",{attrs:{to:"/wechatFans/list"}},[s("li",[e._v(e._s(e.$route.name))])]),e._v(" "),s("div",{staticClass:"send-warp"},[s("div",{staticClass:"wx-userinfo"},[s("img",{staticClass:"wx-userinfo--avatar",attrs:{src:e.userData.headimgurl,alt:""}}),e._v(" "),s("div",{staticClass:"wx-userinfo--content"},[s("p",{staticClass:"wx-userinfo--name"},[s("span",{domProps:{innerHTML:e._s(e.userData.nickname)}})]),e._v(" "),s("p",{staticClass:"wx-userinfo--info"},[e._v("\n          粉丝编号:"+e._s(e.userData.openid))]),e._v(" "),s("p",{staticClass:"wx-userinfo--info"},[e._v("关注时间: "+e._s(e.$moment(1e3*e.userData.subscribeTime)))]),e._v(" "),s("p",{staticClass:"wx-userinfo--info"},[e._v(e._s(e.userData.member?"商城注册会员":"未注册商城会员"))])])]),e._v(" "),s("fans-editor",{attrs:{openId:e.userData.openid}}),e._v(" "),s("h3",{staticClass:"cms-segmentation"},[e._v("\n      消息发送历史记录\n    ")]),e._v(" "),s("ul",e._l(e.sendItems,function(t,a){return s("li",{key:a,staticClass:"send-list__items"},[s("div",{staticClass:"send-list__type"},["text"==t.msgType?s("span",[e._v("\n            【文本消息】\n          ")]):e._e(),e._v(" "),"mpnews"==t.msgType?s("span",[e._v("\n            【图文消息】\n          ")]):e._e(),e._v(" "),"mpvideo"==t.msgType?s("span",[e._v("\n            【视频消息】\n          ")]):e._e(),e._v(" "),"voice"==t.msgType?s("span",[e._v("\n            【语音消息】\n          ")]):e._e(),e._v(" "),"image"==t.msgType?s("span",[e._v("\n            【图片消息】\n          ")]):e._e()]),e._v(" "),"image"==t.msgType||"mpnews"==t.msgType?s("div",{staticClass:"send-list__img"},["mpnews"==t.msgType?s("img",{attrs:{src:e.$cms.weChatUrl(t.mediaJson[0].thumbMediaUrl),alt:""}}):e._e(),e._v(" "),"image"==t.msgType?s("img",{attrs:{src:e.$cms.weChatUrl(t.mediaJson.url),alt:""}}):e._e()]):e._e(),e._v(" "),s("div",{staticClass:"media-preview__inner send-list__inner"},["text"!=t.msgType?s("div",{staticClass:"send-list__title"},["mpnews"==t.msgType?s("span",[e._v(e._s(t.mediaJson[0].title))]):s("span",{class:["image"==t.msgType?"":"title-pos"]},[e._v(e._s(t.mediaJson.name))])]):e._e(),e._v(" "),s("div",{staticClass:"media-preview__content"},["mpnews"==t.msgType?s("span",{staticClass:"text-overflow",staticStyle:{width:"300px",display:"inline-block"}},[e._v(e._s(t.mediaJson[0].digest))]):e._e(),e._v(" "),"text"==t.msgType?s("div",{staticClass:"text-overflow",staticStyle:{"padding-top":"10px"},domProps:{innerHTML:e._s(e.showEmojiName(t.mediaJson))}}):e._e()])]),e._v(" "),s("div",{staticClass:"media-preview__del fr",on:{click:function(s){e.delSend(t.id)}}},[e._v("\n          删除\n        ")]),e._v(" "),s("div",{staticClass:"media-preview__success fr"},[s("p",[e._v("发送成功")]),e._v(" "),s("p",{staticClass:"media-preview__time"},[e._v(e._s(e.$moment(t.createTime)))])])])}),0)],1)],1)},staticRenderFns:[]};var g=s("C7Lr")(u,p,!1,function(e){s("QYVn")},"data-v-085deacd",null);t.default=g.exports},oG2H:function(e,t){},rYNe:function(e,t){}});
//# sourceMappingURL=27.682b09928dc1114715f0.js.map
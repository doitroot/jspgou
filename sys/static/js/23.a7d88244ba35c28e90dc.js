webpackJsonp([23],{"3Z78":function(e,t){},JCSy:function(e,t){},Vxwu:function(e,t){},anRL:function(e,t){},"ie/J":function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=s("aA9S"),r=s.n(a),n=s("EttR"),o=s("5HJ5"),l={page:1,size:10,statuses:[2],cycleId:"",storeName:""},i={mixins:[o.a],data:function(){return{queryParams:r()({},l),loading:!1,status:"",store:"",cycleList:[]}},methods:{reviewPassAll:function(){var e=this;this.ids.length>0?this.$confirm("审核通过后，结算金额将转账至商户虚拟账户内，是否继续执行?<br/>","系统提示",{dangerouslyUseHTMLString:!0,confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(n.j)({ids:e.ids}).then(function(t){200===t.code?(e.$successMessage("审核成功"),e.getTableData(n.i,e.queryParams)):e.$errorMessage("审核失败,"+t.message)})}).catch(function(){}):this.$errorMessage("请至少选择一条数据进行审核")},reviewDisPassAll:function(){var e=this;this.ids.length>0?this.$confirm("不通过操作执行后，结算单将继续重置为待商家确认状态，确定是否继续执行?","系统提示",{confirmButtonText:"确定",cancelButtonText:"取消"}).then(function(){Object(n.h)({ids:e.ids}).then(function(t){200===t.code?(e.$successMessage("审核成功"),e.getTableData(n.i,e.queryParams)):e.$errorMessage("审核失败,"+t.message)})}).catch(function(){}):this.$errorMessage("请至少选择一条数据进行审核")},exportData:function(){delete this.queryParams.page,delete this.queryParams.size,Object(n.g)(this.queryParams).then(function(e){var t=new Blob([e]),s=document.createElement("a");s.download="平台待处理.xls",s.href=window.URL.createObjectURL(t),s.click()})},toStatus:function(e,t){return["","待商家确认","待平台审核","已结算"][parseInt(e.status)]},getCycleList:function(){var e=this;Object(n.k)().then(function(t){200===t.code?e.cycleList=t.data:e.$errorMessage(t.message)})},changeData:function(){this.getCycleList(),this.getTableData(n.i,this.queryParams)},reviewPass:function(e,t){var s=this;this.$confirm("审核通过后，结算金额将转账至商户虚拟账户内，是否继续执行?<br/>"+(t?'<p style="width:300px;margin:0 auto;" class="gray">系统检测到当前结算单存在异常数据，避免争议，请确认是否已经征得商家确认</p>':""),"系统提示",{dangerouslyUseHTMLString:!0,confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(n.j)({ids:[e]}).then(function(e){200===e.code?(s.$successMessage("审核成功"),s.getTableData(n.i,s.queryParams)):s.$errorMessage("审核失败,"+e.message)})}).catch(function(){})},reviewDisPass:function(e){var t=this;this.$confirm("不通过操作执行后，结算单将继续重置为待商家确认状态，确定是否继续执行?","系统提示",{confirmButtonText:"确定",cancelButtonText:"取消"}).then(function(){Object(n.h)({ids:[e]}).then(function(e){200===e.code?(t.$successMessage("审核成功"),t.getTableData(n.i,t.queryParams)):t.$errorMessage("审核失败,"+e.message)})}).catch(function(){})}},created:function(){this.getCycleList(),this.getTableData(n.i,this.queryParams)}},c={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"cms-list-layout",staticStyle:{"padding-top":"6px"}},[s("section",{staticClass:"cms-list-query",staticStyle:{"padding-top":"0"}},[s("div",{staticClass:"query-group"},[s("label",[e._v("结算周期")]),e._v(" "),s("el-select",{attrs:{placeholder:"请选择"},on:{change:e.query},model:{value:e.queryParams.cycleId,callback:function(t){e.$set(e.queryParams,"cycleId",t)},expression:"queryParams.cycleId"}},e._l(e.cycleList,function(t){return s("el-option",{key:t.id,attrs:{label:e.$moment(t.begintime,"YYYY/MM/DD")+"~"+e.$moment(t.endtime,"YYYY/MM/DD"),value:t.id}})}),1)],1),e._v(" "),s("div",{staticClass:"query-group"},[s("label",[e._v("商家")]),e._v(" "),s("el-input",{on:{keyup:function(t){return"button"in t||!e._k(t.keyCode,"enter",13,t.key,"Enter")?e.query(t):null}},model:{value:e.queryParams.storeName,callback:function(t){e.$set(e.queryParams,"storeName",t)},expression:"queryParams.storeName"}})],1),e._v(" "),s("div",{staticClass:"query-group"},[s("cms-button",{attrs:{size:"small",colorPicker:!0},on:{click:e.query}},[e._v("查询")])],1),e._v(" "),s("div",{staticClass:"query-group"},[s("cms-button",{attrs:{size:"small",colorPicker:!0},on:{click:e.exportData}},[s("i",{staticClass:"iconfont icon-Excel"}),e._v(" 导出")])],1)]),e._v(" "),s("section",{staticClass:"cms-batch"},[s("el-popover",{attrs:{width:"130",trigger:"hover","visible-arrow":!1,offset:45,"popper-class":"table-popover"}},[s("cms-button",{attrs:{slot:"reference",type:"info",size:"small",icon:"lock"},slot:"reference"},[e._v("确认审核")]),e._v(" "),s("cms-button",{attrs:{type:"info",size:"small",icon:"success"},on:{click:function(t){return t.stopPropagation(),e.reviewPassAll(t)}}},[e._v("审核通过")]),e._v(" "),s("cms-button",{attrs:{type:"info",size:"small",icon:"warning"},on:{click:function(t){return t.stopPropagation(),e.reviewDisPassAll(t)}}},[e._v("审核不通过")])],1)],1),e._v(" "),s("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"dataTable",staticStyle:{width:"100%"},attrs:{data:e.tableData,stripe:""},on:{"selection-change":e.getCheckItems,"row-click":e.checkRows}},[s("el-table-column",{attrs:{type:"selection",width:"46",fixed:"left"}}),e._v(" "),s("el-table-column",{attrs:{type:"expand",align:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-form",{staticClass:"demo-table-expand",attrs:{"label-position":"right","label-width":"160px",inline:""}},[s("el-form-item",{attrs:{label:"结算批次号："}},[s("span",[e._v(e._s(t.row.businessNumber))])]),e._v(" "),s("el-form-item",{attrs:{label:"商家："}},[s("span",[e._v(e._s(t.row.store.storeName))])]),e._v(" "),s("el-form-item",{attrs:{label:"主营类目："}},[s("span",[e._v(e._s(t.row.store.productCategory.cateName))])]),e._v(" "),s("el-form-item",{attrs:{label:"生成时间："}},[s("span",[e._v(e._s(e.$moment(t.row.createTime,"YYYY-MM-DD HH:mm:ss")))])]),e._v(" "),s("el-form-item",{attrs:{label:"状态："}},[1==t.row.status?s("span",[e._v("待商家确认")]):e._e(),e._v(" "),2==t.row.status?s("span",[e._v("待平台审核")]):e._e(),e._v(" "),3==t.row.status?s("span",[e._v("已结算")]):e._e()]),e._v(" "),s("el-form-item",{attrs:{label:"有效订单数："}},[s("span",{staticClass:"green"},[e._v(e._s(t.row.orders>0?t.row.orders:0)+" 笔")])]),e._v(" "),s("el-form-item",{attrs:{label:"退款单数："}},[s("span",{staticClass:"red"},[e._v(e._s(t.row.refundOrders>0?t.row.refundOrders:0)+" 笔")])]),e._v(" "),s("el-form-item",{attrs:{label:"结算金额："}},[s("span",{staticClass:"green"},[e._v("￥ "+e._s(e.$cms.float(t.row.amount)))])]),e._v(" "),s("el-form-item",{attrs:{label:""}},[s("span")]),e._v(" "),s("el-form-item",{attrs:{label:"成交金额："}},[s("span",{staticClass:"green"},[e._v("￥ "+e._s(e.$cms.float(t.row.turnoverAmount)))])]),e._v(" "),s("el-form-item",{attrs:{label:""}},[s("span")]),e._v(" "),s("el-form-item",{attrs:{label:""}},[s("span")]),e._v(" "),s("el-form-item",{attrs:{label:"积分抵扣（金额/数量）："}},[s("span",{staticClass:"green"},[e._v(" ￥"+e._s(e.$cms.float(t.row.integralDeductionAmount))+"/"+e._s(t.row.integralDeductionNum))])]),e._v(" "),s("el-form-item",{attrs:{label:"红包抵扣（金额/数量）："}},[s("span",{staticClass:"green"},[e._v(" ￥"+e._s(e.$cms.float(t.row.redenvelopeOffset))+"/"+e._s(t.row.redenvelopeOffsetNum))])]),e._v(" "),s("el-form-item",{attrs:{label:"平台优惠券抵扣："}},[s("span",{staticClass:"green"},[e._v(" ￥ "+e._s(e.$cms.float(t.row.platformCouponOffset)))])]),e._v(" "),s("el-form-item",{attrs:{label:"退款金额："}},[s("span",{staticClass:"red"},[e._v("- ￥"+e._s(e.$cms.float(t.row.refundAmount)))])]),e._v(" "),s("el-form-item",{attrs:{label:""}},[s("span")]),e._v(" "),s("el-form-item",{attrs:{label:""}},[s("span")]),e._v(" "),s("el-form-item",{attrs:{label:"积分返还（金额/数量）："}},[s("span",{staticClass:"red"},[e._v("- ￥"+e._s(e.$cms.float(t.row.refundRedenvelopeAmount))+"/"+e._s(t.row.refundRedenvelopeNum))])]),e._v(" "),s("el-form-item",{attrs:{label:"红包返还（金额/数量）："}},[s("span",{staticClass:"red"},[e._v("- ￥"+e._s(e.$cms.float(t.row.redenvelopeOffset))+"/"+e._s(t.row.redenvelopeOffsetNum))])]),e._v(" "),s("el-form-item",{attrs:{label:"平台优惠券返还："}},[s("span",{staticClass:"red"},[e._v("- ￥ "+e._s(e.$cms.float(t.row.platformRefundCoupon)))])])],1)]}}])}),e._v(" "),s("el-table-column",{attrs:{prop:"businessNumber",label:"结算批次号",width:"170"}}),e._v(" "),s("el-table-column",{attrs:{prop:"settlementCycle",label:"结算周期","min-width":"180",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return s("div",{},[t.row.settlementCycle.begintime&&""!=t.row.settlementCycle.begintime?s("span",[e._v("\n            "+e._s(e.$moment(t.row.settlementCycle.begintime,"YYYY/MM/DD")+" ~ "+e.$moment(t.row.settlementCycle.endtime,"YYYY/MM/DD"))+"\n          ")]):s("span",[e._v(e._s(e.$moment(t.row.settlementCycle.endtime,"YYYY-MM-DD")))])])}}])}),e._v(" "),s("el-table-column",{attrs:{prop:"store.storeName",label:"商家","min-width":"160",align:"center"}}),e._v(" "),s("el-table-column",{attrs:{prop:"store.productCategory.cateName",label:"主营类目","min-width":"100",align:"center"}}),e._v(" "),s("el-table-column",{attrs:{prop:"amount",label:"结算金额","min-width":"130",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return s("div",{},[s("span",[e._v("￥ "+e._s(e.$cms.float(t.row.amount)))])])}}])}),e._v(" "),s("el-table-column",{attrs:{prop:"createTime",label:"生成时间","min-width":"170",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return s("div",{},[s("span",[e._v(e._s(e.$moment(t.row.createTime,"YYYY-MM-DD HH:mm:ss")))])])}}])}),e._v(" "),s("el-table-column",{attrs:{prop:"status",formatter:e.toStatus,label:"状态","min-width":"110",align:"center"}}),e._v(" "),s("el-table-column",{attrs:{prop:"hasError",label:"是否异常","min-width":"80",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return s("div",{},[s("span",{class:t.row.hasError?"green":"red"},[e._v("\n            "+e._s(t.row.hasError?"是":"否")+"\n          ")])])}}])}),e._v(" "),s("el-table-column",{attrs:{label:"操作",width:"300",fixed:"right",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return s("div",{},[s("el-popover",{attrs:{width:"130",trigger:"hover","visible-arrow":!1,offset:45,"popper-class":"table-popover"}},[2==t.row.status?s("cms-button",{attrs:{slot:"reference",type:"info",size:"small",icon:"lock"},slot:"reference"},[e._v("审核")]):e._e(),e._v(" "),s("cms-button",{attrs:{type:"info",size:"small",icon:"success"},on:{click:function(s){s.stopPropagation(),e.reviewPass(t.row.id,t.row.hasError)}}},[e._v("审核通过")]),e._v(" "),s("cms-button",{attrs:{type:"info",size:"small",icon:"warning"},on:{click:function(s){s.stopPropagation(),e.reviewDisPass(t.row.id)}}},[e._v("审核不通过")])],1),e._v(" "),s("cms-button",{attrs:{slot:"reference",type:"info",size:"small"},on:{click:function(s){s.stopPropagation(),e.$routerLink("/finance/settlement/abnomal","list",{sid:t.row.id,id:t.row.id,isEdit:!0,storeId:t.row.store.id})}},slot:"reference"},[e._v("查看异常数据")]),e._v(" "),s("cms-button",{attrs:{slot:"reference",type:"info",size:"small"},on:{click:function(s){s.stopPropagation(),e.$routerLink("/finance/settlement/view","list",{sid:t.row.id,id:t.row.settlementCycle.id,storeId:t.row.store.id,isEdit:!0})}},slot:"reference"},[e._v("查看明细")])],1)}}])})],1),e._v(" "),s("cms-pagination",{attrs:{total:e.total},on:{change:e.getPage}})],1)},staticRenderFns:[]};var m=s("C7Lr")(i,c,!1,function(e){s("Vxwu")},"data-v-6eed6f32",null).exports,u={page:1,size:10,statuses:[1],cycleId:"",storeName:""},d={mixins:[o.a],data:function(){return{queryParams:r()({},u),loading:!1,status:"",store:"",cycleList:[]}},methods:{exportData:function(){delete this.queryParams.page,delete this.queryParams.size,Object(n.g)(this.queryParams).then(function(e){var t=new Blob([e]),s=document.createElement("a");s.download="商家待处理.xls",s.href=window.URL.createObjectURL(t),s.click()})},toStatus:function(e,t){return["","待商家确认","待平台审核","已结算"][parseInt(e.status)]},getCycleList:function(){var e=this;Object(n.k)().then(function(t){200===t.code?e.cycleList=t.data:e.$errorMessage(t.message)})},changeData:function(){this.getCycleList(),this.getTableData(n.i,this.queryParams)}},created:function(){this.getCycleList(),this.getTableData(n.i,this.queryParams)}},f={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"cms-list-layout",staticStyle:{"padding-top":"6px"}},[s("section",{staticClass:"cms-list-query",staticStyle:{"padding-top":"0"}},[s("div",{staticClass:"query-group"},[s("label",[e._v("结算周期")]),e._v(" "),s("el-select",{attrs:{placeholder:"请选择"},on:{change:e.query},model:{value:e.queryParams.cycleId,callback:function(t){e.$set(e.queryParams,"cycleId",t)},expression:"queryParams.cycleId"}},e._l(e.cycleList,function(t){return s("el-option",{key:t.id,attrs:{label:e.$moment(t.begintime,"YYYY/MM/DD")+"~"+e.$moment(t.endtime,"YYYY/MM/DD"),value:t.id}})}),1)],1),e._v(" "),s("div",{staticClass:"query-group"},[s("label",[e._v("商家")]),e._v(" "),s("el-input",{on:{keyup:function(t){return"button"in t||!e._k(t.keyCode,"enter",13,t.key,"Enter")?e.query(t):null}},model:{value:e.queryParams.storeName,callback:function(t){e.$set(e.queryParams,"storeName",t)},expression:"queryParams.storeName"}})],1),e._v(" "),s("div",{staticClass:"query-group"},[s("cms-button",{attrs:{size:"small",colorPicker:!0},on:{click:e.query}},[e._v("查询")])],1),e._v(" "),s("div",{staticClass:"query-group"},[s("cms-button",{attrs:{size:"small",colorPicker:!0},on:{click:e.exportData}},[s("i",{staticClass:"iconfont icon-Excel"}),e._v(" 导出")])],1)]),e._v(" "),s("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"dataTable",staticStyle:{width:"100%"},attrs:{data:e.tableData,stripe:""},on:{"selection-change":e.getCheckItems,"row-click":e.checkRows}},[s("el-table-column",{attrs:{type:"expand",align:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-form",{staticClass:"demo-table-expand",attrs:{"label-position":"right","label-width":"160px",inline:""}},[s("el-form-item",{attrs:{label:"结算批次号："}},[s("span",[e._v(e._s(t.row.businessNumber))])]),e._v(" "),s("el-form-item",{attrs:{label:"商家："}},[s("span",[e._v(e._s(t.row.store.storeName))])]),e._v(" "),s("el-form-item",{attrs:{label:"主营类目："}},[s("span",[e._v(e._s(t.row.store.productCategory.cateName))])]),e._v(" "),s("el-form-item",{attrs:{label:"生成时间："}},[s("span",[e._v(e._s(e.$moment(t.row.createTime,"YYYY-MM-DD HH:mm:ss")))])]),e._v(" "),s("el-form-item",{attrs:{label:"状态："}},[1==t.row.status?s("span",[e._v("待商家确认")]):e._e(),e._v(" "),2==t.row.status?s("span",[e._v("待平台审核")]):e._e(),e._v(" "),3==t.row.status?s("span",[e._v("已结算")]):e._e()]),e._v(" "),s("el-form-item",{attrs:{label:"有效订单数："}},[s("span",{staticClass:"green"},[e._v(e._s(t.row.orders>0?t.row.orders:0)+" 笔")])]),e._v(" "),s("el-form-item",{attrs:{label:"退款单数："}},[s("span",{staticClass:"red"},[e._v(e._s(t.row.refundOrders>0?t.row.refundOrders:0)+" 笔")])]),e._v(" "),s("el-form-item",{attrs:{label:"结算金额："}},[s("span",{staticClass:"green"},[e._v("￥ "+e._s(e.$cms.float(t.row.amount)))])]),e._v(" "),s("el-form-item",{attrs:{label:"异常处理调整金额："}},[s("span",{staticClass:"green"},[e._v("￥ "+e._s(e.$cms.float(t.row.errorAdjustmentAmount)))])]),e._v(" "),s("el-form-item",{attrs:{label:"成交金额："}},[s("span",{staticClass:"green"},[e._v("￥ "+e._s(e.$cms.float(t.row.turnoverAmount)))])]),e._v(" "),s("el-form-item",{attrs:{label:""}},[s("span")]),e._v(" "),s("el-form-item",{attrs:{label:""}},[s("span")]),e._v(" "),s("el-form-item",{attrs:{label:"积分抵扣（金额/数量）："}},[s("span",{staticClass:"green"},[e._v(" ￥"+e._s(e.$cms.float(t.row.integralDeductionAmount))+"/"+e._s(t.row.integralDeductionNum))])]),e._v(" "),s("el-form-item",{attrs:{label:"红包抵扣（金额/数量）："}},[s("span",{staticClass:"green"},[e._v(" ￥"+e._s(e.$cms.float(t.row.redenvelopeOffset))+"/"+e._s(t.row.redenvelopeOffsetNum))])]),e._v(" "),s("el-form-item",{attrs:{label:"平台优惠券抵扣："}},[s("span",{staticClass:"green"},[e._v(" ￥ "+e._s(e.$cms.float(t.row.platformCouponOffset)))])]),e._v(" "),s("el-form-item",{attrs:{label:"退款金额："}},[s("span",{staticClass:"red"},[e._v("- ￥"+e._s(e.$cms.float(t.row.refundAmount)))])]),e._v(" "),s("el-form-item",{attrs:{label:""}},[s("span")]),e._v(" "),s("el-form-item",{attrs:{label:""}},[s("span")]),e._v(" "),s("el-form-item",{attrs:{label:"积分返还（金额/数量）："}},[s("span",{staticClass:"red"},[e._v("- ￥"+e._s(e.$cms.float(t.row.refundRedenvelopeAmount))+"/"+e._s(t.row.refundRedenvelopeNum))])]),e._v(" "),s("el-form-item",{attrs:{label:"红包返还（金额/数量）："}},[s("span",{staticClass:"red"},[e._v("- ￥"+e._s(e.$cms.float(t.row.redenvelopeOffset))+"/"+e._s(t.row.redenvelopeOffsetNum))])]),e._v(" "),s("el-form-item",{attrs:{label:"平台优惠券返还："}},[s("span",{staticClass:"red"},[e._v("- ￥ "+e._s(e.$cms.float(t.row.platformRefundCoupon)))])])],1)]}}])}),e._v(" "),s("el-table-column",{attrs:{prop:"businessNumber",label:"结算批次号",width:"160"}}),e._v(" "),s("el-table-column",{attrs:{prop:"settlementCycle",label:"结算周期","min-width":"180",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return s("div",{},[t.row.settlementCycle.begintime&&""!=t.row.settlementCycle.begintime?s("span",[e._v("\n            "+e._s(e.$moment(t.row.settlementCycle.begintime,"YYYY/MM/DD")+" ~ "+e.$moment(t.row.settlementCycle.endtime,"YYYY/MM/DD"))+"\n          ")]):s("span",[e._v(e._s(e.$moment(t.row.settlementCycle.endtime,"YYYY-MM-DD")))])])}}])}),e._v(" "),s("el-table-column",{attrs:{prop:"store.storeName",label:"商家","min-width":"160",align:"center"}}),e._v(" "),s("el-table-column",{attrs:{prop:"store.productCategory.cateName",label:"主营类目","min-width":"100",align:"center"}}),e._v(" "),s("el-table-column",{attrs:{prop:"amount",label:"结算金额","min-width":"130",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return s("div",{},[s("span",[e._v("￥ "+e._s(e.$cms.float(t.row.amount)))])])}}])}),e._v(" "),s("el-table-column",{attrs:{prop:"createTime",label:"生成时间","min-width":"170",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return s("div",{},[s("span",[e._v(e._s(e.$moment(t.row.createTime,"YYYY-MM-DD HH:mm:ss")))])])}}])}),e._v(" "),s("el-table-column",{attrs:{prop:"status",formatter:e.toStatus,label:"状态","min-width":"110",align:"center"}}),e._v(" "),s("el-table-column",{attrs:{label:"操作",width:"150",fixed:"right",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return s("div",{},[s("cms-button",{attrs:{slot:"reference",type:"info",size:"small"},on:{click:function(s){s.stopPropagation(),e.$routerLink("/finance/settlement/view","list",{sid:t.row.id,id:t.row.settlementCycle.id,storeId:t.row.store.id})}},slot:"reference"},[e._v("查看明细")])],1)}}])})],1),e._v(" "),s("cms-pagination",{attrs:{total:e.total},on:{change:e.getPage}})],1)},staticRenderFns:[]};var _=s("C7Lr")(d,f,!1,function(e){s("anRL")},"data-v-64ab2a0d",null).exports,v={page:1,size:10,statuses:[3],cycleId:"",storeName:""},p={mixins:[o.a],data:function(){return{queryParams:r()({},v),loading:!1,status:"",store:"",cycleList:[],info:[]}},methods:{exportData:function(){delete this.queryParams.page,delete this.queryParams.size,Object(n.g)(this.queryParams).then(function(e){var t=new Blob([e]),s=document.createElement("a");s.download="商家已结算.xls",s.href=window.URL.createObjectURL(t),s.click()})},toStatus:function(e,t){return["","待商家确认","待平台审核","已结算"][parseInt(e.status)]},getCycleList:function(){var e=this;Object(n.k)().then(function(t){200===t.code?e.cycleList=t.data:e.$errorMessage(t.message)})},changeData:function(){this.getCycleList(),this.getTableData(n.i,this.queryParams)}},created:function(){this.getCycleList(),this.getTableData(n.i,this.queryParams)}},b={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"cms-list-layout",staticStyle:{"padding-top":"6px"}},[s("section",{staticClass:"cms-list-query",staticStyle:{"padding-top":"0"}},[s("div",{staticClass:"query-group"},[s("label",[e._v("结算周期")]),e._v(" "),s("el-select",{attrs:{placeholder:"请选择"},on:{change:e.query},model:{value:e.queryParams.cycleId,callback:function(t){e.$set(e.queryParams,"cycleId",t)},expression:"queryParams.cycleId"}},e._l(e.cycleList,function(t){return s("el-option",{key:t.id,attrs:{label:e.$moment(t.begintime,"YYYY/MM/DD")+"~"+e.$moment(t.endtime,"YYYY/MM/DD"),value:t.id}})}),1)],1),e._v(" "),s("div",{staticClass:"query-group"},[s("label",[e._v("商家")]),e._v(" "),s("el-input",{on:{keyup:function(t){return"button"in t||!e._k(t.keyCode,"enter",13,t.key,"Enter")?e.query(t):null}},model:{value:e.queryParams.storeName,callback:function(t){e.$set(e.queryParams,"storeName",t)},expression:"queryParams.storeName"}})],1),e._v(" "),s("div",{staticClass:"query-group"},[s("cms-button",{attrs:{size:"small",colorPicker:!0},on:{click:e.query}},[e._v("查询")])],1),e._v(" "),s("div",{staticClass:"query-group"},[s("cms-button",{attrs:{size:"small",colorPicker:!0},on:{click:e.exportData}},[s("i",{staticClass:"iconfont icon-Excel"}),e._v(" 导出")])],1)]),e._v(" "),s("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"dataTable",staticStyle:{width:"100%"},attrs:{data:e.tableData,stripe:""},on:{"selection-change":e.getCheckItems,"row-click":e.checkRows}},[s("el-table-column",{attrs:{type:"expand",align:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-form",{staticClass:"demo-table-expand",attrs:{"label-position":"right","label-width":"160px",inline:""}},[s("el-form-item",{attrs:{label:"结算批次号："}},[s("span",[e._v(e._s(t.row.businessNumber))])]),e._v(" "),s("el-form-item",{attrs:{label:"商家："}},[s("span",[e._v(e._s(t.row.store.storeName))])]),e._v(" "),s("el-form-item",{attrs:{label:"主营类目："}},[s("span",[e._v(e._s(t.row.store.productCategory.cateName))])]),e._v(" "),s("el-form-item",{attrs:{label:"生成时间："}},[s("span",[e._v(e._s(e.$moment(t.row.createTime,"YYYY-MM-DD HH:mm:ss")))])]),e._v(" "),s("el-form-item",{attrs:{label:"状态："}},[1==t.row.status?s("span",[e._v("待商家确认")]):e._e(),e._v(" "),2==t.row.status?s("span",[e._v("待平台审核")]):e._e(),e._v(" "),3==t.row.status?s("span",[e._v("已结算")]):e._e()]),e._v(" "),s("el-form-item",{attrs:{label:"有效订单数："}},[s("span",{staticClass:"green"},[e._v(e._s(t.row.orders>0?t.row.orders:0)+" 笔")])]),e._v(" "),s("el-form-item",{attrs:{label:"退款单数："}},[s("span",{staticClass:"red"},[e._v(e._s(t.row.refundOrders>0?t.row.refundOrders:0)+" 笔")])]),e._v(" "),s("el-form-item",{attrs:{label:"结算金额："}},[s("span",{staticClass:"green"},[e._v("￥ "+e._s(e.$cms.float(t.row.amount)))])]),e._v(" "),s("el-form-item",{attrs:{label:"异常处理调整金额："}},[s("span",{staticClass:"green"},[e._v("￥ "+e._s(e.$cms.float(t.row.errorAdjustmentTotalAmount)))])]),e._v(" "),s("el-form-item",{attrs:{label:"成交金额："}},[s("span",{staticClass:"green"},[e._v("￥ "+e._s(e.$cms.float(t.row.turnoverAmount)))])]),e._v(" "),s("el-form-item",{attrs:{label:""}},[s("span")]),e._v(" "),s("el-form-item",{attrs:{label:""}},[s("span")]),e._v(" "),s("el-form-item",{attrs:{label:"积分抵扣（金额/数量）："}},[s("span",{staticClass:"green"},[e._v(" ￥"+e._s(e.$cms.float(t.row.integralDeductionAmount))+"/"+e._s(t.row.integralDeductionNum))])]),e._v(" "),s("el-form-item",{attrs:{label:"红包抵扣（金额/数量）："}},[s("span",{staticClass:"green"},[e._v(" ￥"+e._s(e.$cms.float(t.row.redenvelopeOffset))+"/"+e._s(t.row.redenvelopeOffsetNum))])]),e._v(" "),s("el-form-item",{attrs:{label:"平台优惠券抵扣："}},[s("span",{staticClass:"green"},[e._v(" ￥ "+e._s(e.$cms.float(t.row.platformCouponOffset)))])]),e._v(" "),s("el-form-item",{attrs:{label:"退款金额："}},[s("span",{staticClass:"red"},[e._v("- ￥"+e._s(e.$cms.float(t.row.refundAmount)))])]),e._v(" "),s("el-form-item",{attrs:{label:""}},[s("span")]),e._v(" "),s("el-form-item",{attrs:{label:""}},[s("span")]),e._v(" "),s("el-form-item",{attrs:{label:"积分返还（金额/数量）："}},[s("span",{staticClass:"red"},[e._v("- ￥"+e._s(e.$cms.float(t.row.refundRedenvelopeAmount))+"/"+e._s(t.row.refundRedenvelopeNum))])]),e._v(" "),s("el-form-item",{attrs:{label:"红包返还（金额/数量）："}},[s("span",{staticClass:"red"},[e._v("- ￥"+e._s(e.$cms.float(t.row.redenvelopeOffset))+"/"+e._s(t.row.redenvelopeOffsetNum))])]),e._v(" "),s("el-form-item",{attrs:{label:"平台优惠券返还："}},[s("span",{staticClass:"red"},[e._v("- ￥ "+e._s(e.$cms.float(t.row.platformRefundCoupon)))])]),e._v(" "),s("el-form-item",{attrs:{label:"异常差额："}},[s("span",[e._v("\n                总计金额 "),s("span",{class:t.row.errorAdjustmentTotalAmount>=0?"green":"red"},[e._v(e._s(t.row.errorAdjustmentTotalAmount>=0?"+":"-")+"￥"+e._s(e.$cms.float(t.row.errorAdjustmentTotalAmount>=0?t.row.errorAdjustmentTotalAmount:-t.row.errorAdjustmentTotalAmount)))]),e._v(" ，\n                包含调整金额： "),s("span",{class:t.row.errorAdjustmentAmount>=0?"green":"red"},[e._v(e._s(t.row.errorAdjustmentAmount>=0?"+":"-")+"￥"+e._s(e.$cms.float(t.row.errorAdjustmentAmount>=0?t.row.errorAdjustmentAmount:-t.row.errorAdjustmentAmount)))]),e._v(" ，\n                积分调整： "),s("span",{class:t.row.errorAdjustmentScore>=0?"green":"red"},[e._v(e._s(t.row.errorAdjustmentScore>=0?"+":"-")+"￥"+e._s(e.$cms.float(t.row.errorAdjustmentScore>=0?t.row.errorAdjustmentScore:-t.row.errorAdjustmentScore)))]),e._v("\n                红包调整 "),s("span",{class:t.row.errorAdjustmentRedenvelope>=0?"green":"red"},[e._v(e._s(t.row.errorAdjustmentRedenvelope>=0?"+":"-")+"￥"+e._s(e.$cms.float(t.row.errorAdjustmentRedenvelope>=0?t.row.errorAdjustmentRedenvelope:-t.row.errorAdjustmentRedenvelope)))]),e._v("\n                平台优惠调整： "),s("span",{class:t.row.errorAdjustmentPlatformCoupon>=0?"green":"red"},[e._v(e._s(t.row.errorAdjustmentPlatformCoupon>=0?"+":"-")+"￥"+e._s(e.$cms.float(t.row.errorAdjustmentPlatformCoupon>=0?t.row.errorAdjustmentPlatformCoupon:-t.row.errorAdjustmentPlatformCoupon)))])])])],1)]}}])}),e._v(" "),s("el-table-column",{attrs:{prop:"businessNumber",label:"结算批次号",width:"160"}}),e._v(" "),s("el-table-column",{attrs:{prop:"settlementCycle",label:"结算周期","min-width":"180",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return s("div",{},[t.row.settlementCycle.begintime&&""!=t.row.settlementCycle.begintime?s("span",[e._v("\n            "+e._s(e.$moment(t.row.settlementCycle.begintime,"YYYY/MM/DD")+" ~ "+e.$moment(t.row.settlementCycle.endtime,"YYYY/MM/DD"))+"\n          ")]):s("span",[e._v(e._s(e.$moment(t.row.settlementCycle.endtime,"YYYY-MM-DD")))])])}}])}),e._v(" "),s("el-table-column",{attrs:{prop:"store.storeName",label:"商家","min-width":"160",align:"center"}}),e._v(" "),s("el-table-column",{attrs:{prop:"store.productCategory.cateName",label:"主营类目","min-width":"100",align:"center"}}),e._v(" "),s("el-table-column",{attrs:{prop:"amount",label:"结算金额","min-width":"130",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return s("div",{},[s("span",[e._v("￥ "+e._s(e.$cms.float(t.row.amount)))])])}}])}),e._v(" "),s("el-table-column",{attrs:{prop:"createTime",label:"生成时间","min-width":"170",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return s("div",{},[s("span",[e._v(e._s(e.$moment(t.row.createTime,"YYYY-MM-DD HH:mm:ss")))])])}}])}),e._v(" "),s("el-table-column",{attrs:{prop:"status",formatter:e.toStatus,label:"状态","min-width":"110",align:"center"}}),e._v(" "),s("el-table-column",{attrs:{prop:"hasError",label:"是否异常","min-width":"80",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return s("div",{},[s("span",{class:[t.row.hasError?"green":"red"]},[e._v("\n            "+e._s(t.row.hasError?"是":"否")+"\n          ")])])}}])}),e._v(" "),s("el-table-column",{attrs:{label:"操作",width:"290",fixed:"right",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return s("div",{},[s("cms-button",{attrs:{slot:"reference",type:"info",size:"small"},on:{click:function(s){s.stopPropagation(),e.$routerLink("/finance/settlement/view","list",{sid:t.row.id,id:t.row.settlementCycle.id,storeId:t.row.store.id})}},slot:"reference"},[e._v("查看明细")]),e._v(" "),s("cms-button",{attrs:{slot:"reference",type:"info",size:"small"},on:{click:function(s){s.stopPropagation(),e.$routerLink("/finance/settlement/abnomal","list",{id:t.row.id,isEdit:!1})}},slot:"reference"},[e._v("查看异常")])],1)}}])})],1),e._v(" "),s("cms-pagination",{attrs:{total:e.total},on:{change:e.getPage}})],1)},staticRenderFns:[]};var g={name:"financeSettlementList",components:{wait:m,generated:_,settled:s("C7Lr")(p,b,!1,function(e){s("JCSy")},"data-v-9b093428",null).exports},data:function(){return{activeName:"wait"}},methods:{eventChange:function(e){"settled"===e&&this.$refs.settled&&this.$refs.settled.changeData(),"generated"===e&&this.$refs.generated&&this.$refs.generated.changeData(),"wait"===e&&this.$refs.wait&&this.$refs.wait.changeData()}}},w={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"cms-list-layout"},[s("cms-prompt",{attrs:{collapse:"true"}},[s("li",[e._v("系统会在设置的指定日期开始统计生成商家结算账单")]),e._v(" "),s("li",[e._v("有效订单包含交易成功且已过售后处理时效订单（售后时效详见商城设置）")]),e._v(" "),s("li",[e._v("系统生成的结算将自动推送至商户，商户确认无疑义后，平台将进行审核确认后，结算金额将自动充值至商户虚拟账户内，后期商户可自行进行提现操作")])]),e._v(" "),s("el-tabs",{model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[s("el-tab-pane",{attrs:{label:"待处理",name:"wait"}},[s("wait",{ref:"wait",on:{change:e.eventChange}})],1),e._v(" "),s("el-tab-pane",{attrs:{label:"已生成",name:"generated",lazy:""}},[s("generated",{ref:"generated",on:{change:e.eventChange}})],1),e._v(" "),s("el-tab-pane",{attrs:{label:"已结算",name:"settled",lazy:""}},[s("settled",{ref:"settled",on:{change:e.eventChange}})],1)],1)],1)},staticRenderFns:[]};var y=s("C7Lr")(g,w,!1,function(e){s("3Z78")},null,null);t.default=y.exports}});
//# sourceMappingURL=23.a7d88244ba35c28e90dc.js.map